!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=122)}([function(t,e,n){var r,o;r=n(6),e.graph=r.graph,e.Graph=r.Graph,e.journal=r.journal,e.Journal=r.Journal,e.Network=n(15).Network,e.isBrowser=n(9).isBrowser,e.ComponentLoader=n(10).ComponentLoader,e.Component=n(18).Component,e.helpers=n(92),o=n(19),e.InPorts=o.InPorts,e.OutPorts=o.OutPorts,e.InPort=n(20),e.OutPort=n(22),e.internalSocket=n(8),e.IP=n(4),e.createNetwork=function(t,n,r){var o,i;return"object"!=typeof r&&(r={delay:r}),"function"!=typeof n&&(n=function(t){if(t)throw t}),o=new e.Network(t,r),i=function(t){return t.start(function(e){return e?n(e):n(null,t)})},o.loader.listComponents(function(e){return e?n(e):0===t.nodes.length?i(o):r.delay?void n(null,o):o.connect(function(t){return t?n(t):i(o)})}),o},e.loadFile=function(t,n,r){return r||(r=n,null),r&&"object"!=typeof n&&(n={baseDir:n}),e.graph.loadFile(t,function(t,o){return t?r(t):(n.baseDir&&(o.baseDir=n.baseDir),e.createNetwork(o,r,n))})},e.saveFile=function(t,e,n){return t.save(e,n)},e.asCallback=n(93).asCallback,e.asComponent=n(94).asComponent},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var c,u=[],p=!1,d=-1;function l(){p&&c&&(p=!1,c.length?u=c.concat(u):d=-1,u.length&&h())}function h(){if(!p){var t=a(l);p=!0;for(var e=u.length;e;){for(c=u,u=[];++d<e;)c&&c[d].run();d=-1,e=u.length}c=null,p=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new f(t,e)),1!==u.length||p||a(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function o(t){return"object"==typeof t&&null!==t}function i(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,s,a,c,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var p=new Error('Uncaught, unspecified "error" event. ('+e+")");throw p.context=e,p}if(i(n=this._events[t]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(o(n))for(a=Array.prototype.slice.call(arguments,1),s=(u=n.slice()).length,c=0;c<s;c++)u[c].apply(this,a);return!0},n.prototype.addListener=function(t,e){var s;if(!r(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(s=i(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[t].length>s&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){if(!r(e))throw TypeError("listener must be a function");var n=!1;function o(){this.removeListener(t,o),n||(n=!0,e.apply(this,arguments))}return o.listener=e,this.on(t,o),this},n.prototype.removeListener=function(t,e){var n,i,s,a;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=(n=this._events[t]).length,i=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(a=s;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(r(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,n){"use strict";(function(r){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.log=function(){var t;return"object"===("undefined"==typeof console?"undefined":o(console))&&console.log&&(t=console).log.apply(t,arguments)},e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(r++,"%c"===t&&(o=r))}),e.splice(o,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){var t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=n(90)(e),t.exports.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,n(1))},function(t,e){t.exports=function(){class t{static isIP(t){return t&&"object"==typeof t&&!0===t._isIP}constructor(t="data",e=null,n={}){var r,o;for(r in this.type=t,this.data=e,this._isIP=!0,this.scope=null,this.owner=null,this.clonable=!1,this.index=null,this.schema=null,this.datatype="all",n)o=n[r],this[r]=o}clone(){var e,n,r;for(n in e=new t(this.type),this,this)r=this[n],-1===["owner"].indexOf(n)&&null!==r&&(e[n]="object"==typeof r?JSON.parse(JSON.stringify(r)):r);return e}move(t){this.owner=t}drop(){var t,e;for(t in this,e=[],this)this[t],e.push(delete this[t]);return e}}return t.types=["data","openBracket","closeBracket"],t}.call(this)},function(t,e){},function(t,e,n){e.graph=n(28),e.Graph=e.graph.Graph,e.journal=n(36),e.Journal=e.journal.Journal},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r,o,i;({EventEmitter:r}=n(2)),o=n(4),i=class extends r{regularEmitEvent(t,e){return this.emit(t,e)}debugEmitEvent(t,e){var n;try{return this.emit(t,e)}catch(t){if((n=t).id&&n.metadata&&n.error){if(0===this.listeners("error").length)throw n.error;return void this.emit("error",n)}if(0===this.listeners("error").length)throw n;return this.emit("error",{id:this.to.process.id,error:n,metadata:this.metadata})}}constructor(t={}){super(),this.metadata=t,this.brackets=[],this.connected=!1,this.dataDelegate=null,this.debug=!1,this.emitEvent=this.regularEmitEvent}connect(){if(!this.connected)return this.connected=!0,this.emitEvent("connect",null)}disconnect(){if(this.connected)return this.connected=!1,this.emitEvent("disconnect",null)}isConnected(){return this.connected}send(t){return void 0===t&&"function"==typeof this.dataDelegate&&(t=this.dataDelegate()),this.handleSocketEvent("data",t)}post(t,e=!0){if(void 0===t&&"function"==typeof this.dataDelegate&&(t=this.dataDelegate()),this.isConnected()||0!==this.brackets.length||this.connect(),this.handleSocketEvent("ip",t,!1),e&&this.isConnected()&&0===this.brackets.length)return this.disconnect()}beginGroup(t){return this.handleSocketEvent("begingroup",t)}endGroup(){return this.handleSocketEvent("endgroup")}setDataDelegate(t){if("function"!=typeof t)throw Error("A data delegate must be a function.");return this.dataDelegate=t}setDebug(t){return this.debug=t,this.emitEvent=this.debug?this.debugEmitEvent:this.regularEmitEvent}getId(){var t,e;return t=function(t){return`${t.process.id}() ${t.port.toUpperCase()}`},e=function(t){return`${t.port.toUpperCase()} ${t.process.id}()`},this.from||this.to?this.from&&!this.to?`${t(this.from)} -> ANON`:this.from?`${t(this.from)} -> ${e(this.to)}`:`DATA -> ${e(this.to)}`:"UNDEFINED"}legacyToIp(t,e){if(o.isIP(e))return e;switch(t){case"begingroup":return new o("openBracket",e);case"endgroup":return new o("closeBracket");case"data":return new o("data",e);default:return null}}ipToLegacy(t){switch(t.type){case"openBracket":return{event:"begingroup",payload:t.data};case"data":return{event:"data",payload:t.data};case"closeBracket":return{event:"endgroup",payload:t.data}}}handleSocketEvent(t,e,n=!0){var r,i,s;if(r=(i="ip"===t&&o.isIP(e))?e:this.legacyToIp(t,e)){if(!this.isConnected()&&n&&0===this.brackets.length&&this.connect(),"begingroup"===t&&this.brackets.push(e),i&&"openBracket"===r.type&&this.brackets.push(r.data),"endgroup"===t){if(0===this.brackets.length)return;r.data=this.brackets.pop(),e=r.data}if(i&&"closeBracket"===e.type){if(0===this.brackets.length)return;this.brackets.pop()}if(this.emitEvent("ip",r),r&&r.type)return i&&(t=(s=this.ipToLegacy(r)).event,e=s.payload),"connect"===t&&(this.connected=!0),"disconnect"===t&&(this.connected=!1),this.emitEvent(t,e)}}},e.InternalSocket=i,e.createSocket=function(){return new i}},function(t,e,n){(function(t){e.isBrowser=function(){return void 0===t||!t.execPath||!t.execPath.match(/node|iojs/)},e.deprecated=function(n){if(!e.isBrowser()){if(t.env.NOFLO_FATAL_DEPRECATED)throw new Error(n);return console.warn(n)}if(window.NOFLO_FATAL_DEPRECATED)throw new Error(n);console.warn(n)}}).call(this,n(1))},function(t,e,n){(function(t){var r,o,i,s,a;i=n(6),({EventEmitter:o}=n(2)),a=n(37),s=n(9),r=class extends o{constructor(t,e={}){super(),this.baseDir=t,this.options=e,this.components=null,this.libraryIcons={},this.processing=!1,this.ready=!1,this.setMaxListeners(0)}getModulePrefix(t){return t?"noflo"===t?"":("@"===t[0]&&(t=t.replace(/\@[a-z\-]+\//,"")),t.replace(/^noflo-/,"")):""}listComponents(t){if(this.processing)this.once("ready",()=>t(null,this.components));else{if(this.components)return t(null,this.components);this.ready=!1,this.processing=!0,this.components={},a.register(this,e=>{if(e){if(t)return t(e);throw e}if(this.processing=!1,this.ready=!0,this.emit("ready",!0),t)return t(null,this.components)})}}load(e,n,r){var o,i;if(this.ready){if(!(o=this.components[e])){for(i in this.components)if(i.split("/")[1]===e){o=this.components[i];break}if(!o)return void n(new Error(`Component ${e} not available with base ${this.baseDir}`))}if(!this.isGraph(o))return this.createComponent(e,o,r,(t,r)=>t?n(t):r?("Graph"===e&&(r.baseDir=this.baseDir),"string"==typeof e&&(r.componentName=e),r.isLegacy()&&s.deprecated(`Component ${e} uses legacy NoFlo APIs. Please port to Process API`),this.setIcon(e,r),n(null,r)):void n(new Error(`Component ${e} could not be loaded.`)));s.isBrowser()?setTimeout(()=>this.loadGraph(e,o,n,r),0):t.nextTick(()=>this.loadGraph(e,o,n,r))}else this.listComponents(t=>t?n(t):this.load(e,n,r))}createComponent(t,e,n,r){var o,i;if(!(o=e))return r(new Error(`Component ${t} not available`));if("string"==typeof o)return"function"==typeof a.dynamicLoad?void a.dynamicLoad(t,o,n,r):r(Error(`Dynamic loading of ${o} for component ${t} not available on this platform.`));if("function"==typeof o.getComponent)try{i=o.getComponent(n)}catch(t){return r(t)}else{if("function"!=typeof o)return void r(new Error(`Invalid type ${typeof o} for component ${t}.`));try{i=o(n)}catch(t){return r(t)}}return r(null,i)}isGraph(t){return"object"==typeof t&&t instanceof i.Graph||(!("object"!=typeof t||!t.processes||!t.connections)||"string"==typeof t&&(-1!==t.indexOf(".fbp")||-1!==t.indexOf(".json")))}loadGraph(t,e,n,r){this.createComponent(t,this.components.Graph,r,(r,o)=>{if(r)return n(r);o.loader=this,o.baseDir=this.baseDir,o.inPorts.remove("graph"),o.setGraph(e,e=>e?n(e):(this.setIcon(t,o),n(null,o)))})}setIcon(t,e){var n,r;e.getIcon&&!e.getIcon()&&([r,n]=t.split("/"),n&&this.getLibraryIcon(r)?e.setIcon(this.getLibraryIcon(r)):e.isSubgraph()?e.setIcon("sitemap"):e.setIcon("gear"))}getLibraryIcon(t){return this.libraryIcons[t]?this.libraryIcons[t]:null}setLibraryIcon(t,e){return this.libraryIcons[t]=e}normalizeName(t,e){var n;return n=`${this.getModulePrefix(t)}/${e}`,t||(n=e),n}registerComponent(t,e,n,r){var o;if(o=this.normalizeName(t,e),this.components[o]=n,r)return r()}registerGraph(t,e,n,r){return this.registerComponent(t,e,n,r)}registerLoader(t,e){return t(this,e)}setSource(t,e,n,r,o){return a.setSource?this.ready?a.setSource(this,t,e,n,r,o):void this.listComponents(i=>i?o(i):this.setSource(t,e,n,r,o)):o(new Error("setSource not allowed"))}getSource(t,e){return a.getSource?this.ready?a.getSource(this,t,e):void this.listComponents(n=>n?e(n):this.getSource(t,e)):e(new Error("getSource not allowed"))}clear(){return this.components=null,this.ready=!1,this.processing=!1}},e.ComponentLoader=r}).call(this,n(1))},function(t,e){t.exports=function(t){return[":~:",t,":~:"].join("")}},function(t,e,n){const r=n(24);t.exports=class extends r{constructor(t={}){const e=t;super(e),e.catchExceptions&&(window.onerror=function(t){return this.client&&this.send("network","error",t,{href:this.context?this.context.href:this.client.location.href}),console.error(t),!0}.bind(this)),e.defaultPermissions.length||(e.defaultPermissions=["protocol:graph","protocol:component","protocol:network","protocol:runtime","component:setsource","component:getsource","network:data","network:control","network:status"]),this.client=null}setClient(t){this.client=t}send(t,e,n,r){if(!this.client)return;let o=n;n instanceof Error&&(o={message:n.message,stack:n.stack});let{context:i}=this;i||(i=r),this.client.postMessage(JSON.stringify({protocol:t,command:e,payload:o}),i.href),super.send(t,e,n,i)}sendAll(t,e,n){this.send(t,e,n,this.context)}}},function(t,e,n){(function(e){var n=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var n,r,o;try{n=Map}catch(t){n=function(){}}try{r=Set}catch(t){r=function(){}}try{o=Promise}catch(t){o=function(){}}function i(s,c,u,p,d){"object"==typeof c&&(u=c.depth,p=c.prototype,d=c.includeNonEnumerable,c=c.circular);var l=[],h=[],f=void 0!==e;return void 0===c&&(c=!0),void 0===u&&(u=1/0),function s(u,m){if(null===u)return null;if(0===m)return u;var g,v;if("object"!=typeof u)return u;if(t(u,n))g=new n;else if(t(u,r))g=new r;else if(t(u,o))g=new o(function(t,e){u.then(function(e){t(s(e,m-1))},function(t){e(s(t,m-1))})});else if(i.__isArray(u))g=[];else if(i.__isRegExp(u))g=new RegExp(u.source,a(u)),u.lastIndex&&(g.lastIndex=u.lastIndex);else if(i.__isDate(u))g=new Date(u.getTime());else{if(f&&e.isBuffer(u))return g=e.allocUnsafe?e.allocUnsafe(u.length):new e(u.length),u.copy(g),g;t(u,Error)?g=Object.create(u):void 0===p?(v=Object.getPrototypeOf(u),g=Object.create(v)):(g=Object.create(p),v=p)}if(c){var y=l.indexOf(u);if(-1!=y)return h[y];l.push(u),h.push(g)}for(var b in t(u,n)&&u.forEach(function(t,e){var n=s(e,m-1),r=s(t,m-1);g.set(n,r)}),t(u,r)&&u.forEach(function(t){var e=s(t,m-1);g.add(e)}),u){var w;v&&(w=Object.getOwnPropertyDescriptor(v,b)),w&&null==w.set||(g[b]=s(u[b],m-1))}if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(u);for(b=0;b<E.length;b++){var P=E[b];(!(C=Object.getOwnPropertyDescriptor(u,P))||C.enumerable||d)&&(g[P]=s(u[P],m-1),C.enumerable||Object.defineProperty(g,P,{enumerable:!1}))}}if(d){var k=Object.getOwnPropertyNames(u);for(b=0;b<k.length;b++){var C,S=k[b];(C=Object.getOwnPropertyDescriptor(u,S))&&C.enumerable||(g[S]=s(u[S],m-1),Object.defineProperty(g,S,{enumerable:!1}))}}return g}(s,u)}function s(t){return Object.prototype.toString.call(t)}function a(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return i.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},i.__objToStr=s,i.__isDate=function(t){return"object"==typeof t&&"[object Date]"===s(t)},i.__isArray=function(t){return"object"==typeof t&&"[object Array]"===s(t)},i.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===s(t)},i.__getRegExpFlags=a,i}();t.exports&&(t.exports=n)}).call(this,n(14).Buffer)},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(29),o=n(30),i=n(31);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return d(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=l(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(e,n),o=(t=a(t,r)).write(e,n);o!==r&&(t=t.slice(0,o));return t}(t,e,n):function(t,e){if(c.isBuffer(e)){var n=0|h(e.length);return 0===(t=a(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):l(t,e);if("Buffer"===e.type&&i(e.data))return l(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function p(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function d(t,e){if(p(e),t=a(t,e<0?0:0|h(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function l(t,e){var n=e.length<0?0:0|h(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function h(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function f(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(t).length;default:if(r)return U(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,o);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,o){var i,s=1,a=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){var p=-1;for(i=n;i<a;i++)if(u(t,i)===u(e,-1===p?0:i-p)){if(-1===p&&(p=i),i-p+1===c)return p*s}else-1!==p&&(i-=i-p),p=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){for(var d=!0,l=0;l<c;l++)if(u(t,i+l)!==u(e,l)){d=!1;break}if(d)return i}return-1}function y(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function b(t,e,n,r){return $(U(e,t.length-n),t,n,r)}function w(t,e,n,r){return $(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function E(t,e,n,r){return w(t,e,n,r)}function P(t,e,n,r){return $(F(e),t,n,r)}function k(t,e,n,r){return $(function(t,e){for(var n,r,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function C(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function S(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i,s,a,c,u=t[o],p=null,d=u>239?4:u>223?3:u>191?2:1;if(o+d<=n)switch(d){case 1:u<128&&(p=u);break;case 2:128==(192&(i=t[o+1]))&&(c=(31&u)<<6|63&i)>127&&(p=c);break;case 3:i=t[o+1],s=t[o+2],128==(192&i)&&128==(192&s)&&(c=(15&u)<<12|(63&i)<<6|63&s)>2047&&(c<55296||c>57343)&&(p=c);break;case 4:i=t[o+1],s=t[o+2],a=t[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(p=c)}null===p?(p=65533,d=1):p>65535&&(p-=65536,r.push(p>>>10&1023|55296),p=56320|1023&p),r.push(p),o+=d}return function(t){var e=t.length;if(e<=O)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=O));return n}(r)}e.Buffer=c,e.SlowBuffer=function(t){+t!=t&&(t=0);return c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return u(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return function(t,e,n,r){return p(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},c.allocUnsafe=function(t){return d(null,t)},c.allocUnsafeSlow=function(t){return d(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var s=t[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},c.byteLength=f,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?S(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return D(this,e,n);case"utf8":case"utf-8":return S(this,e,n);case"ascii":return x(this,e,n);case"latin1":case"binary":return I(this,e,n);case"base64":return C(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,r,o){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(i,s),u=this.slice(r,o),p=t.slice(e,n),d=0;d<a;++d)if(u[d]!==p[d]){i=u[d],s=p[d];break}return i<s?-1:s<i?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return y(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return w(this,t,e,n);case"latin1":case"binary":return E(this,t,e,n);case"base64":return P(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;function x(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function I(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function D(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=G(t[i]);return o}function A(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function N(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function _(t,e,n,r,o,i){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function T(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function R(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function L(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(t,e,n,r,i){return i||L(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function M(t,e,n,r,i){return i||L(t,0,n,8),o.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=c.prototype;else{var o=e-t;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},c.prototype.readUInt8=function(t,e){return e||N(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||N(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||N(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||N(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},c.prototype.readInt8=function(t,e){return e||N(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||N(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||N(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||N(t,4,this.length),o.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||N(t,4,this.length),o.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||N(t,8,this.length),o.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||N(t,8,this.length),o.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||_(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||_(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):T(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):T(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):R(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);_(this,t,e,n,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<n&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);_(this,t,e,n,o-1,-o)}var i=n-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):T(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):T(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):R(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||_(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return B(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return B(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return M(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return M(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,i=r-n;if(this===t&&n<e&&e<r)for(o=i-1;o>=0;--o)t[o+e]=this[o+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},c.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var s=c.isBuffer(t)?t:U(new c(t,r).toString()),a=s.length;for(i=0;i<n-e;++i)this[i+e]=s[i%a]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function G(t){return t<16?"0"+t.toString(16):t.toString(16)}function U(t,e){var n;e=e||1/0;for(var r=t.length,o=null,i=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function F(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(j,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function $(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}}).call(this,n(7))},function(t,e,n){(function(t){var r,o,i,s,a,c,u;a=n(8),n(6),({EventEmitter:r}=n(2)),c=n(9),s=n(10),u=n(17),o=n(4),i=function(){class e extends r{constructor(e,n={}){super(),this.options=n,this.processes={},this.connections=[],this.initials=[],this.nextInitials=[],this.defaults=[],this.graph=e,this.started=!1,this.stopped=!0,this.debug=!0,this.eventBuffer=[],c.isBrowser()?this.baseDir=e.baseDir||"/":this.baseDir=e.baseDir||t.cwd(),this.startupDate=null,e.componentLoader?this.loader=e.componentLoader:this.loader=new s.ComponentLoader(this.baseDir,this.options)}uptime(){return this.startupDate?new Date-this.startupDate:0}getActiveProcesses(){var t,e,n,r;if(t=[],!this.started)return t;for(e in r=this.processes)(n=r[e]).component.load>0&&t.push(e),n.component.__openConnections>0&&t.push(e);return t}bufferedEmit(t,e){var n,r,o,i;if("icon"!==t&&"error"!==t&&"process-error"!==t&&"end"!==t)if(this.isStarted()||"end"===t){if(this.emit(t,e),"start"===t){for(r=0,o=(i=this.eventBuffer).length;r<o;r++)n=i[r],this.emit(n.type,n.payload);this.eventBuffer=[]}if("ip"===t)switch(e.type){case"openBracket":this.bufferedEmit("begingroup",e);break;case"closeBracket":this.bufferedEmit("endgroup",e);break;case"data":this.bufferedEmit("data",e)}}else this.eventBuffer.push({type:t,payload:e});else this.emit(t,e)}load(t,e,n){return this.loader.load(t,n,e)}addNode(t,e){var n;if(!this.processes[t.id])return n={id:t.id},t.component?this.load(t.component,t.metadata,(r,o)=>{var i,s,a,c;if(r)return e(r);for(s in o.nodeId=t.id,n.component=o,n.componentName=t.component,i=n.component.inPorts.ports,a=n.component.outPorts.ports,i)(c=i[s]).node=t.id,c.nodeInstance=o,c.name=s;for(s in a)(c=a[s]).node=t.id,c.nodeInstance=o,c.name=s;return o.isSubgraph()&&this.subscribeSubgraph(n),this.subscribeNode(n),this.processes[n.id]=n,e(null,n)}):(this.processes[n.id]=n,void e(null,n));e(null,this.processes[t.id])}removeNode(t,e){var n;return(n=this.getNode(t.id))?n.component.shutdown(n=>n?e(n):(delete this.processes[t.id],e(null))):e(new Error(`Node ${t.id} not found`))}renameNode(t,e,n){var r,o,i,s,a;if(!(a=this.getNode(t)))return n(new Error(`Process ${t} not found`));for(o in a.id=e,r=a.component.inPorts.ports,i=a.component.outPorts.ports,r)(s=r[o])&&(s.node=e);for(o in i)(s=i[o])&&(s.node=e);return this.processes[e]=a,delete this.processes[t],n(null)}getNode(t){return this.processes[t]}connect(t=function(){}){var e,n,r,o,i,s;return e=0,o=((n,r)=>o=>this[`add${o}`](r,function(r){return r?t(r):++e%100!=0?n(o):void setTimeout(function(){return n(o)},0)})),s=(()=>(this.subscribeGraph(),t())),i=u.reduceRight(this.graph.nodes,o,s),r=u.reduceRight(this.graph.initializers,o,function(){return i("Defaults")}),n=u.reduceRight(this.graph.edges,o,function(){return r("Initial")}),u.reduceRight(this.graph.nodes,o,function(){return n("Edge")})("Node")}connectPort(t,e,n,r,o,i){if(o)return t.to={process:e,port:n,index:r},e.component.inPorts&&e.component.inPorts[n]?e.component.inPorts[n].isAddressable()?(e.component.inPorts[n].attach(t,r),void i()):(e.component.inPorts[n].attach(t),void i()):void i(new Error(`No inport '${n}' defined in process ${e.id} (${t.getId()})`));if(t.from={process:e,port:n,index:r},e.component.outPorts&&e.component.outPorts[n]){if(e.component.outPorts[n].isAddressable())return e.component.outPorts[n].attach(t,r),void i();e.component.outPorts[n].attach(t),i()}else i(new Error(`No outport '${n}' defined in process ${e.id} (${t.getId()})`))}subscribeGraph(){var t,e,n,r;return t=[],n=!1,r=function(e,n){return t.push({op:e,details:n})},e=(r=>{var o,i;if(r){if(0===this.listeners("process-error").length)throw r;this.bufferedEmit("process-error",r)}if(t.length)switch(n=!0,i=t.shift(),o=e,i.op){case"renameNode":return this.renameNode(i.details.from,i.details.to,o);default:return this[i.op](i.details,o)}else n=!1}),this.graph.on("addNode",function(t){if(r("addNode",t),!n)return e()}),this.graph.on("removeNode",function(t){if(r("removeNode",t),!n)return e()}),this.graph.on("renameNode",function(t,o){if(r("renameNode",{from:t,to:o}),!n)return e()}),this.graph.on("addEdge",function(t){if(r("addEdge",t),!n)return e()}),this.graph.on("removeEdge",function(t){if(r("removeEdge",t),!n)return e()}),this.graph.on("addInitial",function(t){if(r("addInitial",t),!n)return e()}),this.graph.on("removeInitial",function(t){if(r("removeInitial",t),!n)return e()})}subscribeSubgraph(t){var e;if(t.component.isReady()){if(t.component.network)return t.component.network.setDebug(this.debug),e=((e,n)=>{if("process-error"===e&&0===this.listeners("process-error").length){if(n.id&&n.metadata&&n.error)throw n.error;throw n}return n||(n={}),n.subgraph?(n.subgraph.unshift||(n.subgraph=[n.subgraph]),n.subgraph.unshift(t.id)):n.subgraph=[t.id],this.bufferedEmit(e,n)}),t.component.network.on("ip",function(t){return e("ip",t)}),t.component.network.on("process-error",function(t){return e("process-error",t)})}else t.component.once("ready",()=>this.subscribeSubgraph(t))}subscribeSocket(t,e){var n;if(t.on("ip",e=>this.bufferedEmit("ip",{id:t.getId(),type:e.type,socket:t,data:e.data,metadata:t.metadata})),t.on("error",t=>{if(0===this.listeners("process-error").length){if(t.id&&t.metadata&&t.error)throw t.error;throw t}return this.bufferedEmit("process-error",t)}),null!=e&&null!=(n=e.component)?n.isLegacy():void 0)return t.on("connect",function(){return e.component.__openConnections||(e.component.__openConnections=0),e.component.__openConnections++}),t.on("disconnect",()=>{if(e.component.__openConnections--,e.component.__openConnections<0&&(e.component.__openConnections=0),0===e.component.__openConnections)return this.checkIfFinished()})}subscribeNode(t){if(t.component.on("activate",t=>{if(this.debouncedEnd)return this.abortDebounce=!0}),t.component.on("deactivate",t=>{if(!(t>0))return this.checkIfFinished()}),t.component.getIcon)return t.component.on("icon",()=>this.bufferedEmit("icon",{id:t.id,icon:t.component.getIcon()}))}addEdge(t,e){var n,r,o;if((r=a.createSocket(t.metadata)).setDebug(this.debug),!(n=this.getNode(t.from.node)))return e(new Error(`No process defined for outbound node ${t.from.node}`));if(!n.component)return e(new Error(`No component defined for outbound node ${t.from.node}`));if(n.component.isReady()){if(!(o=this.getNode(t.to.node)))return e(new Error(`No process defined for inbound node ${t.to.node}`));if(!o.component)return e(new Error(`No component defined for inbound node ${t.to.node}`));if(o.component.isReady())return this.subscribeSocket(r,n),this.connectPort(r,o,t.to.port,t.to.index,!0,o=>o?e(o):this.connectPort(r,n,t.from.port,t.from.index,!1,t=>t?e(t):(this.connections.push(r),e())));o.component.once("ready",()=>this.addEdge(t,e))}else n.component.once("ready",()=>this.addEdge(t,e))}removeEdge(t,e){var n,r,o,i,s;for(s=[],r=0,o=(i=this.connections).length;r<o;r++)(n=i[r])&&t.to.node===n.to.process.id&&t.to.port===n.to.port&&(n.to.process.component.inPorts[n.to.port].detach(n),t.from.node&&n.from&&t.from.node===n.from.process.id&&t.from.port===n.from.port&&n.from.process.component.outPorts[n.from.port].detach(n),this.connections.splice(this.connections.indexOf(n),1),s.push(e()));return s}addDefaults(t,e){var n,r,o,i,s;if(!(o=this.getNode(t.id)))return e(new Error(`Process ${t.id} not defined`));if(!o.component)return e(new Error(`No component defined for node ${t.id}`));if(!o.component.isReady())return o.component.setMaxListeners(0),void o.component.once("ready",()=>this.addDefaults(o,e));for(n in i=o.component.inPorts.ports)(r=i[n]).hasDefault()&&!r.isAttached()&&((s=a.createSocket()).setDebug(this.debug),this.subscribeSocket(s),this.connectPort(s,o,n,void 0,!0,function(){}),this.connections.push(s),this.defaults.push(s));return e()}addInitial(t,e){var n,r;return(n=a.createSocket(t.metadata)).setDebug(this.debug),this.subscribeSocket(n),(r=this.getNode(t.to.node))?r.component?r.component.isReady()||r.component.inPorts[t.to.port]?this.connectPort(n,r,t.to.port,t.to.index,!0,r=>{var o;return r?e(r):(this.connections.push(n),o={socket:n,data:t.from.data},this.initials.push(o),this.nextInitials.push(o),this.isRunning()?this.sendInitials():this.isStopped()||(this.setStarted(!0),this.sendInitials()),e())}):(r.component.setMaxListeners(0),void r.component.once("ready",()=>this.addInitial(t,e))):e(new Error(`No component defined for inbound node ${t.to.node}`)):e(new Error(`No process defined for inbound node ${t.to.node}`))}removeInitial(t,e){var n,r,o,i,s,a,c,u,p,d,l;for(r=0,a=(p=this.connections).length;r<a;r++)if((n=p[r])&&t.to.node===n.to.process.id&&t.to.port===n.to.port){for(n.to.process.component.inPorts[n.to.port].detach(n),this.connections.splice(this.connections.indexOf(n),1),i=0,c=(d=this.initials).length;i<c;i++)(o=d[i])&&o.socket===n&&this.initials.splice(this.initials.indexOf(o),1);for(s=0,u=(l=this.nextInitials).length;s<u;s++)(o=l[s])&&o.socket===n&&this.nextInitials.splice(this.nextInitials.indexOf(o),1)}return e()}sendInitial(t){return t.socket.post(new o("data",t.data,{initial:!0}))}sendInitials(e){var n;return e||(e=function(){}),n=(()=>{var t,n,r,o;for(t=0,r=(o=this.initials).length;t<r;t++)n=o[t],this.sendInitial(n);return this.initials=[],e()}),void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node")?t.nextTick(n):setTimeout(n,0)}isStarted(){return this.started}isStopped(){return this.stopped}isRunning(){return this.getActiveProcesses().length>0}startComponents(t){var e,n,r,o,i,s,a;if(t||(t=function(){}),e=0,r=this.processes?Object.keys(this.processes).length:0,o=function(n){return n?t(n):++e===r?t():void 0},!this.processes||!Object.keys(this.processes).length)return t();for(n in a=[],s=this.processes)(i=s[n]).component.isStarted()?o():0!==i.component.start.length?a.push(i.component.start(o)):(c.deprecated("component.start method without callback is deprecated"),i.component.start(),o());return a}sendDefaults(t){var e,n,r,o;if(t||(t=function(){}),!this.defaults.length)return t();for(e=0,n=(r=this.defaults).length;e<n;e++)1===(o=r[e]).to.process.component.inPorts[o.to.port].sockets.length&&(o.connect(),o.send(),o.disconnect());return t()}start(t){t||(c.deprecated("Calling network.start() without callback is deprecated"),t=function(){}),this.debouncedEnd&&(this.abortDebounce=!0),this.started?this.stop(e=>e?t(e):this.start(t)):(this.initials=this.nextInitials.slice(0),this.eventBuffer=[],this.startComponents(e=>{if(e)return t(e);this.sendInitials(e=>{if(e)return t(e);this.sendDefaults(e=>{if(e)return t(e);this.setStarted(!0),t(null)})})}))}stop(t){var e,n,r,o,i,s,a,u,p,d,l;if(t||(c.deprecated("Calling network.stop() without callback is deprecated"),t=function(){}),this.debouncedEnd&&(this.abortDebounce=!0),!this.started)return this.stopped=!0,t(null);for(r=0,i=(p=this.connections).length;r<i;r++)(e=p[r]).isConnected()&&e.disconnect();if(n=0,s=this.processes?Object.keys(this.processes).length:0,a=(e=>e?t(e):++n===s?(this.setStarted(!1),this.stopped=!0,t()):void 0),!this.processes||!Object.keys(this.processes).length)return this.setStarted(!1),this.stopped=!0,t();for(o in l=[],d=this.processes)(u=d[o]).component.isStarted()?0!==u.component.shutdown.length?l.push(u.component.shutdown(a)):(c.deprecated("component.shutdown method without callback is deprecated"),u.component.shutdown(),a()):a();return l}setStarted(t){if(this.started!==t)return t?(this.startupDate||(this.startupDate=new Date),this.started=!0,this.stopped=!1,this.bufferedEmit("start",{start:this.startupDate})):(this.started=!1,void this.bufferedEmit("end",{start:this.startupDate,end:new Date,uptime:this.uptime()}))}checkIfFinished(){if(!this.isRunning())return delete this.abortDebounce,this.debouncedEnd||(this.debouncedEnd=u.debounce(()=>{if(!this.abortDebounce&&!this.isRunning())return this.setStarted(!1)},50)),this.debouncedEnd()}getDebug(){return this.debug}setDebug(t){var e,n,r,o,i,s,a;if(t!==this.debug){for(this.debug=t,e=0,r=(i=this.connections).length;e<r;e++)i[e].setDebug(t);for(o in a=[],s=this.processes)(n=s[o].component).isSubgraph()?a.push(n.network.setDebug(t)):a.push(void 0);return a}}}return e.prototype.processes={},e.prototype.connections=[],e.prototype.initials=[],e.prototype.defaults=[],e.prototype.graph=null,e.prototype.startupDate=null,e}.call(this),e.Network=i}).call(this,n(1))},function(t,e,n){(function(t,r){var o=/%[sdj%]/g;e.format=function(t){if(!v(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(a(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(t).replace(o,function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),c=r[n];n<i;c=r[++n])m(c)||!w(c)?s+=" "+c:s+=" "+a(c);return s},e.deprecate=function(n,o){if(y(t.process))return function(){return e.deprecate(n,o).apply(this,arguments)};if(!0===r.noDeprecation)return n;var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),i=!0}return n.apply(this,arguments)}};var i,s={};function a(t,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),f(n)?r.showHidden=n:n&&e._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),p(r,t,r.depth)}function c(t,e){var n=a.styles[e];return n?"["+a.colors[n][0]+"m"+t+"["+a.colors[n][1]+"m":t}function u(t,e){return t}function p(t,n,r){if(t.customInspect&&n&&k(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return v(o)||(o=p(t,o,r)),o}var i=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(v(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(g(e))return t.stylize(""+e,"number");if(f(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,n);if(i)return i;var s=Object.keys(n),a=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),P(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return d(n);if(0===s.length){if(k(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return t.stylize(Date.prototype.toString.call(n),"date");if(P(n))return d(n)}var u,w="",C=!1,S=["{","}"];(h(n)&&(C=!0,S=["[","]"]),k(n))&&(w=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(w=" "+RegExp.prototype.toString.call(n)),E(n)&&(w=" "+Date.prototype.toUTCString.call(n)),P(n)&&(w=" "+d(n)),0!==s.length||C&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=C?function(t,e,n,r,o){for(var i=[],s=0,a=e.length;s<a;++s)x(e,String(s))?i.push(l(t,e,n,r,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(l(t,e,n,r,o,!0))}),i}(t,n,r,a,s):s.map(function(e){return l(t,n,r,a,e,C)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,w,S)):S[0]+w+S[1]}function d(t){return"["+Error.prototype.toString.call(t)+"]"}function l(t,e,n,r,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?a=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),x(r,o)||(s="["+o+"]"),a||(t.seen.indexOf(c.value)<0?(a=m(n)?p(t,c.value,null):p(t,c.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),y(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function h(t){return Array.isArray(t)}function f(t){return"boolean"==typeof t}function m(t){return null===t}function g(t){return"number"==typeof t}function v(t){return"string"==typeof t}function y(t){return void 0===t}function b(t){return w(t)&&"[object RegExp]"===C(t)}function w(t){return"object"==typeof t&&null!==t}function E(t){return w(t)&&"[object Date]"===C(t)}function P(t){return w(t)&&("[object Error]"===C(t)||t instanceof Error)}function k(t){return"function"==typeof t}function C(t){return Object.prototype.toString.call(t)}function S(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(y(i)&&(i=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(i)){var n=r.pid;s[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else s[t]=function(){};return s[t]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=h,e.isBoolean=f,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=v,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=y,e.isRegExp=b,e.isObject=w,e.isDate=E,e.isError=P,e.isFunction=k,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(50);var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function x(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){var t,n;console.log("%s - %s",(t=new Date,n=[S(t.getHours()),S(t.getMinutes()),S(t.getSeconds())].join(":"),[t.getDate(),O[t.getMonth()],n].join(" ")),e.format.apply(e,arguments))},e.inherits=n(51),e._extend=function(t,e){if(!e||!w(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,n(7),n(1))},function(t,e){var n,r,o,i,s;r=function(t){return/.*\.coffee$/.test(t)?"coffeescript":"javascript"},o=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(arg)},i=function(t,e,n){if(void 0===e)return t;switch(null===n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,i){return t.call(e,n,r,o,i)}}return function(){return t.apply(e,arguments)}},s=function(t){var e;return e=function(e,n,r,o,i,s){for(var a;i>=0&&i<s;)r=n(r,e[a=o?o[i]:i],a,e),i+=t;return r},function(n,r,o,s){var a,c,u;return r=i(r,s,4),u=((c=Object.keys(n))||n).length,a=t>0?0:u-1,arguments.length<3&&(o=n[c?c[a]:a],a+=t),e(n,r,o,c,a,u)}}(-1),n=function(t,e,n){var r,o,i,s,a,c;return a=void 0,r=void 0,o=void 0,c=void 0,s=void 0,i=function(){var u;(u=Date.now-c)<e&&u>=0?a=setTimeout(i,e-u):(a=null,n||(s=t.apply(o,r),a||(o=r=null)))},function(){var u;return o=this,r=arguments,c=Date.now,u=n&&!a,a||(a=setTimeout(i,e)),u&&(s=t.apply(o,r),o=r=null),s}},e.guessLanguageFromFilename=r,e.reduceRight=s,e.debounce=n,e.isArray=o},function(t,e,n){var r,o,i,s,a,c,u,p,d,l,h=function(t,e){if(!(t instanceof e))throw new Error("Bound instance method accessed before binding")};({EventEmitter:o}=n(2)),l=n(19),i=n(4),u=n(3)("noflo:component"),p=n(3)("noflo:component:brackets"),d=n(3)("noflo:component:send"),r=function(){class t extends o{constructor(t){var e,n,r;super(),this.error=this.error.bind(this),t||(t={}),t.inPorts||(t.inPorts={}),t.inPorts instanceof l.InPorts?this.inPorts=t.inPorts:this.inPorts=new l.InPorts(t.inPorts),t.outPorts||(t.outPorts={}),t.outPorts instanceof l.OutPorts?this.outPorts=t.outPorts:this.outPorts=new l.OutPorts(t.outPorts),t.icon&&(this.icon=t.icon),t.description&&(this.description=t.description),this.started=!1,this.load=0,this.ordered=null!=(e=t.ordered)&&e,this.autoOrdering=null!=(n=t.autoOrdering)?n:null,this.outputQ=[],this.bracketContext={in:{},out:{}},this.activateOnInput=null==(r=t.activateOnInput)||r,this.forwardBrackets={in:["out","error"]},"forwardBrackets"in t&&(this.forwardBrackets=t.forwardBrackets),"function"==typeof t.process&&this.process(t.process)}getDescription(){return this.description}isReady(){return!0}isSubgraph(){return!1}setIcon(t){return this.icon=t,this.emit("icon",this.icon)}getIcon(){return this.icon}error(e,n=[],r="error",o=null){var i,s,a,c,u;if(h(this,t),!this.outPorts[r]||!this.outPorts[r].isAttached()&&this.outPorts[r].isRequired())throw e;for(s=0,c=n.length;s<c;s++)i=n[s],this.outPorts[r].openBracket(i,{scope:o});for(this.outPorts[r].data(e,{scope:o}),a=0,u=n.length;a<u;a++)i=n[a],this.outPorts[r].closeBracket(i,{scope:o})}setUp(t){t()}tearDown(t){t()}start(t){if(this.isStarted())return t();this.setUp(e=>{if(e)return t(e);this.started=!0,this.emit("start"),t(null)})}shutdown(t){var e;e=(()=>{var e,n,r;for(r in n=this.inPorts.ports||this.inPorts)"function"==typeof(e=n[r]).clear&&e.clear();if(this.bracketContext={in:{},out:{}},!this.isStarted())return t();this.started=!1,this.emit("end"),t()}),this.tearDown(n=>{var r;return n?t(n):this.load>0?(r=function(t){t>0||(this.removeListener("deactivate",r),e())},void this.on("deactivate",r)):void e()})}isStarted(){return this.started}prepareForwarding(){var t,e,n,r,o,i,s,a;for(e in s=[],i=this.forwardBrackets)if(o=i[e],e in this.inPorts.ports){for(a=[],t=0,n=o.length;t<n;t++)(r=o[t])in this.outPorts.ports&&a.push(r);0===a.length?s.push(delete this.forwardBrackets[e]):s.push(this.forwardBrackets[e]=a)}else delete this.forwardBrackets[e];return s}isLegacy(){return!this.handle}process(t){var e,n;if("function"!=typeof t)throw new Error("Process handler must be a function");if(!this.inPorts)throw new Error("Component ports must be defined before process function");for(e in this.prepareForwarding(),this.handle=t,n=this.inPorts.ports)((t,e)=>(e.name||(e.name=t),e.on("ip",t=>this.handleIP(t,e))))(e,n[e]);return this}isForwardingInport(t){return("string"==typeof t?t:t.name)in this.forwardBrackets}isForwardingOutport(t,e){var n,r;return n="string"==typeof t?t:t.name,r="string"==typeof e?e:e.name,!!this.forwardBrackets[n]&&-1!==this.forwardBrackets[n].indexOf(r)}isOrdered(){return!!this.ordered||!!this.autoOrdering}handleIP(t,e){var n,r,o,i,d,l,h;if(e.options.triggering){if("openBracket"!==t.type||null!==this.autoOrdering||this.ordered||(u(`${this.nodeId} port '${e.name}' entered auto-ordering mode`),this.autoOrdering=!0),h={},this.isForwardingInport(e)){if("openBracket"===t.type)return;if("closeBracket"===t.type){if(o=(n=e.getBuffer(t.scope,t.index)).filter(function(t){return"data"===t.type}),this.outputQ.length>=this.load&&0===o.length){if(n[0]!==t)return;e.get(t.scope,t.index),(r=this.getBracketContext("in",e.name,t.scope,t.index).pop()).closeIp=t,p(`${this.nodeId} closeBracket-C from '${r.source}' to ${r.ports}: '${t.data}'`),h={__resolved:!0,__bracketClosingAfter:[r]},this.outputQ.push(h),this.processOutputQueue()}if(!o.length)return}}r=new s(t,this,e,h),d=new a(this.inPorts,r),l=new c(this.outPorts,r);try{this.handle(d,l,r)}catch(t){i=t,this.deactivate(r),l.sendDone(i)}r.activated||(e.isAddressable()?u(`${this.nodeId} packet on '${e.name}[${t.index}]' didn't match preconditions: ${t.type}`):u(`${this.nodeId} packet on '${e.name}' didn't match preconditions: ${t.type}`))}}getBracketContext(t,e,n,r){var o,i;return({name:i,index:o}=l.normalizePortName(e)),null!=r&&(o=r),("in"===t?this.inPorts:this.outPorts)[i].isAddressable()&&(e=`${i}[${o}]`),this.bracketContext[t][e]||(this.bracketContext[t][e]={}),this.bracketContext[t][e][n]||(this.bracketContext[t][e][n]=[]),this.bracketContext[t][e][n]}addToResult(t,e,n,r=!1){var o,i,s,a;return({name:a,index:i}=l.normalizePortName(e)),s=r?"unshift":"push",this.outPorts[a].isAddressable()?(o=i?parseInt(i):n.index,t[a]||(t[a]={}),t[a][o]||(t[a][o]=[]),n.index=o,void t[a][o][s](n)):(t[a]||(t[a]=[]),t[a][s](n))}getForwardableContexts(t,e,n){var r,o,i;return({name:i,index:o}=l.normalizePortName(e)),r=[],n.forEach((n,s)=>{var a;if(this.isForwardingOutport(t,i)&&-1===n.ports.indexOf(e)&&(!(a=this.getBracketContext("out",i,n.ip.scope,o)[s])||a.ip.data!==n.ip.data||-1===a.ports.indexOf(e)))return r.push(n)}),r}addBracketForwards(t){var e,n,r,o,i,s,a,c,u,d,l,h,f,m,g,v,y;if(null!=(h=t.__bracketClosingBefore)?h.length:void 0)for(n=0,a=(f=t.__bracketClosingBefore).length;n<a;n++)if(e=f[n],p(`${this.nodeId} closeBracket-A from '${e.source}' to ${e.ports}: '${e.closeIp.data}'`),e.ports.length)for(o=0,c=(m=e.ports).length;o<c;o++)l=m[o],r=e.closeIp.clone(),this.addToResult(t,l,r,!0),this.getBracketContext("out",l,r.scope).pop();if(t.__bracketContext&&Object.keys(t.__bracketContext).reverse().forEach(n=>{var o,i,s,a,c,u,d,l,h,f,m,g,v,y,b;if((e=t.__bracketContext[n]).length){for(g in y=[],t)if(c=t[g],0!==g.indexOf("__"))if(this.outPorts[g].isAddressable()){for(s in c)if(c[s].filter(function(t){return"data"===t.type}).length&&(v=`${g}[${s}]`,(b=this.getForwardableContexts(n,v,e)).length)){for(i=[],u=0,l=b.length;u<l;u++)o=b[u],p(`${this.nodeId} openBracket from '${n}' to '${v}': '${o.ip.data}'`),(r=o.ip.clone()).index=parseInt(s),i.push(r),o.ports.push(v),this.getBracketContext("out",g,o.ip.scope,s).push(o);for(i.reverse(),d=0,h=i.length;d<h;d++)a=i[d],this.addToResult(t,g,a,!0)}}else if(c.filter(function(t){return"data"===t.type}).length&&(b=this.getForwardableContexts(n,g,e)).length){for(i=[],m=0,f=b.length;m<f;m++)o=b[m],p(`${this.nodeId} openBracket from '${n}' to '${g}': '${o.ip.data}'`),i.push(o.ip.clone()),o.ports.push(g),this.getBracketContext("out",g,o.ip.scope).push(o);i.reverse(),y.push(function(){var e,n,r;for(r=[],n=0,e=i.length;n<e;n++)a=i[n],r.push(this.addToResult(t,g,a,!0));return r}.call(this))}return y}}),null!=(g=t.__bracketClosingAfter)?g.length:void 0)for(i=0,u=(v=t.__bracketClosingAfter).length;i<u;i++)if(e=v[i],p(`${this.nodeId} closeBracket-B from '${e.source}' to ${e.ports}: '${e.closeIp.data}'`),e.ports.length)for(s=0,d=(y=e.ports).length;s<d;s++)l=y[s],r=e.closeIp.clone(),this.addToResult(t,l,r,!1),this.getBracketContext("out",l,r.scope).pop();return delete t.__bracketClosingBefore,delete t.__bracketContext,delete t.__bracketClosingAfter}processOutputQueue(){var t,e,n,r,o,i,s,a;for(a=[];this.outputQ.length>0&&this.outputQ[0].__resolved;)s=this.outputQ.shift(),this.addBracketForwards(s),a.push(function(){var a,c,u;for(o in u=[],s)if(r=s[o],0!==o.indexOf("__"))if(this.outPorts.ports[o].isAddressable()){for(t in r)if(e=r[t],t=parseInt(t),this.outPorts.ports[o].isAttached(t))for(a=0,c=e.length;a<c;a++)n=e[a],i=`${o}[${n.index}]`,"openBracket"===n.type?d(`${this.nodeId} sending ${i} < '${n.data}'`):"closeBracket"===n.type?d(`${this.nodeId} sending ${i} > '${n.data}'`):d(`${this.nodeId} sending ${i} DATA`),this.outPorts[o].options.scoped||(n.scope=null),this.outPorts[o].sendIP(n)}else this.outPorts.ports[o].isAttached()&&u.push(function(){var t,e,s;for(s=[],t=0,e=r.length;t<e;t++)n=r[t],i=o,"openBracket"===n.type?d(`${this.nodeId} sending ${i} < '${n.data}'`):"closeBracket"===n.type?d(`${this.nodeId} sending ${i} > '${n.data}'`):d(`${this.nodeId} sending ${i} DATA`),this.outPorts[o].options.scoped||(n.scope=null),s.push(this.outPorts[o].sendIP(n));return s}.call(this));return u}.call(this));return a}activate(t){if(!t.activated)return t.activated=!0,t.deactivated=!1,this.load++,this.emit("activate",this.load),this.ordered||this.autoOrdering?this.outputQ.push(t.result):void 0}deactivate(t){if(!t.deactivated)return t.deactivated=!0,t.activated=!1,this.isOrdered()&&this.processOutputQueue(),this.load--,this.emit("deactivate",this.load)}}return t.prototype.description="",t.prototype.icon=null,t}.call(this),s=class{constructor(t,e,n,r){this.ip=t,this.nodeInstance=e,this.port=n,this.result=r,this.scope=this.ip.scope,this.activated=!1,this.deactivated=!1}activate(){return(this.result.__resolved||-1===this.nodeInstance.outputQ.indexOf(this.result))&&(this.result={}),this.nodeInstance.activate(this)}deactivate(){return this.result.__resolved||(this.result.__resolved=!0),this.nodeInstance.deactivate(this)}},a=class{constructor(t,e){this.ports=t,this.context=e,this.nodeInstance=this.context.nodeInstance,this.ip=this.context.ip,this.port=this.context.port,this.result=this.context.result,this.scope=this.context.scope}activate(){if(!this.context.activated)return this.nodeInstance.isOrdered()&&(this.result.__resolved=!1),this.nodeInstance.activate(this.context),this.port.isAddressable()?u(`${this.nodeInstance.nodeId} packet on '${this.port.name}[${this.ip.index}]' caused activation ${this.nodeInstance.load}: ${this.ip.type}`):u(`${this.nodeInstance.nodeId} packet on '${this.port.name}' caused activation ${this.nodeInstance.load}: ${this.ip.type}`)}attached(...t){var e,n,r,o;for(t.length||(t=["in"]),o=[],e=0,n=t.length;e<n;e++){if(r=t[e],!this.ports[r])throw new Error(`Node ${this.nodeInstance.nodeId} has no port '${r}'`);o.push(this.ports[r].listAttached())}return 1===t.length?o.pop():o}has(...t){var e,n,r,o;for(t.length||(t=["in"]),o="function"==typeof t[t.length-1]?t.pop():function(){return!0},e=0,n=t.length;e<n;e++)if(r=t[e],Array.isArray(r)){if(!this.ports[r[0]])throw new Error(`Node ${this.nodeInstance.nodeId} has no port '${r[0]}'`);if(!this.ports[r[0]].isAddressable())throw new Error(`Non-addressable ports, access must be with string ${r[0]}`);if(!this.ports[r[0]].has(this.scope,r[1],o))return!1}else{if(!this.ports[r])throw new Error(`Node ${this.nodeInstance.nodeId} has no port '${r}'`);if(this.ports[r].isAddressable())throw new Error(`For addressable ports, access must be with array [${r}, idx]`);if(!this.ports[r].has(this.scope,o))return!1}return!0}hasData(...t){return t.length||(t=["in"]),t.push(function(t){return"data"===t.type}),this.has.apply(this,t)}hasStream(...t){var e,n,r,o,i,s,a;for(t.length||(t=["in"]),a="function"==typeof t[t.length-1]?t.pop():function(){return!0},n=0,r=t.length;n<r;n++)if(o=t[n],i=[],[],e=!1,s=function(t){return"openBracket"===t.type?(i.push(t.data),!1):"data"===t.type?(e=a(t,i),!i.length&&e):"closeBracket"===t.type?(i.pop(),!i.length&&!!e):void 0},!this.has(o,s))return!1;return!0}get(...t){var e,n,r,o,i,s,a;for(this.activate(),t.length||(t=["in"]),a=[],e=0,o=t.length;e<o;e++){if(i=t[e],Array.isArray(i)){if([s,n]=i,!this.ports[s].isAddressable())throw new Error("Non-addressable ports, access must be with string portname")}else if(s=i,this.ports[s].isAddressable())throw new Error("For addressable ports, access must be with array [portname, idx]");this.nodeInstance.isForwardingInport(s)?(r=this.__getForForwarding(s,n),a.push(r)):(r=this.ports[s].get(this.scope,n),a.push(r))}return 1===t.length?a[0]:a}__getForForwarding(t,e){var n,r,o,i,s,a;for(a=[],r=null;i=this.ports[t].get(this.scope,e);){if("data"===i.type){r=i;break}a.push(i)}for(o=0,s=a.length;o<s;o++)"closeBracket"!==(i=a[o]).type?"openBracket"!==i.type||this.nodeInstance.getBracketContext("in",t,this.scope,e).push({ip:i,ports:[],source:t}):(this.result.__bracketClosingBefore||(this.result.__bracketClosingBefore=[]),(n=this.nodeInstance.getBracketContext("in",t,this.scope,e).pop()).closeIp=i,this.result.__bracketClosingBefore.push(n));return this.result.__bracketContext||(this.result.__bracketContext={}),this.result.__bracketContext[t]=this.nodeInstance.getBracketContext("in",t,this.scope,e).slice(0),r}getData(...t){var e,n,r,o,i;for(t.length||(t=["in"]),e=[],n=0,r=t.length;n<r;n++)if(i=t[n],null!=(o=this.get(i))){for(;"data"!==o.type&&(o=this.get(i)););e.push(o.data)}else e.push(o);return 1===t.length?e.pop():e}getStream(...t){var e,n,r,o,i,s,a,c;for(t.length||(t=["in"]),e=[],r=0,i=t.length;r<i;r++){for(s=t[r],a=[],c=[],n=!1,(o=this.get(s))||e.push(void 0);o&&("openBracket"===o.type&&(a.length||(c=[],n=!1),a.push(o.data),c.push(o)),"data"!==o.type||(c.push(o),n=!0,a.length))&&("closeBracket"!==o.type||(c.push(o),a.pop(),!n||a.length));)o=this.get(s);e.push(c)}return 1===t.length?e.pop():e}},c=class{constructor(t,e){this.ports=t,this.context=e,this.nodeInstance=this.context.nodeInstance,this.ip=this.context.ip,this.result=this.context.result,this.scope=this.context.scope}isError(t){return t instanceof Error||Array.isArray(t)&&t.length>0&&t[0]instanceof Error}error(t){var e,n,r,o,s,a,c;if((a=Array.isArray(t))||(t=[t]),!("error"in this.ports)||!this.ports.error.isAttached()&&this.ports.error.isRequired()){for(c=[],r=0,s=t.length;r<s;r++)throw e=t[r];return c}for(a&&this.sendIP("error",new i("openBracket")),n=0,o=t.length;n<o;n++)e=t[n],this.sendIP("error",e);if(a)return this.sendIP("error",new i("closeBracket"))}sendIP(t,e){var n;if(n=i.isIP(e)?e:new i("data",e),null!==this.scope&&null===n.scope&&(n.scope=this.scope),this.nodeInstance.outPorts[t].isAddressable()&&null===n.index)throw new Error("Sending packets to addressable ports requires specifying index");if(!this.nodeInstance.isOrdered())return this.nodeInstance.outPorts[t].options.scoped||(n.scope=null),this.nodeInstance.outPorts[t].sendIP(n);this.nodeInstance.addToResult(this.result,t,n)}send(t){var e,n,r,o,i,s,a,c;if(this.isError(t))return this.error(t);for(e=[],o=!1,n=0,r=(a=Object.keys(this.ports.ports)).length;n<r;n++)"error"!==(s=a[n])&&"ports"!==s&&"_callbacks"!==s&&e.push(s),o||null==t||"object"!=typeof t||-1===Object.keys(t).indexOf(s)||(o=!0);if(1!==e.length||o){if(e.length>1&&!o)throw new Error("Port must be specified for sending output");for(s in c=[],t)i=t[s],c.push(this.sendIP(s,i));return c}this.sendIP(e[0],t)}sendDone(t){return this.send(t),this.done()}pass(t,e={}){var n,r;if(!("out"in this.ports))throw new Error('output.pass() requires port "out" to be present');for(n in e)r=e[n],this.ip[n]=r;return this.ip.data=t,this.sendIP("out",this.ip),this.done()}done(t){var e,n,r,o,i,s,a,c,p;if(this.result.__resolved=!0,this.nodeInstance.activate(this.context),t&&this.error(t),s=(()=>{var t,e,n,r;return n=(r=this.nodeInstance.outputQ.filter(function(t){return!t.__resolved||(2!==Object.keys(t).length||!t.__bracketClosingAfter)})).indexOf(this.result),t=r.length,e=this.nodeInstance.load,n===t-1||(-1===n&&e===t+1||t<=1&&1===e)}),this.nodeInstance.isOrdered()&&s())for(c in p=this.nodeInstance.bracketContext.in)if((r=p[c])[this.scope]&&(a=r[this.scope]).length)for(n=a[a.length-1],e=this.nodeInstance.inPorts[n.source].getBuffer(n.ip.scope,n.ip.index);e.length&&"closeBracket"===e[0].type;)i=this.nodeInstance.inPorts[n.source].get(n.ip.scope,n.ip.index),(o=a.pop()).closeIp=i,this.result.__bracketClosingAfter||(this.result.__bracketClosingAfter=[]),this.result.__bracketClosingAfter.push(o);return u(`${this.nodeInstance.nodeId} finished processing ${this.nodeInstance.load}`),this.nodeInstance.deactivate(this.context)}},e.Component=r},function(t,e,n){var r,o,i,s;({EventEmitter:r}=n(2)),o=n(20),i=n(22),s=function(){class t extends r{constructor(t){var e,n;if(super(),this.ports={},t)for(e in t)n=t[e],this.add(e,n)}add(t,e,n){if("add"===t||"remove"===t)throw new Error("Add and remove are restricted port names");if(!t.match(/^[a-z0-9_\.\/]+$/))throw new Error(`Port names can only contain lowercase alphanumeric characters and underscores. '${t}' not allowed`);return this.ports[t]&&this.remove(t),"object"==typeof e&&e.canAttach?this.ports[t]=e:this.ports[t]=new this.model(e,n),this[t]=this.ports[t],this.emit("add",t),this}remove(t){if(!this.ports[t])throw new Error(`Port ${t} not defined`);return delete this.ports[t],delete this[t],this.emit("remove",t),this}}return t.prototype.model=o,t}.call(this),e.InPorts=class extends s{on(t,e,n){if(!this.ports[t])throw new Error(`Port ${t} not available`);return this.ports[t].on(e,n)}once(t,e,n){if(!this.ports[t])throw new Error(`Port ${t} not available`);return this.ports[t].once(e,n)}},e.OutPorts=function(){class t extends s{connect(t,e){if(!this.ports[t])throw new Error(`Port ${t} not available`);return this.ports[t].connect(e)}beginGroup(t,e,n){if(!this.ports[t])throw new Error(`Port ${t} not available`);return this.ports[t].beginGroup(e,n)}send(t,e,n){if(!this.ports[t])throw new Error(`Port ${t} not available`);return this.ports[t].send(e,n)}endGroup(t,e){if(!this.ports[t])throw new Error(`Port ${t} not available`);return this.ports[t].endGroup(e)}disconnect(t,e){if(!this.ports[t])throw new Error(`Port ${t} not available`);return this.ports[t].disconnect(e)}}return t.prototype.model=i,t}.call(this),e.normalizePortName=function(t){var e,n;return n={name:t},-1===t.indexOf("[")?n:(null!=(e=t.match(/(.*)\[([0-9]+)\]/))?e.length:void 0)?(n.name=e[1],n.index=e[2],n):t}},function(t,e,n){var r,o;r=n(21),n(4),o=class extends r{constructor(t={}){if(null==t.control&&(t.control=!1),null==t.scoped&&(t.scoped=!0),null==t.triggering&&(t.triggering=!0),t.process)throw new Error("InPort process callback is deprecated. Please use Process API");if(t.handle)throw new Error("InPort handle callback is deprecated. Please use Process API");super(t),this.prepareBuffer()}attachSocket(t,e=null){return this.hasDefault()&&t.setDataDelegate(()=>this.options.default),t.on("connect",()=>this.handleSocketEvent("connect",t,e)),t.on("begingroup",t=>this.handleSocketEvent("begingroup",t,e)),t.on("data",t=>(this.validateData(t),this.handleSocketEvent("data",t,e))),t.on("endgroup",t=>this.handleSocketEvent("endgroup",t,e)),t.on("disconnect",()=>this.handleSocketEvent("disconnect",t,e)),t.on("ip",t=>this.handleIP(t,e))}handleIP(t,e){var n;if(!this.options.control||"data"===t.type)return t.owner=this.nodeInstance,this.isAddressable()&&(t.index=e),"all"===t.datatype&&(t.datatype=this.getDataType()),this.getSchema()&&!t.schema&&(t.schema=this.getSchema()),(n=this.prepareBufferForIP(t)).push(t),this.options.control&&n.length>1&&n.shift(),this.emit("ip",t,e)}handleSocketEvent(t,e,n){return this.isAddressable()?this.emit(t,e,n):this.emit(t,e)}hasDefault(){return void 0!==this.options.default}prepareBuffer(){if(this.isAddressable())return this.options.scoped&&(this.scopedBuffer={}),this.indexedBuffer={},void(this.iipBuffer={});this.options.scoped&&(this.scopedBuffer={}),this.iipBuffer=[],this.buffer=[]}prepareBufferForIP(t){return this.isAddressable()?null!=t.scope&&this.options.scoped?(t.scope in this.scopedBuffer||(this.scopedBuffer[t.scope]=[]),t.index in this.scopedBuffer[t.scope]||(this.scopedBuffer[t.scope][t.index]=[]),this.scopedBuffer[t.scope][t.index]):t.initial?(t.index in this.iipBuffer||(this.iipBuffer[t.index]=[]),this.iipBuffer[t.index]):(t.index in this.indexedBuffer||(this.indexedBuffer[t.index]=[]),this.indexedBuffer[t.index]):null!=t.scope&&this.options.scoped?(t.scope in this.scopedBuffer||(this.scopedBuffer[t.scope]=[]),this.scopedBuffer[t.scope]):t.initial?this.iipBuffer:this.buffer}validateData(t){if(this.options.values&&-1===this.options.values.indexOf(t))throw new Error(`Invalid data='${t}' received, not in [${this.options.values}]`)}getBuffer(t,e,n=!1){if(this.isAddressable()){if(null!=t&&this.options.scoped){if(!(t in this.scopedBuffer))return;if(!(e in this.scopedBuffer[t]))return;return this.scopedBuffer[t][e]}if(n){if(!(e in this.iipBuffer))return;return this.iipBuffer[e]}if(!(e in this.indexedBuffer))return;return this.indexedBuffer[e]}if(null!=t&&this.options.scoped){if(!(t in this.scopedBuffer))return;return this.scopedBuffer[t]}return n?this.iipBuffer:this.buffer}getFromBuffer(t,e,n=!1){var r;if(null!=(r=this.getBuffer(t,e,n))?r.length:void 0)return this.options.control?r[r.length-1]:r.shift()}get(t,e){var n;return void 0!==(n=this.getFromBuffer(t,e))?n:this.getFromBuffer(null,e,!0)}hasIPinBuffer(t,e,n,r=!1){var o,i,s;if(!(null!=(o=this.getBuffer(t,e,r))?o.length:void 0))return!1;for(i=0,s=o.length;i<s;i++)if(n(o[i]))return!0;return!1}hasIIP(t,e){return this.hasIPinBuffer(null,t,e,!0)}has(t,e,n){return this.isAddressable()||(n=e,e=null),!!this.hasIPinBuffer(t,e,n)||!!this.hasIIP(e,n)}length(t,e){var n;return(n=this.getBuffer(t,e))?n.length:0}ready(t,e){return this.length(t)>0}clear(){return this.prepareBuffer()}},t.exports=o},function(t,e,n){var r,o,i;({EventEmitter:o}=n(2)),i=["all","string","number","int","object","array","boolean","color","date","bang","function","buffer","stream"],r=class extends o{constructor(t){super(),this.options=this.handleOptions(t),this.sockets=[],this.node=null,this.name=null}handleOptions(t){if(t||(t={}),t.datatype||(t.datatype="all"),void 0===t.required&&(t.required=!1),"integer"===t.datatype&&(t.datatype="int"),-1===i.indexOf(t.datatype))throw new Error(`Invalid port datatype '${t.datatype}' specified, valid are ${i.join(", ")}`);if(t.type&&!t.schema&&(t.schema=t.type,delete t.type),t.schema&&-1===t.schema.indexOf("/"))throw new Error(`Invalid port schema '${t.schema}' specified. Should be URL or MIME type`);return t}getId(){return this.node&&this.name?`${this.node} ${this.name.toUpperCase()}`:"Port"}getDataType(){return this.options.datatype}getSchema(){return this.options.schema||null}getDescription(){return this.options.description}attach(t,e=null){if(this.isAddressable()&&null!==e||(e=this.sockets.length),this.sockets[e]=t,this.attachSocket(t,e),!this.isAddressable())return this.emit("attach",t);this.emit("attach",t,e)}attachSocket(){}detach(t){var e;if(-1!==(e=this.sockets.indexOf(t))){if(this.sockets[e]=void 0,!this.isAddressable())return this.emit("detach",t);this.emit("detach",t,e)}}isAddressable(){return!!this.options.addressable}isBuffered(){return!!this.options.buffered}isRequired(){return!!this.options.required}isAttached(t=null){return this.isAddressable()&&null!==t?!!this.sockets[t]:!!this.sockets.length}listAttached(){var t,e,n,r,o;for(t=[],n=e=0,r=(o=this.sockets).length;e<r;n=++e)o[n]&&t.push(n);return t}isConnected(t=null){var e;if(this.isAddressable()){if(null===t)throw new Error(`${this.getId()}: Socket ID required`);if(!this.sockets[t])throw new Error(`${this.getId()}: Socket ${t} not available`);return this.sockets[t].isConnected()}return e=!1,this.sockets.forEach(function(t){if(t)return t.isConnected()?e=!0:void 0}),e}canAttach(){return!0}},t.exports=r},function(t,e,n){var r,o,i;r=n(21),o=n(4),i=class extends r{constructor(t={}){null==t.scoped&&(t.scoped=!0),super(t),this.cache={}}attach(t,e=null){if(super.attach(t,e),this.isCaching()&&null!=this.cache[e])return this.send(this.cache[e],e)}connect(t=null){var e,n,r,o,i;for(i=this.getSockets(t),this.checkRequired(i),r=[],e=0,n=i.length;e<n;e++)(o=i[e])&&r.push(o.connect());return r}beginGroup(t,e=null){var n;return n=this.getSockets(e),this.checkRequired(n),n.forEach(function(e){if(e)return e.beginGroup(t)})}send(t,e=null){var n;return n=this.getSockets(e),this.checkRequired(n),this.isCaching()&&t!==this.cache[e]&&(this.cache[e]=t),n.forEach(function(e){if(e)return e.send(t)})}endGroup(t=null){var e,n,r,o,i;for(i=this.getSockets(t),this.checkRequired(i),r=[],e=0,n=i.length;e<n;e++)(o=i[e])&&r.push(o.endGroup());return r}disconnect(t=null){var e,n,r,o,i;for(i=this.getSockets(t),this.checkRequired(i),r=[],e=0,n=i.length;e<n;e++)(o=i[e])&&r.push(o.disconnect());return r}sendIP(t,e,n,r,i=!0){var s,a,c,u,p,d,l;for(o.isIP(t)?r=(a=t).index:a=new o(t,e,n),l=this.getSockets(r),this.checkRequired(l),"all"===a.datatype&&(a.datatype=this.getDataType()),this.getSchema()&&!a.schema&&(a.schema=this.getSchema()),this.isCaching()&&e!==(null!=(p=this.cache[r])?p.data:void 0)&&(this.cache[r]=a),u=!0,s=0,c=l.length;s<c;s++)(d=l[s])&&(u?(d.post(a,i),u=!1):(a.clonable&&(a=a.clone()),d.post(a,i)));return this}openBracket(t=null,e={},n=null){return this.sendIP("openBracket",t,e,n)}data(t,e={},n=null){return this.sendIP("data",t,e,n)}closeBracket(t=null,e={},n=null){return this.sendIP("closeBracket",t,e,n)}checkRequired(t){if(0===t.length&&this.isRequired())throw new Error(`${this.getId()}: No connections available`)}getSockets(t){if(this.isAddressable()){if(null===t)throw new Error(`${this.getId()} Socket ID required`);return this.sockets[t]?[this.sockets[t]]:[]}return this.sockets}isCaching(){return!!this.options.caching}},t.exports=i},function(t,e){t.exports={stringPatterns:[/'[^]*?'/g,/"[^]*?"/g,/`[^]*?`/g],prePatterns:[/\[[^]*?\]/,/{[^]*?}/,/=>\s*?\([^]*?\)/,/=\s*?function\s*?\([^]*(?=[^]*\))/,/=\s*?\([^]*(?=[^]*\))/,/\s*?=[^>][^,\)]*/],postPatterns:[/\([^]*?\)/]}},function(t,e,n){var r,o,i,s,a,c,u=[].indexOf;c={Runtime:n(100),Graph:n(101),Network:n(102),Component:n(103)},o=n(3)("noflo-runtime-base:messaging:receive"),i=n(3)("noflo-runtime-base:messaging:receive:payload"),s=n(3)("noflo-runtime-base:messaging:send"),a=n(3)("noflo-runtime-base:messaging:send:payload"),r=class{constructor(t){this.options=t,this.options||(this.options={}),this.version="0.7",this.component=new c.Component(this),this.graph=new c.Graph(this),this.network=new c.Network(this),this.runtime=new c.Runtime(this),this.context=null,null!=this.options.defaultGraph&&(this.options.defaultGraph.baseDir=this.options.baseDir,"default/main",this.context="none",this.graph.registerGraph("default/main",this.options.defaultGraph),this.network._startNetwork(this.options.defaultGraph,"default/main",this.context,function(t){if(t)throw t})),null!=this.options.captureOutput&&this.options.captureOutput&&this.startCapture(),this.options.capabilities||(this.options.capabilities=["protocol:graph","protocol:component","protocol:network","protocol:runtime","component:setsource","component:getsource","graph:readonly","network:data","network:control","network:status"]),this.options.defaultPermissions||(this.options.defaultPermissions=[]),this.options.permissions||(this.options.permissions={})}canDo(t,e){var n,r;return n="string"==typeof t?[t]:t,r=this.getPermitted(e),n.filter(function(t){return u.call(r,t)>=0}).length>0}canInput(t,e,n){if("graph"===t)return this.canDo(["protocol:graph"],n);switch(`${t}:${e}`){case"component:list":return this.canDo(["protocol:component"],n);case"component:getsource":return this.canDo(["component:getsource"],n);case"component:source":return this.canDo(["component:setsource"],n);case"network:edges":return this.canDo(["network:data","protocol:network"],n);case"network:start":case"network:stop":case"network:debug":return this.canDo(["network:control","protocol:network"],n);case"network:getstatus":return this.canDo(["network:status","network:control","protocol:network"],n);case"runtime:getruntime":return!0;case"runtime:packet":return this.canDo(["protocol:runtime"],n)}return!1}getPermitted(t){return t?this.options.permissions[t]?this.options.permissions[t]:[]:this.options.defaultPermissions}send(t,e,n,r){return s(`${t} ${e}`),a(n)}sendAll(t,e,n,r){}receive(t,e,n,r){if(n||(n={}),o(`${t} ${e}`),i(n),this.canInput(t,e,n.secret))switch(this.context=r,t){case"runtime":return this.runtime.receive(e,n,r);case"graph":return this.graph.receive(e,n,r);case"network":return this.network.receive(e,n,r);case"component":return this.component.receive(e,n,r);default:return this.send(t,"error",new Error(`Protocol ${t} is not supported`),r)}else this.send(t,"error",new Error(`${t}:${e} is not permitted`),r)}},t.exports=r,t.exports.trace=n(106),t.exports.direct=n(113)},function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var o=t[r];"."===o?t.splice(r,1):".."===o?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return r.exec(t).slice(1)};function i(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var s=o>=0?arguments[o]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(e=s+"/"+e,r="/"===s.charAt(0))}return(r?"/":"")+(e=n(i(e.split("/"),function(t){return!!t}),!r).join("/"))||"."},e.normalize=function(t){var r=e.isAbsolute(t),o="/"===s(t,-1);return(t=n(i(t.split("/"),function(t){return!!t}),!r).join("/"))||r||(t="."),t&&o&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(i(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var o=r(t.split("/")),i=r(n.split("/")),s=Math.min(o.length,i.length),a=s,c=0;c<s;c++)if(o[c]!==i[c]){a=c;break}var u=[];for(c=a;c<o.length;c++)u.push("..");return(u=u.concat(i.slice(a))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=o(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},e.basename=function(t,e){var n=o(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){return o(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n(1))},function(t,e){e.normalizeOptions=function(t){const e=t;return void 0===t.catchExceptions&&(e.catchExceptions=!0,window.location.search&&"debug"===window.location.search.substring(1)&&(e.catchExceptions=!1)),e},e.subscribe=function(t,e){t.addEventListener("message",t=>{let{data:n}=t;"string"==typeof t.data&&(n=JSON.parse(t.data)),n.protocol&&n.command&&e(n,t)})}},function(t){t.exports={properties:{name:"main",environment:{type:"noflo-browser",content:"<button id='button'>Go!</button>\n<p id='message'></p>"},icon:""},inports:{},outports:{},groups:[],processes:{"dom/GetElement_7amk2":{component:"dom/GetElement",metadata:{label:"dom/GetElement",x:252,y:180,width:72,height:72}},"core/Output_cg49":{component:"core/Output",metadata:{label:"core/Output",x:432,y:360,width:72,height:72}},"dom/WriteHtml_fpz6j":{component:"dom/WriteHtml",metadata:{label:"dom/WriteHtml",x:684,y:288,width:72,height:72}},"dom/GetElement_xvz54":{component:"dom/GetElement",metadata:{label:"dom/GetElement",x:252,y:288,width:72,height:72}},"interaction/ListenMouse_1l373":{component:"interaction/ListenMouse",metadata:{label:"interaction/ListenMouse",x:432,y:180,width:72,height:72}},"core/Kick_ey1nh":{component:"core/Kick",metadata:{label:"core/Kick",x:576,y:180,width:72,height:72}}},connections:[{src:{process:"dom/GetElement_xvz54",port:"element"},tgt:{process:"dom/WriteHtml_fpz6j",port:"container"},metadata:{}},{src:{process:"dom/GetElement_7amk2",port:"element"},tgt:{process:"interaction/ListenMouse_1l373",port:"element"},metadata:{route:0}},{src:{process:"dom/GetElement_7amk2",port:"error"},tgt:{process:"core/Output_cg49",port:"in"},metadata:{route:1}},{src:{process:"dom/GetElement_xvz54",port:"error"},tgt:{process:"core/Output_cg49",port:"in"},metadata:{route:1}},{src:{process:"interaction/ListenMouse_1l373",port:"click"},tgt:{process:"core/Kick_ey1nh",port:"in"},metadata:{}},{src:{process:"core/Kick_ey1nh",port:"out"},tgt:{process:"dom/WriteHtml_fpz6j",port:"html"},metadata:{}},{data:"#button",tgt:{process:"dom/GetElement_7amk2",port:"selector"}},{data:"#message",tgt:{process:"dom/GetElement_xvz54",port:"selector"}},{data:"Hello World!",tgt:{process:"core/Kick_ey1nh",port:"data"}}]}},function(t,e,n){var r,o,i,s,a,c;({EventEmitter:r}=n(2)),i=n(13),a=n(32),o=function(){class t extends r{constructor(t="",e={}){super(),this.setMaxListeners(0),this.name=t,this.properties={},this.nodes=[],this.edges=[],this.initializers=[],this.inports={},this.outports={},this.groups=[],this.transaction={id:null,depth:0},this.caseSensitive=e.caseSensitive||!1}getPortName(t){return this.caseSensitive?t:t.toLowerCase()}startTransaction(t,e){if(this.transaction.id)throw Error("Nested transactions not supported");return this.transaction.id=t,this.transaction.depth=1,this.emit("startTransaction",t,e)}endTransaction(t,e){if(!this.transaction.id)throw Error("Attempted to end non-existing transaction");return this.transaction.id=null,this.transaction.depth=0,this.emit("endTransaction",t,e)}checkTransactionStart(){return this.transaction.id?"implicit"===this.transaction.id?this.transaction.depth+=1:void 0:this.startTransaction("implicit")}checkTransactionEnd(){if("implicit"===this.transaction.id&&(this.transaction.depth-=1),0===this.transaction.depth)return this.endTransaction("implicit")}setProperties(t){var e,n,r;for(n in this.checkTransactionStart(),e=i(this.properties),t)r=t[n],this.properties[n]=r;return this.emit("changeProperties",this.properties,e),this.checkTransactionEnd()}addInport(t,e,n,r){if(this.getNode(e))return t=this.getPortName(t),this.checkTransactionStart(),this.inports[t]={process:e,port:this.getPortName(n),metadata:r},this.emit("addInport",t,this.inports[t]),this.checkTransactionEnd()}removeInport(t){var e;if(t=this.getPortName(t),this.inports[t])return this.checkTransactionStart(),e=this.inports[t],this.setInportMetadata(t,{}),delete this.inports[t],this.emit("removeInport",t,e),this.checkTransactionEnd()}renameInport(t,e){if(t=this.getPortName(t),e=this.getPortName(e),this.inports[t]&&e!==t)return this.checkTransactionStart(),this.inports[e]=this.inports[t],delete this.inports[t],this.emit("renameInport",t,e),this.checkTransactionEnd()}setInportMetadata(t,e){var n,r,o;if(t=this.getPortName(t),this.inports[t]){for(r in this.checkTransactionStart(),n=i(this.inports[t].metadata),this.inports[t].metadata||(this.inports[t].metadata={}),e)null!=(o=e[r])?this.inports[t].metadata[r]=o:delete this.inports[t].metadata[r];return this.emit("changeInport",t,this.inports[t],n,e),this.checkTransactionEnd()}}addOutport(t,e,n,r){if(this.getNode(e))return t=this.getPortName(t),this.checkTransactionStart(),this.outports[t]={process:e,port:this.getPortName(n),metadata:r},this.emit("addOutport",t,this.outports[t]),this.checkTransactionEnd()}removeOutport(t){var e;if(t=this.getPortName(t),this.outports[t])return this.checkTransactionStart(),e=this.outports[t],this.setOutportMetadata(t,{}),delete this.outports[t],this.emit("removeOutport",t,e),this.checkTransactionEnd()}renameOutport(t,e){if(t=this.getPortName(t),e=this.getPortName(e),this.outports[t])return this.checkTransactionStart(),this.outports[e]=this.outports[t],delete this.outports[t],this.emit("renameOutport",t,e),this.checkTransactionEnd()}setOutportMetadata(t,e){var n,r,o;if(t=this.getPortName(t),this.outports[t]){for(r in this.checkTransactionStart(),n=i(this.outports[t].metadata),this.outports[t].metadata||(this.outports[t].metadata={}),e)null!=(o=e[r])?this.outports[t].metadata[r]=o:delete this.outports[t].metadata[r];return this.emit("changeOutport",t,this.outports[t],n,e),this.checkTransactionEnd()}}addGroup(t,e,n){var r;return this.checkTransactionStart(),r={name:t,nodes:e,metadata:n},this.groups.push(r),this.emit("addGroup",r),this.checkTransactionEnd()}renameGroup(t,e){var n,r,o,i;for(this.checkTransactionStart(),r=0,o=(i=this.groups).length;r<o;r++)(n=i[r])&&n.name===t&&(n.name=e,this.emit("renameGroup",t,e));return this.checkTransactionEnd()}removeGroup(t){var e,n,r,o;for(this.checkTransactionStart(),n=0,r=(o=this.groups).length;n<r;n++)(e=o[n])&&e.name===t&&(this.setGroupMetadata(e.name,{}),this.groups.splice(this.groups.indexOf(e),1),this.emit("removeGroup",e));return this.checkTransactionEnd()}setGroupMetadata(t,e){var n,r,o,s,a,c,u;for(this.checkTransactionStart(),o=0,a=(c=this.groups).length;o<a;o++)if((r=c[o])&&r.name===t){for(s in n=i(r.metadata),e)null!=(u=e[s])?r.metadata[s]=u:delete r.metadata[s];this.emit("changeGroup",r,n,e)}return this.checkTransactionEnd()}addNode(t,e,n){var r;return this.checkTransactionStart(),n||(n={}),r={id:t,component:e,metadata:n},this.nodes.push(r),this.emit("addNode",r),this.checkTransactionEnd(),r}removeNode(t){var e,n,r,o,i,s,a,c,u,p,d,l,h,f,m,g,v,y,b,w,E,P,k,C,S,O;if(y=this.getNode(t)){for(this.checkTransactionStart(),O=[],r=0,u=(E=this.edges).length;r<u;r++)(e=E[r]).from.node!==y.id&&e.to.node!==y.id||O.push(e);for(s=0,p=O.length;s<p;s++)e=O[s],this.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);for(O=[],a=0,d=(P=this.initializers).length;a<d;a++)(i=P[a]).to.node===y.id&&O.push(i);for(c=0,l=O.length;c<l;c++)i=O[c],this.removeInitial(i.to.node,i.to.port);for(w in O=[],k=this.inports)k[w].process===t&&O.push(w);for(g=0,h=O.length;g<h;g++)w=O[g],this.removeInport(w);for(w in O=[],C=this.outports)C[w].process===t&&O.push(w);for(v=0,f=O.length;v<f;v++)w=O[v],this.removeOutport(w);for(b=0,m=(S=this.groups).length;b<m;b++)(n=S[b])&&-1!==(o=n.nodes.indexOf(t))&&n.nodes.splice(o,1);return this.setNodeMetadata(t,{}),-1!==this.nodes.indexOf(y)&&this.nodes.splice(this.nodes.indexOf(y),1),this.emit("removeNode",y),this.checkTransactionEnd()}}getNode(t){var e,n,r,o;for(e=0,n=(o=this.nodes).length;e<n;e++)if((r=o[e])&&r.id===t)return r;return null}renameNode(t,e){var n,r,o,i,s,a,c,u,p,d,l,h,f,m,g,v,y,b;if(this.checkTransactionStart(),l=this.getNode(t)){for(l.id=e,o=0,u=(m=this.edges).length;o<u;o++)(n=m[o])&&(n.from.node===t&&(n.from.node=e),n.to.node===t&&(n.to.node=e));for(a=0,p=(g=this.initializers).length;a<p;a++)(i=g[a])&&i.to.node===t&&(i.to.node=e);for(f in v=this.inports)(h=v[f]).process===t&&(h.process=e);for(f in y=this.outports)(h=y[f]).process===t&&(h.process=e);for(c=0,d=(b=this.groups).length;c<d;c++)(r=b[c])&&-1!==(s=r.nodes.indexOf(t))&&(r.nodes[s]=e);return this.emit("renameNode",t,e),this.checkTransactionEnd()}}setNodeMetadata(t,e){var n,r,o,s;if(o=this.getNode(t)){for(r in this.checkTransactionStart(),n=i(o.metadata),o.metadata||(o.metadata={}),e)null!=(s=e[r])?o.metadata[r]=s:delete o.metadata[r];return this.emit("changeNode",o,n,e),this.checkTransactionEnd()}}addEdge(t,e,n,r,o={}){var i,s,a,c;for(e=this.getPortName(e),r=this.getPortName(r),s=0,a=(c=this.edges).length;s<a;s++)if((i=c[s]).from.node===t&&i.from.port===e&&i.to.node===n&&i.to.port===r)return;if(this.getNode(t)&&this.getNode(n))return this.checkTransactionStart(),i={from:{node:t,port:e},to:{node:n,port:r},metadata:o},this.edges.push(i),this.emit("addEdge",i),this.checkTransactionEnd(),i}addEdgeIndex(t,e,n,r,o,i,s={}){var a;if(this.getNode(t)&&this.getNode(r))return e=this.getPortName(e),o=this.getPortName(o),null===i&&(i=void 0),null===n&&(n=void 0),s||(s={}),this.checkTransactionStart(),a={from:{node:t,port:e,index:n},to:{node:r,port:o,index:i},metadata:s},this.edges.push(a),this.emit("addEdge",a),this.checkTransactionEnd(),a}removeEdge(t,e,n,r){var o,i,s,a,c,u,p,d,l,h,f,m;if(this.checkTransactionStart(),e=this.getPortName(e),r=this.getPortName(r),m=[],f=[],n&&r)for(s=i=0,u=(l=this.edges).length;i<u;s=++i)(o=l[s]).from.node===t&&o.from.port===e&&o.to.node===n&&o.to.port===r?(this.setEdgeMetadata(o.from.node,o.from.port,o.to.node,o.to.port,{}),m.push(o)):f.push(o);else for(s=a=0,p=(h=this.edges).length;a<p;s=++a)(o=h[s]).from.node===t&&o.from.port===e||o.to.node===t&&o.to.port===e?(this.setEdgeMetadata(o.from.node,o.from.port,o.to.node,o.to.port,{}),m.push(o)):f.push(o);for(this.edges=f,c=0,d=m.length;c<d;c++)o=m[c],this.emit("removeEdge",o);return this.checkTransactionEnd()}getEdge(t,e,n,r){var o,i,s,a,c;for(e=this.getPortName(e),r=this.getPortName(r),s=i=0,a=(c=this.edges).length;i<a;s=++i)if((o=c[s])&&o.from.node===t&&o.from.port===e&&o.to.node===n&&o.to.port===r)return o;return null}setEdgeMetadata(t,e,n,r,o){var s,a,c,u;if(a=this.getEdge(t,e,n,r)){for(c in this.checkTransactionStart(),s=i(a.metadata),a.metadata||(a.metadata={}),o)null!=(u=o[c])?a.metadata[c]=u:delete a.metadata[c];return this.emit("changeEdge",a,s,o),this.checkTransactionEnd()}}addInitial(t,e,n,r){var o;if(this.getNode(e))return n=this.getPortName(n),this.checkTransactionStart(),o={from:{data:t},to:{node:e,port:n},metadata:r},this.initializers.push(o),this.emit("addInitial",o),this.checkTransactionEnd(),o}addInitialIndex(t,e,n,r,o){var i;if(this.getNode(e))return null===r&&(r=void 0),n=this.getPortName(n),this.checkTransactionStart(),i={from:{data:t},to:{node:e,port:n,index:r},metadata:o},this.initializers.push(i),this.emit("addInitial",i),this.checkTransactionEnd(),i}addGraphInitial(t,e,n){var r;if(r=this.inports[e])return this.addInitial(t,r.process,r.port,n)}addGraphInitialIndex(t,e,n,r){var o;if(o=this.inports[e])return this.addInitialIndex(t,o.process,o.port,n,r)}removeInitial(t,e){var n,r,o,i,s,a,c,u,p;for(e=this.getPortName(e),this.checkTransactionStart(),p=[],u=[],o=r=0,s=(c=this.initializers).length;r<s;o=++r)(n=c[o]).to.node===t&&n.to.port===e?p.push(n):u.push(n);for(this.initializers=u,i=0,a=p.length;i<a;i++)n=p[i],this.emit("removeInitial",n);return this.checkTransactionEnd()}removeGraphInitial(t){var e;if(e=this.inports[t])return this.removeInitial(e.process,e.port)}toDOT(){var t,e,n,r,o,i,s,a,c,u,p,d,l,h,f,m;for(t=function(t){return t.replace(/\s*/g,"")},e=function(t){return t.replace(/\./g,"")},n="digraph {\n",o=0,u=(h=this.nodes).length;o<u;o++)n+=`    ${t((l=h[o]).id)} [label=${l.id} shape=box]\n`;for(i=a=0,p=(f=this.initializers).length;a<p;i=++a)n+=`    data${i} [label="'${"function"==typeof(s=f[i]).from.data?"Function":s.from.data}'" shape=plaintext]\n`,n+=`    data${i} -> ${t(s.to.node)}[headlabel=${e(s.to.port)} labelfontcolor=blue labelfontsize=8.0]\n`;for(c=0,d=(m=this.edges).length;c<d;c++)n+=`    ${t((r=m[c]).from.node)} -> ${t(r.to.node)}[taillabel=${e(r.from.port)} headlabel=${e(r.to.port)} labelfontcolor=blue labelfontsize=8.0]\n`;return n+="}"}toYUML(){var t,e,n,r,o,i,s,a,c;for(c=[],e=0,o=(s=this.initializers).length;e<o;e++)n=s[e],c.push(`(start)[${n.to.port}]->(${n.to.node})`);for(r=0,i=(a=this.edges).length;r<i;r++)t=a[r],c.push(`(${t.from.node})[${t.from.port}]->(${t.to.node})`);return c.join(",")}toJSON(){var t,e,n,r,o,i,s,a,c,u,p,d,l,h,f,m,g,v,y,b,w,E,P,k,C,S;for(g in a={caseSensitive:this.caseSensitive,properties:{},inports:{},outports:{},groups:[],processes:{},connections:[]},this.name&&(a.properties.name=this.name),y=this.properties)S=y[g],a.properties[g]=S;for(v in b=this.inports)m=b[v],a.inports[v]=m;for(v in w=this.outports)m=w[v],a.outports[v]=m;for(o=0,p=(E=this.groups).length;o<p;o++)r={name:(n=E[o]).name,nodes:n.nodes},Object.keys(n.metadata).length&&(r.metadata=n.metadata),a.groups.push(r);for(s=0,d=(P=this.nodes).length;s<d;s++)f=P[s],a.processes[f.id]={component:f.component},f.metadata&&(a.processes[f.id].metadata=f.metadata);for(c=0,l=(k=this.edges).length;c<l;c++)t={src:{process:(e=k[c]).from.node,port:e.from.port,index:e.from.index},tgt:{process:e.to.node,port:e.to.port,index:e.to.index}},Object.keys(e.metadata).length&&(t.metadata=e.metadata),a.connections.push(t);for(u=0,h=(C=this.initializers).length;u<h;u++)i=C[u],a.connections.push({data:i.from.data,tgt:{process:i.to.node,port:i.to.port,index:i.to.index}});return a}save(t,e){var r;return a.isBrowser()?e(new Error("Saving graphs not supported on browser")):(r=JSON.stringify(this.toJSON(),null,4),t.match(/\.json$/)||(t=`${t}.json`),n(5).writeFile(t,r,"utf-8",function(n,r){return n?e(n):e(null,t)}))}}return t.prototype.name="",t.prototype.caseSensitive=!1,t.prototype.properties={},t.prototype.nodes=[],t.prototype.edges=[],t.prototype.initializers=[],t.prototype.inports={},t.prototype.outports={},t.prototype.groups=[],t}.call(this),e.Graph=o,e.createGraph=function(t,e){return new o(t,e)},e.loadJSON=function(t,e,n={}){var r,i,s,a,c,u,p,d,l,h,f,m,g,v,y,b,w,E,P,k,C;for(g in"string"==typeof t&&(t=JSON.parse(t)),t.properties||(t.properties={}),t.processes||(t.processes={}),t.connections||(t.connections=[]),r=t.caseSensitive||!1,(a=new o(t.properties.name,{caseSensitive:r})).startTransaction("loadJSON",n),m={},y=t.properties)C=y[g],"name"!==g&&(m[g]=C);for(p in a.setProperties(m),b=t.processes)(s=b[p]).metadata||(s.metadata={}),a.addNode(p,s.component,s.metadata);for(u=0,l=(w=t.connections).length;u<l;u++)n=(i=w[u]).metadata?i.metadata:{},void 0===i.data?"number"!=typeof i.src.index&&"number"!=typeof i.tgt.index?a.addEdge(i.src.process,a.getPortName(i.src.port),i.tgt.process,a.getPortName(i.tgt.port),n):a.addEdgeIndex(i.src.process,a.getPortName(i.src.port),i.src.index,i.tgt.process,a.getPortName(i.tgt.port),i.tgt.index,n):"number"==typeof i.tgt.index?a.addInitialIndex(i.data,i.tgt.process,a.getPortName(i.tgt.port),i.tgt.index,n):a.addInitial(i.data,i.tgt.process,a.getPortName(i.tgt.port),n);if(t.inports)for(v in E=t.inports)f=E[v],a.addInport(v,f.process,a.getPortName(f.port),f.metadata);if(t.outports)for(v in P=t.outports)f=P[v],a.addOutport(v,f.process,a.getPortName(f.port),f.metadata);if(t.groups)for(d=0,h=(k=t.groups).length;d<h;d++)c=k[d],a.addGroup(c.name,c.nodes,c.metadata||{});return a.endTransaction("loadJSON"),e(null,a)},e.loadFBP=function(t,r,o={},i=!1){var s;try{s=n(33).parse(t,{caseSensitive:i})}catch(t){return r(t)}return e.loadJSON(s,r,o)},e.loadHTTP=function(t,e){var n;return(n=new XMLHttpRequest).onreadystatechange=function(){if(4===n.readyState)return 200!==n.status?e(new Error(`Failed to load ${t}: HTTP ${n.status}`)):e(null,n.responseText)},n.open("GET",t,!0),n.send()},e.loadFile=function(t,r,o={},i=!1){if(!a.isBrowser())return n(5).readFile(t,"utf-8",function(n,o){var s;return n?r(n):"fbp"===t.split(".").pop()?e.loadFBP(o,r,{},i):(s=JSON.parse(o),e.loadJSON(s,r,{}))});e.loadHTTP(t,function(n,i){var s;return n?r(n):"fbp"===t.split(".").pop()?e.loadFBP(i,r,o):(s=JSON.parse(i),e.loadJSON(s,r,o))})},c=function(t){var e,n,r,o,s,a,c,u,p,d,l,h,f,m,g,v,y,b,w,E;for(r=0,u=(m=i(t.groups).reverse()).length;r<u;r++)null!=(n=m[r])&&t.removeGroup(n.name);for(f in g=i(t.outports))g[f],t.removeOutport(f);for(f in v=i(t.inports))v[f],t.removeInport(f);for(t.setProperties({}),s=0,p=(y=i(t.initializers).reverse()).length;s<p;s++)o=y[s],t.removeInitial(o.to.node,o.to.port);for(a=0,d=(b=i(t.edges).reverse()).length;a<d;a++)e=b[a],t.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);for(E=[],c=0,l=(w=i(t.nodes).reverse()).length;c<l;c++)h=w[c],E.push(t.removeNode(h.id));return E},s=function(t,e){var n,r,o,i,s,a,u,p,d,l,h,f,m,g,v,y,b,w,E,P,k;for(c(t),o=0,p=(v=e.nodes).length;o<p;o++)f=v[o],t.addNode(f.id,f.component,f.metadata);for(s=0,d=(y=e.edges).length;s<d;s++)n=y[s],t.addEdge(n.from.node,n.from.port,n.to.node,n.to.port,n.metadata);for(a=0,l=(b=e.initializers).length;a<l;a++)i=b[a],t.addInitial(i.from.data,i.to.node,i.to.port,i.metadata);for(g in t.setProperties(e.properties),w=e.inports)m=w[g],t.addInport(g,m.process,m.port,m.metadata);for(g in E=e.outports)m=E[g],t.addOutport(g,m.process,m.port,m.metadata);for(k=[],u=0,h=(P=e.groups).length;u<h;u++)r=P[u],k.push(t.addGroup(r.name,r.nodes,r.metadata));return k},e.equivalent=function(t,e,n={}){return JSON.stringify(t)===JSON.stringify(e)},e.mergeResolveTheirs=s},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=u(t),r=n[0],s=n[1],a=new i(function(t,e,n){return 3*(e+n)/4-n}(0,r,s)),c=0,p=s>0?r-4:r,d=0;d<p;d+=4)e=o[t.charCodeAt(d)]<<18|o[t.charCodeAt(d+1)]<<12|o[t.charCodeAt(d+2)]<<6|o[t.charCodeAt(d+3)],a[c++]=e>>16&255,a[c++]=e>>8&255,a[c++]=255&e;2===s&&(e=o[t.charCodeAt(d)]<<2|o[t.charCodeAt(d+1)]>>4,a[c++]=255&e);1===s&&(e=o[t.charCodeAt(d)]<<10|o[t.charCodeAt(d+1)]<<4|o[t.charCodeAt(d+2)]>>2,a[c++]=e>>8&255,a[c++]=255&e);return a},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],s=0,a=n-o;s<a;s+=16383)i.push(p(t,s,s+16383>a?a:s+16383));1===o?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)r[a]=s[a],o[s.charCodeAt(a)]=a;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function p(t,e,n){for(var o,i,s=[],a=e;a<n;a+=3)o=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,p=-7,d=n?o-1:0,l=n?-1:1,h=t[e+d];for(d+=l,i=h&(1<<-p)-1,h>>=-p,p+=a;p>0;i=256*i+t[e+d],d+=l,p-=8);for(s=i&(1<<-p)-1,i>>=-p,p+=r;p>0;s=256*s+t[e+d],d+=l,p-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,r),i-=u}return(h?-1:1)*s*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var s,a,c,u=8*i-o-1,p=(1<<u)-1,d=p>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,f=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=p):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+d>=1?l/c:l*Math.pow(2,1-d))*c>=2&&(s++,c/=2),s+d>=p?(a=0,s=p):s+d>=1?(a=(e*c-1)*Math.pow(2,o),s+=d):(a=e*Math.pow(2,d-1)*Math.pow(2,o),s=0));o>=8;t[n+h]=255&a,h+=f,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;t[n+h]=255&s,h+=f,s/=256,u-=8);t[n+h-f]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){(function(t){e.isBrowser=function(){return void 0===t||!t.execPath||!t.execPath.match(/node|iojs/)},e.deprecated=function(n){if(!e.isBrowser()){if(t.env.NOFLO_FATAL_DEPRECATED)throw new Error(n);return console.warn(n)}if(window.NOFLO_FATAL_DEPRECATED)throw new Error(n);console.warn(n)}}).call(this,n(1))},function(t,e,n){t.exports=function(){"use strict";function t(e,n,r,o){this.message=e,this.expected=n,this.found=r,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(t,Error),{SyntaxError:t,parse:function(e){var r,o,i=arguments.length>1?arguments[1]:{},s=this,a={},c={start:un},u=un,p=function(){return s.getResult()},d="INPORT=",l={type:"literal",value:"INPORT=",description:'"INPORT="'},h=".",f={type:"literal",value:".",description:'"."'},m=":",g={type:"literal",value:":",description:'":"'},v=function(t,e,n){return s.registerInports(t,e,n)},y="OUTPORT=",b={type:"literal",value:"OUTPORT=",description:'"OUTPORT="'},w=function(t,e,n){return s.registerOutports(t,e,n)},E="DEFAULT_INPORT=",P={type:"literal",value:"DEFAULT_INPORT=",description:'"DEFAULT_INPORT="'},k=function(t){jn=t},C="DEFAULT_OUTPORT=",S={type:"literal",value:"DEFAULT_OUTPORT=",description:'"DEFAULT_OUTPORT="'},O=function(t){Gn=t},x=function(t){return s.registerAnnotation(t[0],t[1])},I=function(t){return s.registerEdges(t)},D=",",A={type:"literal",value:",",description:'","'},N=/^[\n\r\u2028\u2029]/,_={type:"class",value:"[\\n\\r\\u2028\\u2029]",description:"[\\n\\r\\u2028\\u2029]"},T="#",R={type:"literal",value:"#",description:'"#"'},L="->",B={type:"literal",value:"->",description:'"->"'},M=function(t,e){return[t,e]},j=function(t,e,n){return[{tgt:Yn(e,t)},{src:Kn(e,n)}]},G=function(t,e){return{src:Kn(t,e)}},U=function(t,e){return{tgt:Yn(e,t)}},F="'",$={type:"literal",value:"'",description:'"\'"'},q=function(t){return{data:t.join("")}},z=function(t){return{data:t}},H=function(t){return t},Y=/^[a-zA-Z_]/,K={type:"class",value:"[a-zA-Z_]",description:"[a-zA-Z_]"},W=/^[a-zA-Z0-9_\-]/,J={type:"class",value:"[a-zA-Z0-9_\\-]",description:"[a-zA-Z0-9_\\-]"},X=function(t){return zn(t)},V=function(t,e){return s.addNode(t,e),t},Z=function(t){return s.addAnonymousNode(t,sn(Qe,Ze).start.offset)},Q="(",tt={type:"literal",value:"(",description:'"("'},et=/^[a-zA-Z\/\-0-9_]/,nt={type:"class",value:"[a-zA-Z/\\-0-9_]",description:"[a-zA-Z/\\-0-9_]"},rt=")",ot={type:"literal",value:")",description:'")"'},it=function(t,e){var n={};return n.comp=t?t.join(""):"",e&&(n.meta=e.join("").split(",")),n},st=/^[a-zA-Z\/=_,0-9]/,at={type:"class",value:"[a-zA-Z/=_,0-9]",description:"[a-zA-Z/=_,0-9]"},ct=function(t){return t},ut="@",pt={type:"literal",value:"@",description:'"@"'},dt=/^[a-zA-Z0-9\-_]/,lt={type:"class",value:"[a-zA-Z0-9\\-_]",description:"[a-zA-Z0-9\\-_]"},ht=/^[a-zA-Z0-9\-_ .]/,ft={type:"class",value:"[a-zA-Z0-9\\-_ \\.]",description:"[a-zA-Z0-9\\-_ \\.]"},mt=function(t,e){return[t.join(""),e.join("")]},gt=function(t,e){return{port:i.caseSensitive?t:t.toLowerCase(),index:null!=e?e:void 0}},vt=function(t){return t},yt=/^[a-zA-Z.0-9_]/,bt={type:"class",value:"[a-zA-Z.0-9_]",description:"[a-zA-Z.0-9_]"},wt=function(t){return zn(t)},Et="[",Pt={type:"literal",value:"[",description:'"["'},kt=/^[0-9]/,Ct={type:"class",value:"[0-9]",description:"[0-9]"},St="]",Ot={type:"literal",value:"]",description:'"]"'},xt=function(t){return parseInt(t.join(""))},It=/^[^\n\r\u2028\u2029]/,Dt={type:"class",value:"[^\\n\\r\\u2028\\u2029]",description:"[^\\n\\r\\u2028\\u2029]"},At=/^[\\]/,Nt={type:"class",value:"[\\\\]",description:"[\\\\]"},_t=/^[']/,Tt={type:"class",value:"[']",description:"[']"},Rt=function(){return"'"},Lt=/^[^']/,Bt={type:"class",value:"[^']",description:"[^']"},Mt=" ",jt={type:"literal",value:" ",description:'" "'},Gt=function(t){return t},Ut="{",Ft={type:"literal",value:"{",description:'"{"'},$t="}",qt={type:"literal",value:"}",description:'"}"'},zt={type:"other",description:"whitespace"},Ht=/^[ \t\n\r]/,Yt={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},Kt="false",Wt={type:"literal",value:"false",description:'"false"'},Jt=function(){return!1},Xt="null",Vt={type:"literal",value:"null",description:'"null"'},Zt=function(){return null},Qt="true",te={type:"literal",value:"true",description:'"true"'},ee=function(){return!0},ne=function(t,e){return e},re=function(t,e){var n,r={};for(r[t.name]=t.value,n=0;n<e.length;n++)r[e[n].name]=e[n].value;return r},oe=function(t){return null!==t?t:{}},ie=function(t,e){return{name:t,value:e}},se=function(t,e){return e},ae=function(t,e){return[t].concat(e)},ce=function(t){return null!==t?t:[]},ue={type:"other",description:"number"},pe=function(){return parseFloat(e.substring(Qe,Ze))},de=/^[1-9]/,le={type:"class",value:"[1-9]",description:"[1-9]"},he=/^[eE]/,fe={type:"class",value:"[eE]",description:"[eE]"},me="-",ge={type:"literal",value:"-",description:'"-"'},ve="+",ye={type:"literal",value:"+",description:'"+"'},be="0",we={type:"literal",value:"0",description:'"0"'},Ee={type:"other",description:"string"},Pe=function(t){return t.join("")},ke='"',Ce={type:"literal",value:'"',description:'"\\""'},Se="\\",Oe={type:"literal",value:"\\",description:'"\\\\"'},xe="/",Ie={type:"literal",value:"/",description:'"/"'},De="b",Ae={type:"literal",value:"b",description:'"b"'},Ne=function(){return"\b"},_e="f",Te={type:"literal",value:"f",description:'"f"'},Re=function(){return"\f"},Le="n",Be={type:"literal",value:"n",description:'"n"'},Me=function(){return"\n"},je="r",Ge={type:"literal",value:"r",description:'"r"'},Ue=function(){return"\r"},Fe="t",$e={type:"literal",value:"t",description:'"t"'},qe=function(){return"\t"},ze="u",He={type:"literal",value:"u",description:'"u"'},Ye=function(t){return String.fromCharCode(parseInt(t,16))},Ke=function(t){return t},We=/^[^\0-\x1F"\\]/,Je={type:"class",value:"[^\\0-\\x1F\\x22\\x5C]",description:"[^\\0-\\x1F\\x22\\x5C]"},Xe=/^[0-9a-f]/i,Ve={type:"class",value:"[0-9a-f]i",description:"[0-9a-f]i"},Ze=0,Qe=0,tn=[{line:1,column:1,seenCR:!1}],en=0,nn=[],rn=0;if("startRule"in i){if(!(i.startRule in c))throw new Error("Can't start parsing from rule \""+i.startRule+'".');u=c[i.startRule]}function on(t){var n,r,o=tn[t];if(o)return o;for(n=t-1;!tn[n];)n--;for(o={line:(o=tn[n]).line,column:o.column,seenCR:o.seenCR};n<t;)"\n"===(r=e.charAt(n))?(o.seenCR||o.line++,o.column=1,o.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(o.line++,o.column=1,o.seenCR=!0):(o.column++,o.seenCR=!1),n++;return tn[t]=o,o}function sn(t,e){var n=on(t),r=on(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function an(t){Ze<en||(Ze>en&&(en=Ze,nn=[]),nn.push(t))}function cn(e,n,r,o){return null!==n&&function(t){var e=1;for(t.sort(function(t,e){return t.description<e.description?-1:t.description>e.description?1:0});e<t.length;)t[e-1]===t[e]?t.splice(e,1):e++}(n),new t(null!==e?e:function(t,e){var n,r=new Array(t.length);for(n=0;n<t.length;n++)r[n]=t[n].description;return"Expected "+(t.length>1?r.slice(0,-1).join(", ")+" or "+r[t.length-1]:r[0])+" but "+(e?'"'+function(t){function e(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+e(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+e(t)}).replace(/[\u0100-\u0FFF]/g,function(t){return"\\u0"+e(t)}).replace(/[\u1000-\uFFFF]/g,function(t){return"\\u"+e(t)})}(e)+'"':"end of input")+" found."}(n,r),n,r,o)}function un(){var t,e,n;for(t=Ze,e=[],n=pn();n!==a;)e.push(n),n=pn();return e!==a&&(Qe=t,e=p()),t=e}function pn(){var t,n,r,o,i,s,c,u,p;return t=Ze,(n=On())!==a?(e.substr(Ze,7)===d?(r=d,Ze+=7):(r=a,0===rn&&an(l)),r!==a&&(o=mn())!==a?(46===e.charCodeAt(Ze)?(i=h,Ze++):(i=a,0===rn&&an(f)),i!==a&&(s=kn())!==a?(58===e.charCodeAt(Ze)?(c=m,Ze++):(c=a,0===rn&&an(g)),c!==a&&(u=kn())!==a&&On()!==a?((p=dn())===a&&(p=null),p!==a?(Qe=t,t=n=v(o,s,u)):(Ze=t,t=a)):(Ze=t,t=a)):(Ze=t,t=a)):(Ze=t,t=a)):(Ze=t,t=a),t===a&&(t=Ze,(n=On())!==a?(e.substr(Ze,8)===y?(r=y,Ze+=8):(r=a,0===rn&&an(b)),r!==a&&(o=mn())!==a?(46===e.charCodeAt(Ze)?(i=h,Ze++):(i=a,0===rn&&an(f)),i!==a&&(s=kn())!==a?(58===e.charCodeAt(Ze)?(c=m,Ze++):(c=a,0===rn&&an(g)),c!==a&&(u=kn())!==a&&On()!==a?((p=dn())===a&&(p=null),p!==a?(Qe=t,t=n=w(o,s,u)):(Ze=t,t=a)):(Ze=t,t=a)):(Ze=t,t=a)):(Ze=t,t=a)):(Ze=t,t=a),t===a&&(t=Ze,(n=On())!==a?(e.substr(Ze,15)===E?(r=E,Ze+=15):(r=a,0===rn&&an(P)),r!==a&&(o=kn())!==a&&(i=On())!==a?((s=dn())===a&&(s=null),s!==a?(Qe=t,t=n=k(o)):(Ze=t,t=a)):(Ze=t,t=a)):(Ze=t,t=a),t===a&&(t=Ze,(n=On())!==a?(e.substr(Ze,16)===C?(r=C,Ze+=16):(r=a,0===rn&&an(S)),r!==a&&(o=kn())!==a&&(i=On())!==a?((s=dn())===a&&(s=null),s!==a?(Qe=t,t=n=O(o)):(Ze=t,t=a)):(Ze=t,t=a)):(Ze=t,t=a),t===a&&(t=Ze,(n=function(){var t,n,r,o,i,s,c;if(t=Ze,35===e.charCodeAt(Ze)?(n=T,Ze++):(n=a,0===rn&&an(R)),n!==a)if(xn()!==a)if(64===e.charCodeAt(Ze)?(r=ut,Ze++):(r=a,0===rn&&an(pt)),r!==a){if(o=[],dt.test(e.charAt(Ze))?(i=e.charAt(Ze),Ze++):(i=a,0===rn&&an(lt)),i!==a)for(;i!==a;)o.push(i),dt.test(e.charAt(Ze))?(i=e.charAt(Ze),Ze++):(i=a,0===rn&&an(lt));else o=a;if(o!==a)if((i=xn())!==a){if(s=[],ht.test(e.charAt(Ze))?(c=e.charAt(Ze),Ze++):(c=a,0===rn&&an(ft)),c!==a)for(;c!==a;)s.push(c),ht.test(e.charAt(Ze))?(c=e.charAt(Ze),Ze++):(c=a,0===rn&&an(ft));else s=a;s!==a?(Qe=t,n=mt(o,s),t=n):(Ze=t,t=a)}else Ze=t,t=a;else Ze=t,t=a}else Ze=t,t=a;else Ze=t,t=a;else Ze=t,t=a;return t}())!==a&&(r=ln())!==a?(Qe=t,t=n=x(n)):(Ze=t,t=a),t===a&&(t=Ze,(n=hn())!==a?((r=ln())===a&&(r=null),r!==a?t=n=[n,r]:(Ze=t,t=a)):(Ze=t,t=a),t===a&&(t=Ze,(n=On())!==a&&(r=ln())!==a?t=n=[n,r]:(Ze=t,t=a),t===a&&(t=Ze,(n=On())!==a&&(r=function t(){var n,r,o,i;return n=Ze,(r=function(){var t;return(t=fn())===a&&(t=function(){var t,e,n;return t=Ze,(e=mn())!==a?((n=Pn())===a&&(n=null),n!==a?(Qe=t,e=G(e,n),t=e):(Ze=t,t=a)):(Ze=t,t=a),t}())===a&&(t=function(){var t,n,r,o;if(t=Ze,39===e.charCodeAt(Ze)?(n=F,Ze++):(n=a,0===rn&&an($)),n!==a){for(r=[],o=Sn();o!==a;)r.push(o),o=Sn();r!==a?(39===e.charCodeAt(Ze)?(o=F,Ze++):(o=a,0===rn&&an($)),o!==a?(Qe=t,n=q(r),t=n):(Ze=t,t=a)):(Ze=t,t=a)}else Ze=t,t=a;return t===a&&(t=Ze,(n=function(){var t,e,n;return t=Ze,(e=Dn())!==a&&(n=An())!==a&&Dn()!==a?(Qe=t,e=Gt(n),t=e):(Ze=t,t=a),t}())!==a&&(Qe=t,n=z(n)),t=n),t}()),t}())!==a&&On()!==a?(e.substr(Ze,2)===L?(o=L,Ze+=2):(o=a,0===rn&&an(B)),o!==a&&On()!==a&&(i=t())!==a?(Qe=n,r=M(r,i),n=r):(Ze=n,n=a)):(Ze=n,n=a),n===a&&(n=function(){var t;return(t=function(){var t,e,n;return t=Ze,(e=En())===a&&(e=null),e!==a&&(n=mn())!==a?(Qe=t,e=U(e,n),t=e):(Ze=t,t=a),t}())===a&&(t=fn()),t}()),n}())!==a&&(o=On())!==a?((i=dn())===a&&(i=null),i!==a?(Qe=t,t=n=I(r)):(Ze=t,t=a)):(Ze=t,t=a)))))))),t}function dn(){var t,n,r,o,i;return t=Ze,(n=On())!==a?(44===e.charCodeAt(Ze)?(r=D,Ze++):(r=a,0===rn&&an(A)),r===a&&(r=null),r!==a?((o=hn())===a&&(o=null),o!==a?((i=ln())===a&&(i=null),i!==a?t=n=[n,r,o,i]:(Ze=t,t=a)):(Ze=t,t=a)):(Ze=t,t=a)):(Ze=t,t=a),t}function ln(){var t;return N.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=a,0===rn&&an(_)),t}function hn(){var t,n,r,o,i;if(t=Ze,(n=On())!==a)if(35===e.charCodeAt(Ze)?(r=T,Ze++):(r=a,0===rn&&an(R)),r!==a){for(o=[],i=Cn();i!==a;)o.push(i),i=Cn();o!==a?t=n=[n,r,o]:(Ze=t,t=a)}else Ze=t,t=a;else Ze=t,t=a;return t}function fn(){var t,e,n,r;return t=Ze,(e=En())!==a&&(n=mn())!==a&&(r=Pn())!==a?(Qe=t,t=e=j(e,n,r)):(Ze=t,t=a),t===a&&(t=Ze,(e=En())===a&&(e=null),e!==a&&(n=function(){var t;return(t=vn())===a&&(t=yn()),t}())!==a?((r=Pn())===a&&(r=null),r!==a?(Qe=t,t=e=j(e,n,r)):(Ze=t,t=a)):(Ze=t,t=a)),t}function mn(){var t,e;return t=Ze,(e=vn())!==a&&(Qe=t,e=H(e)),(t=e)===a&&(t=Ze,(e=gn())!==a&&(Qe=t,e=H(e)),(t=e)===a&&(t=Ze,(e=yn())!==a&&(Qe=t,e=H(e)),t=e)),t}function gn(){var t,n,r,o,i;if(t=Ze,n=Ze,Y.test(e.charAt(Ze))?(r=e.charAt(Ze),Ze++):(r=a,0===rn&&an(K)),r!==a){for(o=[],W.test(e.charAt(Ze))?(i=e.charAt(Ze),Ze++):(i=a,0===rn&&an(J));i!==a;)o.push(i),W.test(e.charAt(Ze))?(i=e.charAt(Ze),Ze++):(i=a,0===rn&&an(J));o!==a?n=r=[r,o]:(Ze=n,n=a)}else Ze=n,n=a;return n!==a&&(Qe=t,n=X(n)),t=n}function vn(){var t,e,n;return t=Ze,(e=gn())!==a&&(n=bn())!==a?(Qe=t,t=e=V(e,n)):(Ze=t,t=a),t}function yn(){var t,e;return t=Ze,(e=bn())!==a&&(Qe=t,e=Z(e)),t=e}function bn(){var t,n,r,o,i;if(t=Ze,40===e.charCodeAt(Ze)?(n=Q,Ze++):(n=a,0===rn&&an(tt)),n!==a){for(r=[],et.test(e.charAt(Ze))?(o=e.charAt(Ze),Ze++):(o=a,0===rn&&an(nt));o!==a;)r.push(o),et.test(e.charAt(Ze))?(o=e.charAt(Ze),Ze++):(o=a,0===rn&&an(nt));r===a&&(r=null),r!==a?((o=function(){var t,n,r,o;if(t=Ze,58===e.charCodeAt(Ze)?(n=m,Ze++):(n=a,0===rn&&an(g)),n!==a){if(r=[],st.test(e.charAt(Ze))?(o=e.charAt(Ze),Ze++):(o=a,0===rn&&an(at)),o!==a)for(;o!==a;)r.push(o),st.test(e.charAt(Ze))?(o=e.charAt(Ze),Ze++):(o=a,0===rn&&an(at));else r=a;r!==a?(Qe=t,n=ct(r),t=n):(Ze=t,t=a)}else Ze=t,t=a;return t}())===a&&(o=null),o!==a?(41===e.charCodeAt(Ze)?(i=rt,Ze++):(i=a,0===rn&&an(ot)),i!==a?(Qe=t,t=n=it(r,o)):(Ze=t,t=a)):(Ze=t,t=a)):(Ze=t,t=a)}else Ze=t,t=a;return t}function wn(){var t,n,r;return t=Ze,(n=kn())!==a?((r=function(){var t,n,r,o;if(t=Ze,91===e.charCodeAt(Ze)?(n=Et,Ze++):(n=a,0===rn&&an(Pt)),n!==a){if(r=[],kt.test(e.charAt(Ze))?(o=e.charAt(Ze),Ze++):(o=a,0===rn&&an(Ct)),o!==a)for(;o!==a;)r.push(o),kt.test(e.charAt(Ze))?(o=e.charAt(Ze),Ze++):(o=a,0===rn&&an(Ct));else r=a;r!==a?(93===e.charCodeAt(Ze)?(o=St,Ze++):(o=a,0===rn&&an(Ot)),o!==a?(Qe=t,n=xt(r),t=n):(Ze=t,t=a)):(Ze=t,t=a)}else Ze=t,t=a;return t}())===a&&(r=null),r!==a?(Qe=t,t=n=gt(n,r)):(Ze=t,t=a)):(Ze=t,t=a),t}function En(){var t,e;return t=Ze,(e=wn())!==a&&xn()!==a?(Qe=t,t=e=vt(e)):(Ze=t,t=a),t}function Pn(){var t,e;return t=Ze,xn()!==a&&(e=wn())!==a?(Qe=t,t=vt(e)):(Ze=t,t=a),t}function kn(){var t,n,r,o,i;if(t=Ze,n=Ze,Y.test(e.charAt(Ze))?(r=e.charAt(Ze),Ze++):(r=a,0===rn&&an(K)),r!==a){for(o=[],yt.test(e.charAt(Ze))?(i=e.charAt(Ze),Ze++):(i=a,0===rn&&an(bt));i!==a;)o.push(i),yt.test(e.charAt(Ze))?(i=e.charAt(Ze),Ze++):(i=a,0===rn&&an(bt));o!==a?n=r=[r,o]:(Ze=n,n=a)}else Ze=n,n=a;return n!==a&&(Qe=t,n=wt(n)),t=n}function Cn(){var t;return It.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=a,0===rn&&an(Dt)),t}function Sn(){var t,n,r;return t=Ze,At.test(e.charAt(Ze))?(n=e.charAt(Ze),Ze++):(n=a,0===rn&&an(Nt)),n!==a?(_t.test(e.charAt(Ze))?(r=e.charAt(Ze),Ze++):(r=a,0===rn&&an(Tt)),r!==a?(Qe=t,t=n=Rt()):(Ze=t,t=a)):(Ze=t,t=a),t===a&&(Lt.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=a,0===rn&&an(Bt))),t}function On(){var t,n;for(t=[],32===e.charCodeAt(Ze)?(n=Mt,Ze++):(n=a,0===rn&&an(jt));n!==a;)t.push(n),32===e.charCodeAt(Ze)?(n=Mt,Ze++):(n=a,0===rn&&an(jt));return t===a&&(t=null),t}function xn(){var t,n;if(t=[],32===e.charCodeAt(Ze)?(n=Mt,Ze++):(n=a,0===rn&&an(jt)),n!==a)for(;n!==a;)t.push(n),32===e.charCodeAt(Ze)?(n=Mt,Ze++):(n=a,0===rn&&an(jt));else t=a;return t}function In(){var t,n,r,o;return t=Ze,(n=Dn())!==a?(44===e.charCodeAt(Ze)?(r=D,Ze++):(r=a,0===rn&&an(A)),r!==a&&(o=Dn())!==a?t=n=[n,r,o]:(Ze=t,t=a)):(Ze=t,t=a),t}function Dn(){var t,n;for(rn++,t=[],Ht.test(e.charAt(Ze))?(n=e.charAt(Ze),Ze++):(n=a,0===rn&&an(Yt));n!==a;)t.push(n),Ht.test(e.charAt(Ze))?(n=e.charAt(Ze),Ze++):(n=a,0===rn&&an(Yt));return rn--,t===a&&(n=a,0===rn&&an(zt)),t}function An(){var t;return(t=function(){var t,n;return t=Ze,e.substr(Ze,5)===Kt?(n=Kt,Ze+=5):(n=a,0===rn&&an(Wt)),n!==a&&(Qe=t,n=Jt()),t=n}())===a&&(t=function(){var t,n;return t=Ze,e.substr(Ze,4)===Xt?(n=Xt,Ze+=4):(n=a,0===rn&&an(Vt)),n!==a&&(Qe=t,n=Zt()),t=n}())===a&&(t=function(){var t,n;return t=Ze,e.substr(Ze,4)===Qt?(n=Qt,Ze+=4):(n=a,0===rn&&an(te)),n!==a&&(Qe=t,n=ee()),t=n}())===a&&(t=function(){var t,n,r,o,i,s,c,u;if(t=Ze,(n=function(){var t,n,r,o;return t=Ze,(n=Dn())!==a?(123===e.charCodeAt(Ze)?(r=Ut,Ze++):(r=a,0===rn&&an(Ft)),r!==a&&(o=Dn())!==a?t=n=[n,r,o]:(Ze=t,t=a)):(Ze=t,t=a),t}())!==a){if(r=Ze,(o=Nn())!==a){for(i=[],s=Ze,(c=In())!==a&&(u=Nn())!==a?(Qe=s,c=ne(o,u),s=c):(Ze=s,s=a);s!==a;)i.push(s),s=Ze,(c=In())!==a&&(u=Nn())!==a?(Qe=s,c=ne(o,u),s=c):(Ze=s,s=a);i!==a?(Qe=r,o=re(o,i),r=o):(Ze=r,r=a)}else Ze=r,r=a;r===a&&(r=null),r!==a&&(o=function(){var t,n,r,o;return t=Ze,(n=Dn())!==a?(125===e.charCodeAt(Ze)?(r=$t,Ze++):(r=a,0===rn&&an(qt)),r!==a&&(o=Dn())!==a?t=n=[n,r,o]:(Ze=t,t=a)):(Ze=t,t=a),t}())!==a?(Qe=t,n=oe(r),t=n):(Ze=t,t=a)}else Ze=t,t=a;return t}())===a&&(t=function(){var t,n,r,o,i,s,c,u;if(t=Ze,(n=function(){var t,n,r,o;return t=Ze,(n=Dn())!==a?(91===e.charCodeAt(Ze)?(r=Et,Ze++):(r=a,0===rn&&an(Pt)),r!==a&&(o=Dn())!==a?t=n=[n,r,o]:(Ze=t,t=a)):(Ze=t,t=a),t}())!==a){if(r=Ze,(o=An())!==a){for(i=[],s=Ze,(c=In())!==a&&(u=An())!==a?(Qe=s,c=se(o,u),s=c):(Ze=s,s=a);s!==a;)i.push(s),s=Ze,(c=In())!==a&&(u=An())!==a?(Qe=s,c=se(o,u),s=c):(Ze=s,s=a);i!==a?(Qe=r,o=ae(o,i),r=o):(Ze=r,r=a)}else Ze=r,r=a;r===a&&(r=null),r!==a&&(o=function(){var t,n,r,o;return t=Ze,(n=Dn())!==a?(93===e.charCodeAt(Ze)?(r=St,Ze++):(r=a,0===rn&&an(Ot)),r!==a&&(o=Dn())!==a?t=n=[n,r,o]:(Ze=t,t=a)):(Ze=t,t=a),t}())!==a?(Qe=t,n=ce(r),t=n):(Ze=t,t=a)}else Ze=t,t=a;return t}())===a&&(t=function(){var t,n,r,o;return rn++,t=Ze,(n=_n())===a&&(n=null),n!==a&&function(){var t,n,r,o;if((t=function(){var t;return 48===e.charCodeAt(Ze)?(t=be,Ze++):(t=a,0===rn&&an(we)),t}())===a)if(t=Ze,(n=function(){var t;return de.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=a,0===rn&&an(le)),t}())!==a){for(r=[],o=Bn();o!==a;)r.push(o),o=Bn();r!==a?t=n=[n,r]:(Ze=t,t=a)}else Ze=t,t=a;return t}()!==a?((r=function(){var t,n,r,o;if(t=Ze,(n=function(){var t;return 46===e.charCodeAt(Ze)?(t=h,Ze++):(t=a,0===rn&&an(f)),t}())!==a){if(r=[],(o=Bn())!==a)for(;o!==a;)r.push(o),o=Bn();else r=a;r!==a?t=n=[n,r]:(Ze=t,t=a)}else Ze=t,t=a;return t}())===a&&(r=null),r!==a?((o=function(){var t,n,r,o,i;if(t=Ze,(n=function(){var t;return he.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=a,0===rn&&an(fe)),t}())!==a)if((r=_n())===a&&(r=function(){var t;return 43===e.charCodeAt(Ze)?(t=ve,Ze++):(t=a,0===rn&&an(ye)),t}()),r===a&&(r=null),r!==a){if(o=[],(i=Bn())!==a)for(;i!==a;)o.push(i),i=Bn();else o=a;o!==a?t=n=[n,r,o]:(Ze=t,t=a)}else Ze=t,t=a;else Ze=t,t=a;return t}())===a&&(o=null),o!==a?(Qe=t,n=pe(),t=n):(Ze=t,t=a)):(Ze=t,t=a)):(Ze=t,t=a),rn--,t===a&&(n=a,0===rn&&an(ue)),t}())===a&&(t=Tn()),t}function Nn(){var t,n,r;return t=Ze,(n=Tn())!==a&&function(){var t,n,r,o;return t=Ze,(n=Dn())!==a?(58===e.charCodeAt(Ze)?(r=m,Ze++):(r=a,0===rn&&an(g)),r!==a&&(o=Dn())!==a?t=n=[n,r,o]:(Ze=t,t=a)):(Ze=t,t=a),t}()!==a&&(r=An())!==a?(Qe=t,t=n=ie(n,r)):(Ze=t,t=a),t}function _n(){var t;return 45===e.charCodeAt(Ze)?(t=me,Ze++):(t=a,0===rn&&an(ge)),t}function Tn(){var t,e,n;if(rn++,t=Ze,Ln()!==a){for(e=[],n=Rn();n!==a;)e.push(n),n=Rn();e!==a&&(n=Ln())!==a?(Qe=t,t=Pe(e)):(Ze=t,t=a)}else Ze=t,t=a;return rn--,t===a&&0===rn&&an(Ee),t}function Rn(){var t,n,r,o,i,s,c,u,p;return(t=function(){var t;return We.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=a,0===rn&&an(Je)),t}())===a&&(t=Ze,function(){var t;return 92===e.charCodeAt(Ze)?(t=Se,Ze++):(t=a,0===rn&&an(Oe)),t}()!==a?(34===e.charCodeAt(Ze)?(n=ke,Ze++):(n=a,0===rn&&an(Ce)),n===a&&(92===e.charCodeAt(Ze)?(n=Se,Ze++):(n=a,0===rn&&an(Oe)),n===a&&(47===e.charCodeAt(Ze)?(n=xe,Ze++):(n=a,0===rn&&an(Ie)),n===a&&(n=Ze,98===e.charCodeAt(Ze)?(r=De,Ze++):(r=a,0===rn&&an(Ae)),r!==a&&(Qe=n,r=Ne()),(n=r)===a&&(n=Ze,102===e.charCodeAt(Ze)?(r=_e,Ze++):(r=a,0===rn&&an(Te)),r!==a&&(Qe=n,r=Re()),(n=r)===a&&(n=Ze,110===e.charCodeAt(Ze)?(r=Le,Ze++):(r=a,0===rn&&an(Be)),r!==a&&(Qe=n,r=Me()),(n=r)===a&&(n=Ze,114===e.charCodeAt(Ze)?(r=je,Ze++):(r=a,0===rn&&an(Ge)),r!==a&&(Qe=n,r=Ue()),(n=r)===a&&(n=Ze,116===e.charCodeAt(Ze)?(r=Fe,Ze++):(r=a,0===rn&&an($e)),r!==a&&(Qe=n,r=qe()),(n=r)===a&&(n=Ze,117===e.charCodeAt(Ze)?(r=ze,Ze++):(r=a,0===rn&&an(He)),r!==a?(o=Ze,i=Ze,(s=Mn())!==a&&(c=Mn())!==a&&(u=Mn())!==a&&(p=Mn())!==a?i=s=[s,c,u,p]:(Ze=i,i=a),(o=i!==a?e.substring(o,Ze):i)!==a?(Qe=n,n=r=Ye(o)):(Ze=n,n=a)):(Ze=n,n=a))))))))),n!==a?(Qe=t,t=Ke(n)):(Ze=t,t=a)):(Ze=t,t=a)),t}function Ln(){var t;return 34===e.charCodeAt(Ze)?(t=ke,Ze++):(t=a,0===rn&&an(Ce)),t}function Bn(){var t;return kt.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=a,0===rn&&an(Ct)),t}function Mn(){var t;return Xe.test(e.charAt(Ze))?(t=e.charAt(Ze),Ze++):(t=a,0===rn&&an(Ve)),t}var jn="IN",Gn="OUT";delete(s=this).properties,delete s.inports,delete s.outports,delete s.groups,s.edges=[],o={};var Un=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};s.validateContents=function(t,e){t.processes&&Object.keys(t.processes).forEach(function(e){if(!t.processes[e].component)throw new Error('Node "'+e+'" does not have a component defined')}),t.inports&&Object.keys(t.inports).forEach(function(e){var n=t.inports[e];if(!t.processes[n.process])throw new Error('Inport "'+e+'" is connected to an undefined target node "'+n.process+'"')}),t.outports&&Object.keys(t.outports).forEach(function(e){var n=t.outports[e];if(!t.processes[n.process])throw new Error('Outport "'+e+'" is connected to an undefined source node "'+n.process+'"')}),t.connections&&t.connections.forEach(function(e){if(e.tgt&&!t.processes[e.tgt.process]){if(e.data)throw new Error('IIP containing "'+e.data+'" is connected to an undefined target node "'+e.tgt.process+'"');throw new Error('Edge from "'+e.src.process+'" port "'+e.src.port+'" is connected to an undefined target node "'+e.tgt.process+'"')}if(e.src&&!t.processes[e.src.process])throw new Error('Edge to "'+e.tgt.process+'" port "'+e.tgt.port+'" is connected to an undefined source node "'+e.src.process+'"')})},s.serialize=function(t){var e,n,r,o,s,a,c,u,p,d,l,h,f,m,g,v,y,b,w,E,P,k,C;for(u in null==i&&(i={}),a="string"==typeof t?JSON.parse(t):t,p=[],l="",r=function(t){return null!=a.processes[t].metadata&&(t=a.processes[t].metadata.label),t.indexOf("/")>-1&&(t=t.split("/").pop()),t},n=function(t,e){return null!=e.process&&null!=a.processes[e.process].metadata?t=a.processes[e.process].metadata.label:null!=e.process&&(t=e.process),t.indexOf("/")>-1&&(t=t.split("/").pop()),t},a.properties&&(a.properties.environment&&a.properties.environment.type&&(l+="# @runtime "+a.properties.environment.type+"\n"),Object.keys(a.properties).forEach(function(t){if(t.match(/^[a-zA-Z0-9\-_]+$/)){var e=a.properties[t];"string"==typeof e&&e.match(/^[a-zA-Z0-9\-_\s\.]+$/)&&(l+="# @"+t+" "+e+"\n")}})),f=a.inports)h=n(u,s=f[u]),u=a.caseSensitive?u:u.toUpperCase(),s.port=a.caseSensitive?s.port:s.port.toUpperCase(),l+="INPORT="+h+"."+s.port+":"+u+"\n";for(u in m=a.outports)d=m[u],h=n(u,s),u=a.caseSensitive?u:u.toUpperCase(),d.port=a.caseSensitive?d.port:d.port.toUpperCase(),l+="OUTPORT="+h+"."+d.port+":"+u+"\n";for(l+="\n",o=0,c=(g=a.connections).length;o<c;o++)null!=(e=g[o]).data?(k=a.caseSensitive?e.tgt.port:e.tgt.port.toUpperCase(),P=e.tgt.process,C=a.processes[P].component,E=r(P),Un.call(p,C)<0&&(E+="("+C+")",p.push(C)),l+='"'+e.data+'" -> '+k+" "+E+"\n"):(b=a.caseSensitive?e.src.port:e.src.port.toUpperCase(),y=e.src.process,w=a.processes[y].component,v=r(y),Un.call(p,w)<0&&(v+="("+w+")",p.push(w)),k=a.caseSensitive?e.tgt.port:e.tgt.port.toUpperCase(),P=e.tgt.process,C=a.processes[P].component,E=r(P),Un.call(p,C)<0&&(E+="("+C+")",p.push(C)),l+=v+" "+b+" -> "+k+" "+E+"\n");return l},s.addNode=function(t,e){if(o[t]||(o[t]={}),e.comp&&(o[t].component=e.comp),e.meta){for(var n={},r=0;r<e.meta.length;r++){var i=e.meta[r].split("=");1===i.length&&(i=["routes",i[0]]);var s=i[0],a=i[1];"x"!==s&&"y"!==s||(a=parseFloat(a)),n[s]=a}o[t].metadata=n}};var Fn={},$n={};s.addAnonymousNode=function(t,e){if(!$n[e]){var n=t.comp.replace(/[^a-zA-Z0-9]+/,"_");Fn[n]=(Fn[n]||0)+1,$n[e]="_"+n+"_"+Fn[n],this.addNode($n[e],t)}return $n[e]},s.getResult=function(){var t={inports:s.inports||{},outports:s.outports||{},groups:s.groups||[],processes:o||{},connections:s.processEdges()};s.properties&&(t.properties=s.properties),t.caseSensitive=i.caseSensitive||!1;var e=s.validateSchema;if(void 0!==i.validateSchema&&(e=i.validateSchema),e){if(void 0===r)var r=n(34);var a=n(35),c=r.validateMultiple(t,a);if(!c.valid)throw new Error("fbp: Did not validate againt graph schema:\n"+JSON.stringify(c.errors,null,2))}return(void 0===i.validateContents||i.validateContents)&&s.validateContents(t),t};var qn=function(t,e){for(var n=-1,r=t?t.length:0,o=[];++n<r;){var i=t[n];i instanceof Array?Array.prototype.push.apply(o,e?i:qn(i)):o.push(i)}return o};function zn(t){return t[0]+t[1].join("")}function Hn(t,e,n){i.caseSensitive||(n=n.toLowerCase());var r={process:t,port:e?e.port:n};return e&&null!=e.index&&(r.index=e.index),r}function Yn(t,e){return Hn(t,e,jn)}function Kn(t,e){return Hn(t,e,Gn)}if(s.registerAnnotation=function(t,e){if(s.properties||(s.properties={}),"runtime"===t)return s.properties.environment={},void(s.properties.environment.type=e);s.properties[t]=e},s.registerInports=function(t,e,n){s.inports||(s.inports={}),i.caseSensitive||(n=n.toLowerCase(),e=e.toLowerCase()),s.inports[n]={process:t,port:e}},s.registerOutports=function(t,e,n){s.outports||(s.outports={}),i.caseSensitive||(n=n.toLowerCase(),e=e.toLowerCase()),s.outports[n]={process:t,port:e}},s.registerEdges=function(t){Array.isArray(t)&&t.forEach(function(t,e){s.edges.push(t)})},s.processEdges=function(){var t,e;t=qn(s.edges),e=[];for(var n=1;n<t.length;n+=1)("src"in t[n-1]||"data"in t[n-1])&&"tgt"in t[n]&&(t[n-1].tgt=t[n].tgt,e.push(t[n-1]),n++);return e},(r=u())!==a&&Ze===e.length)return r;throw r!==a&&Ze<e.length&&an({type:"end",description:"end of input"}),cn(null,nn,en<e.length?e.charAt(en):null,en<e.length?sn(en,en+1):sn(en,en))}}}()},function(t,e,n){var r,o,i;o=[],void 0===(i="function"==typeof(r=function(){var t,e,n,r;Object.keys||(Object.keys=(t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),r=(n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(o){if("object"!=typeof o&&"function"!=typeof o||null===o)throw new TypeError("Object.keys called on non-object");var i=[];for(var s in o)t.call(o,s)&&i.push(s);if(e)for(var a=0;a<r;a++)t.call(o,n[a])&&i.push(n[a]);return i})),Object.create||(Object.create=function(){function t(){}return function(e){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return t.prototype=e,new t}}()),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(null===this)throw new TypeError;var e=Object(this),n=e.length>>>0;if(0===n)return-1;var r=0;if(arguments.length>1&&((r=Number(arguments[1]))!=r?r=0:0!==r&&r!==1/0&&r!==-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=n)return-1;for(var o=r>=0?r:Math.max(n-Math.abs(r),0);o<n;o++)if(o in e&&e[o]===t)return o;return-1}),Object.isFrozen||(Object.isFrozen=function(t){for(var e="tv4_test_frozen_key";t.hasOwnProperty(e);)e+=Math.random();try{return t[e]=!0,delete t[e],!1}catch(t){return!0}});var o={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},i={"*":!0};function s(t){return encodeURI(t).replace(/%25[0-9][0-9]/g,function(t){return"%"+t.substring(3)})}function a(t){var e="";o[t.charAt(0)]&&(e=t.charAt(0),t=t.substring(1));var n="",r="",a=!0,c=!1,u=!1;"+"===e?a=!1:"."===e?(r=".",n="."):"/"===e?(r="/",n="/"):"#"===e?(r="#",a=!1):";"===e?(r=";",n=";",c=!0,u=!0):"?"===e?(r="?",n="&",c=!0):"&"===e&&(r="&",n="&",c=!0);for(var p=[],d=t.split(","),l=[],h={},f=0;f<d.length;f++){var m=d[f],g=null;if(-1!==m.indexOf(":")){var v=m.split(":");m=v[0],g=parseInt(v[1],10)}for(var y={};i[m.charAt(m.length-1)];)y[m.charAt(m.length-1)]=!0,m=m.substring(0,m.length-1);var b={truncate:g,name:m,suffices:y};l.push(b),h[m]=b,p.push(m)}var w=function(t){for(var e="",o=0,i=0;i<l.length;i++){var p=l[i],d=t(p.name);if(null==d||Array.isArray(d)&&0===d.length||"object"==typeof d&&0===Object.keys(d).length)o++;else if(e+=i===o?r:n||",",Array.isArray(d)){c&&(e+=p.name+"=");for(var h=0;h<d.length;h++)h>0&&(e+=p.suffices["*"]&&n||",",p.suffices["*"]&&c&&(e+=p.name+"=")),e+=a?encodeURIComponent(d[h]).replace(/!/g,"%21"):s(d[h])}else if("object"==typeof d){c&&!p.suffices["*"]&&(e+=p.name+"=");var f=!0;for(var m in d)f||(e+=p.suffices["*"]&&n||","),f=!1,e+=a?encodeURIComponent(m).replace(/!/g,"%21"):s(m),e+=p.suffices["*"]?"=":",",e+=a?encodeURIComponent(d[m]).replace(/!/g,"%21"):s(d[m])}else c&&(e+=p.name,u&&""===d||(e+="=")),null!=p.truncate&&(d=d.substring(0,p.truncate)),e+=a?encodeURIComponent(d).replace(/!/g,"%21"):s(d)}return e};return w.varNames=p,{prefix:r,substitution:w}}function c(t){if(!(this instanceof c))return new c(t);for(var e=t.split("{"),n=[e.shift()],r=[],o=[],i=[];e.length>0;){var s=e.shift(),u=s.split("}")[0],p=s.substring(u.length+1),d=a(u);o.push(d.substitution),r.push(d.prefix),n.push(p),i=i.concat(d.substitution.varNames)}this.fill=function(t){for(var e=n[0],r=0;r<o.length;r++){var i=o[r];e+=i(t),e+=n[r+1]}return e},this.varNames=i,this.template=t}c.prototype={toString:function(){return this.template},fillFromObject:function(t){return this.fill(function(e){return t[e]})}};var u=function(t,e,n,r,o){if(this.missing=[],this.missingMap={},this.formatValidators=t?Object.create(t.formatValidators):{},this.schemas=t?Object.create(t.schemas):{},this.collectMultiple=e,this.errors=[],this.handleError=e?this.collectError:this.returnError,r&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.scannedFrozenValidationErrors=[],this.validatedSchemasKey="tv4_validation_id",this.validationErrorsKey="tv4_validation_errors_id"),o&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorReporter=n||v("en"),"string"==typeof this.errorReporter)throw new Error("debug");if(this.definedKeywords={},t)for(var i in t.definedKeywords)this.definedKeywords[i]=t.definedKeywords[i].slice(0)};function p(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){if(Array.isArray(t)!==Array.isArray(e))return!1;if(Array.isArray(t)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!p(t[n],e[n]))return!1}else{var r;for(r in t)if(void 0===e[r]&&void 0!==t[r])return!1;for(r in e)if(void 0===t[r]&&void 0!==e[r])return!1;for(r in t)if(!p(t[r],e[r]))return!1}return!0}return!1}u.prototype.defineKeyword=function(t,e){this.definedKeywords[t]=this.definedKeywords[t]||[],this.definedKeywords[t].push(e)},u.prototype.createError=function(t,e,n,r,o,i,s){var a=new P(t,e,n,r,o);return a.message=this.errorReporter(a,i,s),a},u.prototype.returnError=function(t){return t},u.prototype.collectError=function(t){return t&&this.errors.push(t),null},u.prototype.prefixErrors=function(t,e,n){for(var r=t;r<this.errors.length;r++)this.errors[r]=this.errors[r].prefixWith(e,n);return this},u.prototype.banUnknownProperties=function(t,e){for(var n in this.unknownPropertyPaths){var r=this.createError(y.UNKNOWN_PROPERTY,{path:n},n,"",null,t,e),o=this.handleError(r);if(o)return o}return null},u.prototype.addFormat=function(t,e){if("object"==typeof t){for(var n in t)this.addFormat(n,t[n]);return this}this.formatValidators[t]=e},u.prototype.resolveRefs=function(t,e){if(void 0!==t.$ref){if((e=e||{})[t.$ref])return this.createError(y.CIRCULAR_REFERENCE,{urls:Object.keys(e).join(", ")},"","",null,void 0,t);e[t.$ref]=!0,t=this.getSchema(t.$ref,e)}return t},u.prototype.getSchema=function(t,e){var n;if(void 0!==this.schemas[t])return n=this.schemas[t],this.resolveRefs(n,e);var r=t,o="";if(-1!==t.indexOf("#")&&(o=t.substring(t.indexOf("#")+1),r=t.substring(0,t.indexOf("#"))),"object"==typeof this.schemas[r]){n=this.schemas[r];var i=decodeURIComponent(o);if(""===i)return this.resolveRefs(n,e);if("/"!==i.charAt(0))return;for(var s=i.split("/").slice(1),a=0;a<s.length;a++){var c=s[a].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===n[c]){n=void 0;break}n=n[c]}if(void 0!==n)return this.resolveRefs(n,e)}void 0===this.missing[r]&&(this.missing.push(r),this.missing[r]=r,this.missingMap[r]=r)},u.prototype.searchSchemas=function(t,e){if(Array.isArray(t))for(var n=0;n<t.length;n++)this.searchSchemas(t[n],e);else if(t&&"object"==typeof t)for(var r in"string"==typeof t.id&&function(t,e){if(e.substring(0,t.length)===t){var n=e.substring(t.length);if(e.length>0&&"/"===e.charAt(t.length-1)||"#"===n.charAt(0)||"?"===n.charAt(0))return!0}return!1}(e,t.id)&&void 0===this.schemas[t.id]&&(this.schemas[t.id]=t),t)if("enum"!==r)if("object"==typeof t[r])this.searchSchemas(t[r],e);else if("$ref"===r){var o=m(t[r]);o&&void 0===this.schemas[o]&&void 0===this.missingMap[o]&&(this.missingMap[o]=o)}},u.prototype.addSchema=function(t,e){if("string"!=typeof t||void 0===e){if("object"!=typeof t||"string"!=typeof t.id)return;t=(e=t).id}t===m(t)+"#"&&(t=m(t)),this.schemas[t]=e,delete this.missingMap[t],g(e,t),this.searchSchemas(e,t)},u.prototype.getSchemaMap=function(){var t={};for(var e in this.schemas)t[e]=this.schemas[e];return t},u.prototype.getSchemaUris=function(t){var e=[];for(var n in this.schemas)t&&!t.test(n)||e.push(n);return e},u.prototype.getMissingUris=function(t){var e=[];for(var n in this.missingMap)t&&!t.test(n)||e.push(n);return e},u.prototype.dropSchemas=function(){this.schemas={},this.reset()},u.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},u.prototype.validateAll=function(t,e,n,r,o){var i;if(!(e=this.resolveRefs(e)))return null;if(e instanceof P)return this.errors.push(e),e;var s,a=this.errors.length,c=null,u=null;if(this.checkRecursive&&t&&"object"==typeof t){if(i=!this.scanned.length,t[this.validatedSchemasKey]){var p=t[this.validatedSchemasKey].indexOf(e);if(-1!==p)return this.errors=this.errors.concat(t[this.validationErrorsKey][p]),null}if(Object.isFrozen(t)&&-1!==(s=this.scannedFrozen.indexOf(t))){var d=this.scannedFrozenSchemas[s].indexOf(e);if(-1!==d)return this.errors=this.errors.concat(this.scannedFrozenValidationErrors[s][d]),null}if(this.scanned.push(t),Object.isFrozen(t))-1===s&&(s=this.scannedFrozen.length,this.scannedFrozen.push(t),this.scannedFrozenSchemas.push([])),c=this.scannedFrozenSchemas[s].length,this.scannedFrozenSchemas[s][c]=e,this.scannedFrozenValidationErrors[s][c]=[];else{if(!t[this.validatedSchemasKey])try{Object.defineProperty(t,this.validatedSchemasKey,{value:[],configurable:!0}),Object.defineProperty(t,this.validationErrorsKey,{value:[],configurable:!0})}catch(e){t[this.validatedSchemasKey]=[],t[this.validationErrorsKey]=[]}u=t[this.validatedSchemasKey].length,t[this.validatedSchemasKey][u]=e,t[this.validationErrorsKey][u]=[]}}var l=this.errors.length,h=this.validateBasic(t,e,o)||this.validateNumeric(t,e,o)||this.validateString(t,e,o)||this.validateArray(t,e,o)||this.validateObject(t,e,o)||this.validateCombinations(t,e,o)||this.validateHypermedia(t,e,o)||this.validateFormat(t,e,o)||this.validateDefinedKeywords(t,e,o)||null;if(i){for(;this.scanned.length;){var f=this.scanned.pop();delete f[this.validatedSchemasKey]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(h||l!==this.errors.length)for(;n&&n.length||r&&r.length;){var m=n&&n.length?""+n.pop():null,g=r&&r.length?""+r.pop():null;h&&(h=h.prefixWith(m,g)),this.prefixErrors(l,m,g)}return null!==c?this.scannedFrozenValidationErrors[s][c]=this.errors.slice(a):null!==u&&(t[this.validationErrorsKey][u]=this.errors.slice(a)),this.handleError(h)},u.prototype.validateFormat=function(t,e){if("string"!=typeof e.format||!this.formatValidators[e.format])return null;var n=this.formatValidators[e.format].call(null,t,e);return"string"==typeof n||"number"==typeof n?this.createError(y.FORMAT_CUSTOM,{message:n},"","/format",null,t,e):n&&"object"==typeof n?this.createError(y.FORMAT_CUSTOM,{message:n.message||"?"},n.dataPath||"",n.schemaPath||"/format",null,t,e):null},u.prototype.validateDefinedKeywords=function(t,e,n){for(var r in this.definedKeywords)if(void 0!==e[r])for(var o=this.definedKeywords[r],i=0;i<o.length;i++){var s=o[i],a=s(t,e[r],e,n);if("string"==typeof a||"number"==typeof a)return this.createError(y.KEYWORD_CUSTOM,{key:r,message:a},"","",null,t,e).prefixWith(null,r);if(a&&"object"==typeof a){var c=a.code;if("string"==typeof c){if(!y[c])throw new Error("Undefined error code (use defineError): "+c);c=y[c]}else"number"!=typeof c&&(c=y.KEYWORD_CUSTOM);var u="object"==typeof a.message?a.message:{key:r,message:a.message||"?"},p=a.schemaPath||"/"+r.replace(/~/g,"~0").replace(/\//g,"~1");return this.createError(c,u,a.dataPath||null,p,null,t,e)}}return null},u.prototype.validateBasic=function(t,e,n){var r;return(r=this.validateType(t,e,n))?r.prefixWith(null,"type"):(r=this.validateEnum(t,e,n))?r.prefixWith(null,"type"):null},u.prototype.validateType=function(t,e){if(void 0===e.type)return null;var n=typeof t;null===t?n="null":Array.isArray(t)&&(n="array");var r=e.type;Array.isArray(r)||(r=[r]);for(var o=0;o<r.length;o++){var i=r[o];if(i===n||"integer"===i&&"number"===n&&t%1==0)return null}return this.createError(y.INVALID_TYPE,{type:n,expected:r.join("/")},"","",null,t,e)},u.prototype.validateEnum=function(t,e){if(void 0===e.enum)return null;for(var n=0;n<e.enum.length;n++){var r=e.enum[n];if(p(t,r))return null}return this.createError(y.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(t):t},"","",null,t,e)},u.prototype.validateNumeric=function(t,e,n){return this.validateMultipleOf(t,e,n)||this.validateMinMax(t,e,n)||this.validateNaN(t,e,n)||null};var d=Math.pow(2,-51),l=1-d;function h(t){var e=String(t).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return e?{href:e[0]||"",protocol:e[1]||"",authority:e[2]||"",host:e[3]||"",hostname:e[4]||"",port:e[5]||"",pathname:e[6]||"",search:e[7]||"",hash:e[8]||""}:null}function f(t,e){return e=h(e||""),t=h(t||""),e&&t?(e.protocol||t.protocol)+(e.protocol||e.authority?e.authority:t.authority)+(n=e.protocol||e.authority||"/"===e.pathname.charAt(0)?e.pathname:e.pathname?(t.authority&&!t.pathname?"/":"")+t.pathname.slice(0,t.pathname.lastIndexOf("/")+1)+e.pathname:t.pathname,r=[],n.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(t){"/.."===t?r.pop():r.push(t)}),r.join("").replace(/^\//,"/"===n.charAt(0)?"/":""))+(e.protocol||e.authority||e.pathname?e.search:e.search||t.search)+e.hash:null;var n,r}function m(t){return t.split("#")[0]}function g(t,e){if(t&&"object"==typeof t)if(void 0===e?e=t.id:"string"==typeof t.id&&(e=f(e,t.id),t.id=e),Array.isArray(t))for(var n=0;n<t.length;n++)g(t[n],e);else for(var r in"string"==typeof t.$ref&&(t.$ref=f(e,t.$ref)),t)"enum"!==r&&g(t[r],e)}function v(t){var e=k[t=t||"en"];return function(t){var n=e[t.code]||E[t.code];if("string"!=typeof n)return"Unknown error code "+t.code+": "+JSON.stringify(t.messageParams);var r=t.params;return n.replace(/\{([^{}]*)\}/g,function(t,e){var n=r[e];return"string"==typeof n||"number"==typeof n?n:t})}}u.prototype.validateMultipleOf=function(t,e){var n=e.multipleOf||e.divisibleBy;if(void 0===n)return null;if("number"==typeof t){var r=t/n%1;if(r>=d&&r<l)return this.createError(y.NUMBER_MULTIPLE_OF,{value:t,multipleOf:n},"","",null,t,e)}return null},u.prototype.validateMinMax=function(t,e){if("number"!=typeof t)return null;if(void 0!==e.minimum){if(t<e.minimum)return this.createError(y.NUMBER_MINIMUM,{value:t,minimum:e.minimum},"","/minimum",null,t,e);if(e.exclusiveMinimum&&t===e.minimum)return this.createError(y.NUMBER_MINIMUM_EXCLUSIVE,{value:t,minimum:e.minimum},"","/exclusiveMinimum",null,t,e)}if(void 0!==e.maximum){if(t>e.maximum)return this.createError(y.NUMBER_MAXIMUM,{value:t,maximum:e.maximum},"","/maximum",null,t,e);if(e.exclusiveMaximum&&t===e.maximum)return this.createError(y.NUMBER_MAXIMUM_EXCLUSIVE,{value:t,maximum:e.maximum},"","/exclusiveMaximum",null,t,e)}return null},u.prototype.validateNaN=function(t,e){return"number"!=typeof t?null:!0===isNaN(t)||t===1/0||t===-1/0?this.createError(y.NUMBER_NOT_A_NUMBER,{value:t},"","/type",null,t,e):null},u.prototype.validateString=function(t,e,n){return this.validateStringLength(t,e,n)||this.validateStringPattern(t,e,n)||null},u.prototype.validateStringLength=function(t,e){return"string"!=typeof t?null:void 0!==e.minLength&&t.length<e.minLength?this.createError(y.STRING_LENGTH_SHORT,{length:t.length,minimum:e.minLength},"","/minLength",null,t,e):void 0!==e.maxLength&&t.length>e.maxLength?this.createError(y.STRING_LENGTH_LONG,{length:t.length,maximum:e.maxLength},"","/maxLength",null,t,e):null},u.prototype.validateStringPattern=function(t,e){if("string"!=typeof t||"string"!=typeof e.pattern&&!(e.pattern instanceof RegExp))return null;var n;if(e.pattern instanceof RegExp)n=e.pattern;else{var r,o="",i=e.pattern.match(/^\/(.+)\/([img]*)$/);i?(r=i[1],o=i[2]):r=e.pattern,n=new RegExp(r,o)}return n.test(t)?null:this.createError(y.STRING_PATTERN,{pattern:e.pattern},"","/pattern",null,t,e)},u.prototype.validateArray=function(t,e,n){return Array.isArray(t)&&(this.validateArrayLength(t,e,n)||this.validateArrayUniqueItems(t,e,n)||this.validateArrayItems(t,e,n))||null},u.prototype.validateArrayLength=function(t,e){var n;return void 0!==e.minItems&&t.length<e.minItems&&(n=this.createError(y.ARRAY_LENGTH_SHORT,{length:t.length,minimum:e.minItems},"","/minItems",null,t,e),this.handleError(n))?n:void 0!==e.maxItems&&t.length>e.maxItems&&(n=this.createError(y.ARRAY_LENGTH_LONG,{length:t.length,maximum:e.maxItems},"","/maxItems",null,t,e),this.handleError(n))?n:null},u.prototype.validateArrayUniqueItems=function(t,e){if(e.uniqueItems)for(var n=0;n<t.length;n++)for(var r=n+1;r<t.length;r++)if(p(t[n],t[r])){var o=this.createError(y.ARRAY_UNIQUE,{match1:n,match2:r},"","/uniqueItems",null,t,e);if(this.handleError(o))return o}return null},u.prototype.validateArrayItems=function(t,e,n){if(void 0===e.items)return null;var r,o;if(Array.isArray(e.items)){for(o=0;o<t.length;o++)if(o<e.items.length){if(r=this.validateAll(t[o],e.items[o],[o],["items",o],n+"/"+o))return r}else if(void 0!==e.additionalItems)if("boolean"==typeof e.additionalItems){if(!e.additionalItems&&(r=this.createError(y.ARRAY_ADDITIONAL_ITEMS,{},"/"+o,"/additionalItems",null,t,e),this.handleError(r)))return r}else if(r=this.validateAll(t[o],e.additionalItems,[o],["additionalItems"],n+"/"+o))return r}else for(o=0;o<t.length;o++)if(r=this.validateAll(t[o],e.items,[o],["items"],n+"/"+o))return r;return null},u.prototype.validateObject=function(t,e,n){return"object"!=typeof t||null===t||Array.isArray(t)?null:this.validateObjectMinMaxProperties(t,e,n)||this.validateObjectRequiredProperties(t,e,n)||this.validateObjectProperties(t,e,n)||this.validateObjectDependencies(t,e,n)||null},u.prototype.validateObjectMinMaxProperties=function(t,e){var n,r=Object.keys(t);return void 0!==e.minProperties&&r.length<e.minProperties&&(n=this.createError(y.OBJECT_PROPERTIES_MINIMUM,{propertyCount:r.length,minimum:e.minProperties},"","/minProperties",null,t,e),this.handleError(n))?n:void 0!==e.maxProperties&&r.length>e.maxProperties&&(n=this.createError(y.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:r.length,maximum:e.maxProperties},"","/maxProperties",null,t,e),this.handleError(n))?n:null},u.prototype.validateObjectRequiredProperties=function(t,e){if(void 0!==e.required)for(var n=0;n<e.required.length;n++){var r=e.required[n];if(void 0===t[r]){var o=this.createError(y.OBJECT_REQUIRED,{key:r},"","/required/"+n,null,t,e);if(this.handleError(o))return o}}return null},u.prototype.validateObjectProperties=function(t,e,n){var r;for(var o in t){var i=n+"/"+o.replace(/~/g,"~0").replace(/\//g,"~1"),s=!1;if(void 0!==e.properties&&void 0!==e.properties[o]&&(s=!0,r=this.validateAll(t[o],e.properties[o],[o],["properties",o],i)))return r;if(void 0!==e.patternProperties)for(var a in e.patternProperties){var c=new RegExp(a);if(c.test(o)&&(s=!0,r=this.validateAll(t[o],e.patternProperties[a],[o],["patternProperties",a],i)))return r}if(s)this.trackUnknownProperties&&(this.knownPropertyPaths[i]=!0,delete this.unknownPropertyPaths[i]);else if(void 0!==e.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[i]=!0,delete this.unknownPropertyPaths[i]),"boolean"==typeof e.additionalProperties){if(!e.additionalProperties&&(r=this.createError(y.OBJECT_ADDITIONAL_PROPERTIES,{key:o},"","/additionalProperties",null,t,e).prefixWith(o,null),this.handleError(r)))return r}else if(r=this.validateAll(t[o],e.additionalProperties,[o],["additionalProperties"],i))return r}else this.trackUnknownProperties&&!this.knownPropertyPaths[i]&&(this.unknownPropertyPaths[i]=!0)}return null},u.prototype.validateObjectDependencies=function(t,e,n){var r;if(void 0!==e.dependencies)for(var o in e.dependencies)if(void 0!==t[o]){var i=e.dependencies[o];if("string"==typeof i){if(void 0===t[i]&&(r=this.createError(y.OBJECT_DEPENDENCY_KEY,{key:o,missing:i},"","",null,t,e).prefixWith(null,o).prefixWith(null,"dependencies"),this.handleError(r)))return r}else if(Array.isArray(i))for(var s=0;s<i.length;s++){var a=i[s];if(void 0===t[a]&&(r=this.createError(y.OBJECT_DEPENDENCY_KEY,{key:o,missing:a},"","/"+s,null,t,e).prefixWith(null,o).prefixWith(null,"dependencies"),this.handleError(r)))return r}else if(r=this.validateAll(t,i,[],["dependencies",o],n))return r}return null},u.prototype.validateCombinations=function(t,e,n){return this.validateAllOf(t,e,n)||this.validateAnyOf(t,e,n)||this.validateOneOf(t,e,n)||this.validateNot(t,e,n)||null},u.prototype.validateAllOf=function(t,e,n){if(void 0===e.allOf)return null;for(var r,o=0;o<e.allOf.length;o++){var i=e.allOf[o];if(r=this.validateAll(t,i,[],["allOf",o],n))return r}return null},u.prototype.validateAnyOf=function(t,e,n){if(void 0===e.anyOf)return null;var r,o,i=[],s=this.errors.length;this.trackUnknownProperties&&(r=this.unknownPropertyPaths,o=this.knownPropertyPaths);for(var a=!0,c=0;c<e.anyOf.length;c++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var u=e.anyOf[c],p=this.errors.length,d=this.validateAll(t,u,[],["anyOf",c],n);if(null===d&&p===this.errors.length){if(this.errors=this.errors.slice(0,s),this.trackUnknownProperties){for(var l in this.knownPropertyPaths)o[l]=!0,delete r[l];for(var h in this.unknownPropertyPaths)o[h]||(r[h]=!0);a=!1;continue}return null}d&&i.push(d.prefixWith(null,""+c).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=r,this.knownPropertyPaths=o),a?(i=i.concat(this.errors.slice(s)),this.errors=this.errors.slice(0,s),this.createError(y.ANY_OF_MISSING,{},"","/anyOf",i,t,e)):void 0},u.prototype.validateOneOf=function(t,e,n){if(void 0===e.oneOf)return null;var r,o,i=null,s=[],a=this.errors.length;this.trackUnknownProperties&&(r=this.unknownPropertyPaths,o=this.knownPropertyPaths);for(var c=0;c<e.oneOf.length;c++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var u=e.oneOf[c],p=this.errors.length,d=this.validateAll(t,u,[],["oneOf",c],n);if(null===d&&p===this.errors.length){if(null!==i)return this.errors=this.errors.slice(0,a),this.createError(y.ONE_OF_MULTIPLE,{index1:i,index2:c},"","/oneOf",null,t,e);if(i=c,this.trackUnknownProperties){for(var l in this.knownPropertyPaths)o[l]=!0,delete r[l];for(var h in this.unknownPropertyPaths)o[h]||(r[h]=!0)}}else d&&s.push(d)}return this.trackUnknownProperties&&(this.unknownPropertyPaths=r,this.knownPropertyPaths=o),null===i?(s=s.concat(this.errors.slice(a)),this.errors=this.errors.slice(0,a),this.createError(y.ONE_OF_MISSING,{},"","/oneOf",s,t,e)):(this.errors=this.errors.slice(0,a),null)},u.prototype.validateNot=function(t,e,n){if(void 0===e.not)return null;var r,o,i=this.errors.length;this.trackUnknownProperties&&(r=this.unknownPropertyPaths,o=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var s=this.validateAll(t,e.not,null,null,n),a=this.errors.slice(i);return this.errors=this.errors.slice(0,i),this.trackUnknownProperties&&(this.unknownPropertyPaths=r,this.knownPropertyPaths=o),null===s&&0===a.length?this.createError(y.NOT_PASSED,{},"","/not",null,t,e):null},u.prototype.validateHypermedia=function(t,e,n){if(!e.links)return null;for(var r,o=0;o<e.links.length;o++){var i=e.links[o];if("describedby"===i.rel){for(var s=new c(i.href),a=!0,u=0;u<s.varNames.length;u++)if(!(s.varNames[u]in t)){a=!1;break}if(a){var p=s.fillFromObject(t),d={$ref:p};if(r=this.validateAll(t,d,[],["links",o],n))return r}}}};var y={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,NUMBER_NOT_A_NUMBER:105,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,KEYWORD_CUSTOM:501,CIRCULAR_REFERENCE:600,UNKNOWN_PROPERTY:1e3},b={};for(var w in y)b[y[w]]=w;var E={INVALID_TYPE:"Invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",NUMBER_NOT_A_NUMBER:"Value {value} is not a valid number",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",KEYWORD_CUSTOM:"Keyword failed: {key} ({message})",CIRCULAR_REFERENCE:"Circular $refs: {urls}",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};function P(t,e,n,r,o){if(Error.call(this),void 0===t)throw new Error("No error code supplied: "+r);this.message="",this.params=e,this.code=t,this.dataPath=n||"",this.schemaPath=r||"",this.subErrors=o||null;var i=new Error(this.message);if(this.stack=i.stack||i.stacktrace,!this.stack)try{throw i}catch(i){this.stack=i.stack||i.stacktrace}}P.prototype=Object.create(Error.prototype),P.prototype.constructor=P,P.prototype.name="ValidationError",P.prototype.prefixWith=function(t,e){if(null!==t&&(t=t.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+t+this.dataPath),null!==e&&(e=e.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+e+this.schemaPath),null!==this.subErrors)for(var n=0;n<this.subErrors.length;n++)this.subErrors[n].prefixWith(t,e);return this};var k={},C=function t(e){var n,r,o=new u,i={setErrorReporter:function(t){return"string"==typeof t?this.language(t):(r=t,!0)},addFormat:function(){o.addFormat.apply(o,arguments)},language:function(t){return t?(k[t]||(t=t.split("-")[0]),!!k[t]&&(n=t,t)):n},addLanguage:function(t,e){var n;for(n in y)e[n]&&!e[y[n]]&&(e[y[n]]=e[n]);var r=t.split("-")[0];if(k[r])for(n in k[t]=Object.create(k[r]),e)void 0===k[r][n]&&(k[r][n]=e[n]),k[t][n]=e[n];else k[t]=e,k[r]=e;return this},freshApi:function(e){var n=t();return e&&n.language(e),n},validate:function(t,e,i,s){var a=v(n),c=r?function(t,e,n){return r(t,e,n)||a(t,e,n)}:a,p=new u(o,!1,c,i,s);"string"==typeof e&&(e={$ref:e}),p.addSchema("",e);var d=p.validateAll(t,e,null,null,"");return!d&&s&&(d=p.banUnknownProperties(t,e)),this.error=d,this.missing=p.missing,this.valid=null===d,this.valid},validateResult:function(){var t={toString:function(){return this.valid?"valid":this.error.message}};return this.validate.apply(t,arguments),t},validateMultiple:function(t,e,i,s){var a=v(n),c=r?function(t,e,n){return r(t,e,n)||a(t,e,n)}:a,p=new u(o,!0,c,i,s);"string"==typeof e&&(e={$ref:e}),p.addSchema("",e),p.validateAll(t,e,null,null,""),s&&p.banUnknownProperties(t,e);var d={toString:function(){return this.valid?"valid":this.error.message}};return d.errors=p.errors,d.missing=p.missing,d.valid=0===d.errors.length,d},addSchema:function(){return o.addSchema.apply(o,arguments)},getSchema:function(){return o.getSchema.apply(o,arguments)},getSchemaMap:function(){return o.getSchemaMap.apply(o,arguments)},getSchemaUris:function(){return o.getSchemaUris.apply(o,arguments)},getMissingUris:function(){return o.getMissingUris.apply(o,arguments)},dropSchemas:function(){o.dropSchemas.apply(o,arguments)},defineKeyword:function(){o.defineKeyword.apply(o,arguments)},defineError:function(t,e,n){if("string"!=typeof t||!/^[A-Z]+(_[A-Z]+)*$/.test(t))throw new Error("Code name must be a string in UPPER_CASE_WITH_UNDERSCORES");if("number"!=typeof e||e%1!=0||e<1e4)throw new Error("Code number must be an integer > 10000");if(void 0!==y[t])throw new Error("Error already defined: "+t+" as "+y[t]);if(void 0!==b[e])throw new Error("Error code already used: "+b[e]+" as "+e);for(var r in y[t]=e,b[e]=t,E[t]=E[e]=n,k){var o=k[r];o[t]&&(o[e]=o[e]||o[t])}},reset:function(){o.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:g,resolveUrl:f,getDocumentUri:m,errorCodes:y};return i.language(e||"en"),i}();return C.addLanguage("en-gb",E),C.tv4=C,C})?r.apply(e,o):r)||(t.exports=i)},function(t){t.exports={$schema:"http://json-schema.org/draft-04/schema",id:"graph.json",title:"FBP graph",description:"A graph of FBP processes and connections between them.\nThis is the primary way of specifying FBP programs.\n",name:"graph",type:"object",additionalProperties:!1,properties:{caseSensitive:{type:"boolean",description:"Whether the graph port identifiers should be treated as case-sensitive"},properties:{type:"object",description:"User-defined properties attached to the graph.",additionalProperties:!0,properties:{name:{type:"string",description:"Name of the graph"},environment:{type:"object",description:"Information about the execution environment for the graph",additionalProperties:!0,required:["type"],properties:{type:{type:"string",description:"Runtime type the graph is for",example:"noflo-nodejs"},content:{type:"string",description:"HTML fixture for browser-based graphs"}}},description:{type:"string",description:"Graph description"},icon:{type:"string",description:"Name of the icon that can be used for depicting the graph"}}},inports:{type:["object","undefined"],description:"Exported inports of the graph",additionalProperties:!0,patternProperties:{"[a-z0-9]+":{type:"object",properties:{process:{type:"string"},port:{type:"string"},metadata:{type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph inport"},y:{type:"integer",description:"Y coordinate of a graph inport"}}}}}}},outports:{type:["object","undefined"],description:"Exported outports of the graph",additionalProperties:!0,patternProperties:{"[a-z0-9]+":{type:"object",properties:{process:{type:"string"},port:{type:"string"},metadata:{type:"object",required:[],additionalProperties:!0,properties:{x:{type:"integer",description:"X coordinate of a graph outport"},y:{type:"integer",description:"Y coordinate of a graph outport"}}}}}}},groups:{type:"array",description:"List of groups of processes",items:{type:"object",additionalProperties:!1,properties:{name:{type:"string"},nodes:{type:"array",items:{type:"string"}},metadata:{type:"object",additionalProperties:!0,required:[],properties:{description:{type:"string"}}}}}},processes:{type:"object",description:"The processes of this graph.\nEach process is an instance of a component.\n",additionalProperties:!1,patternProperties:{"[a-zA-Z0-9_]+":{type:"object",properties:{component:{type:"string"},metadata:{type:"object",additionalProperties:!0,required:[],properties:{x:{type:"integer",description:"X coordinate of a graph node"},y:{type:"integer",description:"Y coordinate of a graph node"}}}}}}},connections:{type:"array",description:"Connections of the graph.\nA connection either connects ports of two processes, or specifices an IIP as initial input packet to a port.\n",items:{type:"object",additionalProperties:!1,properties:{src:{type:"object",additionalProperties:!1,properties:{process:{type:"string"},port:{type:"string"},index:{type:"integer"}}},tgt:{type:"object",additionalProperties:!1,properties:{process:{type:"string"},port:{type:"string"},index:{type:"integer"}}},data:{},metadata:{type:"object",additionalProperties:!0,required:[],properties:{route:{type:"integer",description:"Route identifier of a graph edge"},schema:{type:"string",format:"uri",description:"JSON schema associated with a graph edge"},secure:{type:"boolean",description:"Whether edge data should be treated as secure"}}}}}}}}},function(t,e,n){var r,o,i,s,a,c,u,p=function(t,e){if(!(t instanceof e))throw new Error("Bound instance method accessed before binding")};({EventEmitter:r}=n(2)),c=n(13),u=function(t){var e;switch(e=t.args,t.cmd){case"addNode":return`${e.id}(${e.component})`;case"removeNode":return`DEL ${e.id}(${e.component})`;case"renameNode":return`RENAME ${e.oldId} ${e.newId}`;case"changeNode":return`META ${e.id}`;case"addEdge":return`${e.from.node} ${e.from.port} -> ${e.to.port} ${e.to.node}`;case"removeEdge":return`${e.from.node} ${e.from.port} -X> ${e.to.port} ${e.to.node}`;case"changeEdge":return`META ${e.from.node} ${e.from.port} -> ${e.to.port} ${e.to.node}`;case"addInitial":return`'${e.from.data}' -> ${e.to.port} ${e.to.node}`;case"removeInitial":return`'${e.from.data}' -X> ${e.to.port} ${e.to.node}`;case"startTransaction":return`>>> ${t.rev}: ${e.id}`;case"endTransaction":return`<<< ${t.rev}: ${e.id}`;case"changeProperties":return"PROPERTIES";case"addGroup":return`GROUP ${e.name}`;case"renameGroup":return`RENAME GROUP ${e.oldName} ${e.newName}`;case"removeGroup":return`DEL GROUP ${e.name}`;case"changeGroup":return`META GROUP ${e.name}`;case"addInport":return`INPORT ${e.name}`;case"removeInport":return`DEL INPORT ${e.name}`;case"renameInport":return`RENAME INPORT ${e.oldId} ${e.newId}`;case"changeInport":return`META INPORT ${e.name}`;case"addOutport":return`OUTPORT ${e.name}`;case"removeOutport":return`DEL OUTPORT ${e.name}`;case"renameOutport":return`RENAME OUTPORT ${e.oldId} ${e.newId}`;case"changeOutport":return`META OUTPORT ${e.name}`;default:throw new Error(`Unknown journal entry: ${t.cmd}`)}},a=function(t,e){var n,r,o;for(n in r={},t)o=t[n],r[n]=null;for(n in e)o=e[n],r[n]=o;return r},i=function(){class t extends r{constructor(t){super(),this.graph=t,this.lastRevision=0}putTransaction(t,e){return t>this.lastRevision&&(this.lastRevision=t),this.emit("transaction",t)}fetchTransaction(t,e){}}return t.prototype.lastRevision=0,t}.call(this),s=class extends i{constructor(t){super(t),this.transactions=[]}putTransaction(t,e){return super.putTransaction(t,e),this.transactions[t]=e}fetchTransaction(t){return this.transactions[t]}},o=function(){class t extends r{constructor(t,e,n){var r,o,i,a,c,u,p,d,l,h,f,m,g,v,y,b,w,E,P,k;if(super(),this.startTransaction=this.startTransaction.bind(this),this.endTransaction=this.endTransaction.bind(this),this.graph=t,this.entries=[],this.subscribed=!0,this.store=n||new s(this.graph),0===this.store.transactions.length){for(this.currentRevision=-1,this.startTransaction("initial",e),a=0,p=(v=this.graph.nodes).length;a<p;a++)g=v[a],this.appendCommand("addNode",g);for(u=0,d=(y=this.graph.edges).length;u<d;u++)r=y[u],this.appendCommand("addEdge",r);for(f=0,l=(b=this.graph.initializers).length;f<l;f++)i=b[f],this.appendCommand("addInitial",i);for(c in Object.keys(this.graph.properties).length>0&&this.appendCommand("changeProperties",this.graph.properties,{}),w=this.graph.inports)k=w[c],this.appendCommand("addInport",{name:c,port:k});for(c in E=this.graph.outports)k=E[c],this.appendCommand("addOutport",{name:c,port:k});for(m=0,h=(P=this.graph.groups).length;m<h;m++)o=P[m],this.appendCommand("addGroup",o);this.endTransaction("initial",e)}else this.currentRevision=this.store.lastRevision;this.graph.on("addNode",t=>this.appendCommand("addNode",t)),this.graph.on("removeNode",t=>this.appendCommand("removeNode",t)),this.graph.on("renameNode",(t,e)=>{var n;return n={oldId:t,newId:e},this.appendCommand("renameNode",n)}),this.graph.on("changeNode",(t,e)=>this.appendCommand("changeNode",{id:t.id,new:t.metadata,old:e})),this.graph.on("addEdge",t=>this.appendCommand("addEdge",t)),this.graph.on("removeEdge",t=>this.appendCommand("removeEdge",t)),this.graph.on("changeEdge",(t,e)=>this.appendCommand("changeEdge",{from:t.from,to:t.to,new:t.metadata,old:e})),this.graph.on("addInitial",t=>this.appendCommand("addInitial",t)),this.graph.on("removeInitial",t=>this.appendCommand("removeInitial",t)),this.graph.on("changeProperties",(t,e)=>this.appendCommand("changeProperties",{new:t,old:e})),this.graph.on("addGroup",t=>this.appendCommand("addGroup",t)),this.graph.on("renameGroup",(t,e)=>this.appendCommand("renameGroup",{oldName:t,newName:e})),this.graph.on("removeGroup",t=>this.appendCommand("removeGroup",t)),this.graph.on("changeGroup",(t,e)=>this.appendCommand("changeGroup",{name:t.name,new:t.metadata,old:e})),this.graph.on("addExport",t=>this.appendCommand("addExport",t)),this.graph.on("removeExport",t=>this.appendCommand("removeExport",t)),this.graph.on("addInport",(t,e)=>this.appendCommand("addInport",{name:t,port:e})),this.graph.on("removeInport",(t,e)=>this.appendCommand("removeInport",{name:t,port:e})),this.graph.on("renameInport",(t,e)=>this.appendCommand("renameInport",{oldId:t,newId:e})),this.graph.on("changeInport",(t,e,n)=>this.appendCommand("changeInport",{name:t,new:e.metadata,old:n})),this.graph.on("addOutport",(t,e)=>this.appendCommand("addOutport",{name:t,port:e})),this.graph.on("removeOutport",(t,e)=>this.appendCommand("removeOutport",{name:t,port:e})),this.graph.on("renameOutport",(t,e)=>this.appendCommand("renameOutport",{oldId:t,newId:e})),this.graph.on("changeOutport",(t,e,n)=>this.appendCommand("changeOutport",{name:t,new:e.metadata,old:n})),this.graph.on("startTransaction",(t,e)=>this.startTransaction(t,e)),this.graph.on("endTransaction",(t,e)=>this.endTransaction(t,e))}startTransaction(e,n){if(p(this,t),this.subscribed){if(this.entries.length>0)throw Error("Inconsistent @entries");return this.currentRevision++,this.appendCommand("startTransaction",{id:e,metadata:n},this.currentRevision)}}endTransaction(e,n){if(p(this,t),this.subscribed)return this.appendCommand("endTransaction",{id:e,metadata:n},this.currentRevision),this.store.putTransaction(this.currentRevision,this.entries),this.entries=[]}appendCommand(t,e,n){var r;if(this.subscribed)return r={cmd:t,args:c(e)},null!=n&&(r.rev=n),this.entries.push(r)}executeEntry(t){var e;switch(e=t.args,t.cmd){case"addNode":return this.graph.addNode(e.id,e.component);case"removeNode":return this.graph.removeNode(e.id);case"renameNode":return this.graph.renameNode(e.oldId,e.newId);case"changeNode":return this.graph.setNodeMetadata(e.id,a(e.old,e.new));case"addEdge":return this.graph.addEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"removeEdge":return this.graph.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"changeEdge":return this.graph.setEdgeMetadata(e.from.node,e.from.port,e.to.node,e.to.port,a(e.old,e.new));case"addInitial":return this.graph.addInitial(e.from.data,e.to.node,e.to.port);case"removeInitial":return this.graph.removeInitial(e.to.node,e.to.port);case"startTransaction":case"endTransaction":return null;case"changeProperties":return this.graph.setProperties(e.new);case"addGroup":return this.graph.addGroup(e.name,e.nodes,e.metadata);case"renameGroup":return this.graph.renameGroup(e.oldName,e.newName);case"removeGroup":return this.graph.removeGroup(e.name);case"changeGroup":return this.graph.setGroupMetadata(e.name,a(e.old,e.new));case"addInport":return this.graph.addInport(e.name,e.port.process,e.port.port,e.port.metadata);case"removeInport":return this.graph.removeInport(e.name);case"renameInport":return this.graph.renameInport(e.oldId,e.newId);case"changeInport":return this.graph.setInportMetadata(e.name,a(e.old,e.new));case"addOutport":return this.graph.addOutport(e.name,e.port.process,e.port.port,e.port.metadata(e.name));case"removeOutport":return this.graph.removeOutport;case"renameOutport":return this.graph.renameOutport(e.oldId,e.newId);case"changeOutport":return this.graph.setOutportMetadata(e.name,a(e.old,e.new));default:throw new Error(`Unknown journal entry: ${t.cmd}`)}}executeEntryInversed(t){var e;switch(e=t.args,t.cmd){case"addNode":return this.graph.removeNode(e.id);case"removeNode":return this.graph.addNode(e.id,e.component);case"renameNode":return this.graph.renameNode(e.newId,e.oldId);case"changeNode":return this.graph.setNodeMetadata(e.id,a(e.new,e.old));case"addEdge":return this.graph.removeEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"removeEdge":return this.graph.addEdge(e.from.node,e.from.port,e.to.node,e.to.port);case"changeEdge":return this.graph.setEdgeMetadata(e.from.node,e.from.port,e.to.node,e.to.port,a(e.new,e.old));case"addInitial":return this.graph.removeInitial(e.to.node,e.to.port);case"removeInitial":return this.graph.addInitial(e.from.data,e.to.node,e.to.port);case"startTransaction":case"endTransaction":return null;case"changeProperties":return this.graph.setProperties(e.old);case"addGroup":return this.graph.removeGroup(e.name);case"renameGroup":return this.graph.renameGroup(e.newName,e.oldName);case"removeGroup":return this.graph.addGroup(e.name,e.nodes,e.metadata);case"changeGroup":return this.graph.setGroupMetadata(e.name,a(e.new,e.old));case"addInport":return this.graph.removeInport(e.name);case"removeInport":return this.graph.addInport(e.name,e.port.process,e.port.port,e.port.metadata);case"renameInport":return this.graph.renameInport(e.newId,e.oldId);case"changeInport":return this.graph.setInportMetadata(e.name,a(e.new,e.old));case"addOutport":return this.graph.removeOutport(e.name);case"removeOutport":return this.graph.addOutport(e.name,e.port.process,e.port.port,e.port.metadata);case"renameOutport":return this.graph.renameOutport(e.newId,e.oldId);case"changeOutport":return this.graph.setOutportMetadata(e.name,a(e.new,e.old));default:throw new Error(`Unknown journal entry: ${t.cmd}`)}}moveToRevision(t){var e,n,r,o,i,s,a,c,u,p,d,l,h;if(t!==this.currentRevision){if(this.subscribed=!1,t>this.currentRevision)for(u=o=p=this.currentRevision+1,d=t;p<=d?o<=d:o>=d;u=p<=d?++o:--o)for(i=0,s=(l=this.store.fetchTransaction(u)).length;i<s;i++)n=l[i],this.executeEntry(n);else for(u=a=this.currentRevision,h=t+1;a>=h;u=a+=-1)for(r=c=(e=this.store.fetchTransaction(u)).length-1;c>=0;r=c+=-1)this.executeEntryInversed(e[r]);return this.currentRevision=t,this.subscribed=!0}}undo(){if(this.canUndo())return this.moveToRevision(this.currentRevision-1)}canUndo(){return this.currentRevision>0}redo(){if(this.canRedo())return this.moveToRevision(this.currentRevision+1)}canRedo(){return this.currentRevision<this.store.lastRevision}toPrettyString(t,e){var n,r,o,i,s,a,c,p,d;for(a=[],c=o=p=t|=0,d=e|=this.store.lastRevision;p<=d?o<d:o>d;c=p<=d?++o:--o)for(i=0,s=(n=this.store.fetchTransaction(c)).length;i<s;i++)r=n[i],a.push(u(r));return a.join("\n")}toJSON(t,e){var n,r,o,i,s,a,c,p;for(n=[],a=o=t|=0,c=e|=this.store.lastRevision;o<c;a=o+=1)for(i=0,s=(p=this.store.fetchTransaction(a)).length;i<s;i++)r=p[i],n.push(u(r));return n}save(t,e){var r;return r=JSON.stringify(this.toJSON(),null,4),n(5).writeFile(`${t}.json`,r,"utf-8",function(n,r){if(n)throw n;return e(t)})}}return t.prototype.graph=null,t.prototype.entries=[],t.prototype.subscribed=!0,t}.call(this),e.Journal=o,e.JournalStore=i,e.MemoryJournalStore=s},function(t,e,n){var r=n(38),o={"browser-app/DoSomething":{language:"javascript",source:"const noflo = require('noflo');\n\nexports.getComponent = () => {\n  const c = new noflo.Component();\n  // Define a meaningful icon for component from http://fontawesome.io/icons/\n  c.icon = 'cog';\n  // Provide a description on component usage\n  c.description = 'do X';\n  // Add input ports\n  c.inPorts.add('in', {\n    datatype: 'string',\n  });\n  // Add output ports\n  c.outPorts.add('out', {\n    datatype: 'string',\n  });\n  // What to do when port receives a packet\n  c.process((input, output) => {\n    // Check that input has received data packet\n    if (!input.hasData('in')) {\n      return;\n    }\n    // Read the contents of the data packet\n    const data = input.getData('in');\n    // Send the contents to output port\n    output.send({\n      out: data,\n    });\n    // Finish processing\n    output.done();\n  });\n  return c;\n};\n"},Graph:{language:"javascript",source:"//     NoFlo - Flow-Based Programming for JavaScript\n//     (c) 2013-2017 Flowhub UG\n//     (c) 2011-2012 Henri Bergius, Nemein\n//     NoFlo may be freely distributed under the MIT license\n\n// The Graph component is used to wrap NoFlo Networks into components inside\n// another network.\nvar Graph, noflo;\n\nnoflo = require(\"../lib/NoFlo\");\n\nGraph = class Graph extends noflo.Component {\n  constructor(metadata) {\n    super();\n    this.metadata = metadata;\n    this.network = null;\n    this.ready = true;\n    this.started = false;\n    this.starting = false;\n    this.baseDir = null;\n    this.loader = null;\n    this.load = 0;\n    this.inPorts = new noflo.InPorts({\n      graph: {\n        datatype: 'all',\n        description: 'NoFlo graph definition to be used with the subgraph component',\n        required: true\n      }\n    });\n    this.outPorts = new noflo.OutPorts;\n    this.inPorts.graph.on('ip', (packet) => {\n      if (packet.type !== 'data') {\n        return;\n      }\n      return this.setGraph(packet.data, (err) => {\n        if (err) {\n          // TODO: Port this part to Process API and use output.error method instead\n          return this.error(err);\n        }\n      });\n    });\n  }\n\n  setGraph(graph, callback) {\n    this.ready = false;\n    if (typeof graph === 'object') {\n      if (typeof graph.addNode === 'function') {\n        // Existing Graph object\n        this.createNetwork(graph, callback);\n        return;\n      }\n      // JSON definition of a graph\n      noflo.graph.loadJSON(graph, (err, instance) => {\n        if (err) {\n          return callback(err);\n        }\n        instance.baseDir = this.baseDir;\n        return this.createNetwork(instance, callback);\n      });\n      return;\n    }\n    if (graph.substr(0, 1) !== \"/\" && graph.substr(1, 1) !== \":\" && process && process.cwd) {\n      graph = `${process.cwd()}/${graph}`;\n    }\n    return noflo.graph.loadFile(graph, (err, instance) => {\n      if (err) {\n        return callback(err);\n      }\n      instance.baseDir = this.baseDir;\n      return this.createNetwork(instance, callback);\n    });\n  }\n\n  createNetwork(graph, callback) {\n    this.description = graph.properties.description || '';\n    this.icon = graph.properties.icon || this.icon;\n    if (!graph.name) {\n      graph.name = this.nodeId;\n    }\n    graph.componentLoader = this.loader;\n    return noflo.createNetwork(graph, (err, network1) => {\n      this.network = network1;\n      if (err) {\n        return callback(err);\n      }\n      this.emit('network', this.network);\n      // Subscribe to network lifecycle\n      this.subscribeNetwork(this.network);\n      // Wire the network up\n      return this.network.connect((err) => {\n        var name, node, ref;\n        if (err) {\n          return callback(err);\n        }\n        ref = this.network.processes;\n        for (name in ref) {\n          node = ref[name];\n          // Map exported ports to local component\n          this.findEdgePorts(name, node);\n        }\n        // Finally set ourselves as \"ready\"\n        this.setToReady();\n        return callback();\n      });\n    }, true);\n  }\n\n  subscribeNetwork(network) {\n    var contexts;\n    contexts = [];\n    this.network.on('start', () => {\n      var ctx;\n      ctx = {};\n      contexts.push(ctx);\n      return this.activate(ctx);\n    });\n    return this.network.on('end', () => {\n      var ctx;\n      ctx = contexts.pop();\n      if (!ctx) {\n        return;\n      }\n      return this.deactivate(ctx);\n    });\n  }\n\n  isExportedInport(port, nodeName, portName) {\n    var priv, pub, ref;\n    ref = this.network.graph.inports;\n    // First we check disambiguated exported ports\n    for (pub in ref) {\n      priv = ref[pub];\n      if (!(priv.process === nodeName && priv.port === portName)) {\n        continue;\n      }\n      return pub;\n    }\n    // Component has exported ports and this isn't one of them\n    return false;\n  }\n\n  isExportedOutport(port, nodeName, portName) {\n    var priv, pub, ref;\n    ref = this.network.graph.outports;\n    // First we check disambiguated exported ports\n    for (pub in ref) {\n      priv = ref[pub];\n      if (!(priv.process === nodeName && priv.port === portName)) {\n        continue;\n      }\n      return pub;\n    }\n    // Component has exported ports and this isn't one of them\n    return false;\n  }\n\n  setToReady() {\n    if (typeof process !== 'undefined' && process.execPath && process.execPath.indexOf('node') !== -1) {\n      return process.nextTick(() => {\n        this.ready = true;\n        return this.emit('ready');\n      });\n    } else {\n      return setTimeout(() => {\n        this.ready = true;\n        return this.emit('ready');\n      }, 0);\n    }\n  }\n\n  findEdgePorts(name, process) {\n    var inPorts, outPorts, port, portName, targetPortName;\n    inPorts = process.component.inPorts.ports;\n    outPorts = process.component.outPorts.ports;\n    for (portName in inPorts) {\n      port = inPorts[portName];\n      targetPortName = this.isExportedInport(port, name, portName);\n      if (targetPortName === false) {\n        continue;\n      }\n      this.inPorts.add(targetPortName, port);\n      this.inPorts[targetPortName].on('connect', () => {\n        // Start the network implicitly if we're starting to get data\n        if (this.starting) {\n          return;\n        }\n        if (this.network.isStarted()) {\n          return;\n        }\n        if (this.network.startupDate) {\n          // Network was started, but did finish. Re-start simply\n          this.network.setStarted(true);\n          return;\n        }\n        // Network was never started, start properly\n        return this.setUp(function() {});\n      });\n    }\n    for (portName in outPorts) {\n      port = outPorts[portName];\n      targetPortName = this.isExportedOutport(port, name, portName);\n      if (targetPortName === false) {\n        continue;\n      }\n      this.outPorts.add(targetPortName, port);\n    }\n    return true;\n  }\n\n  isReady() {\n    return this.ready;\n  }\n\n  isSubgraph() {\n    return true;\n  }\n\n  isLegacy() {\n    return false;\n  }\n\n  setUp(callback) {\n    this.starting = true;\n    if (!this.isReady()) {\n      this.once('ready', () => {\n        return this.setUp(callback);\n      });\n      return;\n    }\n    if (!this.network) {\n      return callback(null);\n    }\n    return this.network.start((err) => {\n      if (err) {\n        return callback(err);\n      }\n      this.starting = false;\n      return callback();\n    });\n  }\n\n  tearDown(callback) {\n    this.starting = false;\n    if (!this.network) {\n      return callback(null);\n    }\n    return this.network.stop(function(err) {\n      if (err) {\n        return callback(err);\n      }\n      return callback();\n    });\n  }\n\n};\n\nexports.getComponent = function(metadata) {\n  return new Graph(metadata);\n};\n"},"core/Callback":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'This component calls a given callback function for each\n  IP it receives.  The Callback component is typically used to connect\n  NoFlo with external Node.js code.'\n  c.icon = 'sign-out'\n\n  c.inPorts.add 'in',\n    description: 'Object passed as argument of the callback'\n    datatype: 'all'\n  c.inPorts.add 'callback',\n    description: 'Callback to invoke'\n    datatype: 'function'\n    control: true\n    required: true\n  c.outPorts.add 'error',\n    datatype: 'object'\n\n  c.process (input, output) ->\n    return unless input.hasData 'callback', 'in'\n    [callback, data] = input.getData 'callback', 'in'\n    unless typeof callback is 'function'\n      output.done new Error 'The provided callback must be a function'\n      return\n\n    # Call the callback when receiving data\n    try\n      callback data\n    catch e\n      return output.done e\n    output.done()\n"},"core/Copy":{language:"coffeescript",source:"noflo = require 'noflo'\nowl = require 'owl-deepcopy'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'deep (i.e. recursively) copy an object'\n  c.icon = 'copy'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be copied'\n  c.outPorts.add 'out',\n    datatype: 'all'\n    description: 'Copy of the original packet'\n\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    data = input.getData 'in'\n\n    copy = owl.deepCopy data\n    output.sendDone\n      out: copy\n    return\n"},"core/DisconnectAfterPacket":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Makes each data packet a stream of its own'\n  c.icon = 'pause'\n  c.forwardBrackets = {}\n  c.autoOrdering = false\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be forward with disconnection'\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  brackets = {}\n  c.tearDown = (callback) ->\n    brackets = {}\n  c.process (input, output) ->\n    # Force auto-ordering to be off for this one\n    c.autoOrdering = false\n\n    data = input.get 'in'\n    brackets[input.scope] = [] unless brackets[input.scope]\n    if data.type is 'openBracket'\n      brackets[input.scope].push data.data\n      output.done()\n      return\n    if data.type is 'closeBracket'\n      brackets[input.scope].pop()\n      output.done()\n      return\n\n    return unless data.type is 'data'\n\n    for bracket in brackets[input.scope]\n      output.sendIP 'out', new noflo.IP 'openBracket', bracket\n    output.sendIP 'out', data\n    closes = brackets[input.scope].slice 0\n    closes.reverse()\n    for bracket in closes\n      output.sendIP 'out', new noflo.IP 'closeBracket', bracket\n\n    output.done()\n"},"core/Drop":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'This component drops every packet it receives with no\n  action'\n  c.icon = 'trash-o'\n\n  c.inPorts.add 'in',\n    datatypes: 'all'\n    description: 'Packet to be dropped'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    data.drop()\n    output.done()\n    return\n"},"core/Kick":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'This component generates a single packet and sends it to\n  the output port. Mostly usable for debugging, but can also be useful\n  for starting up networks.'\n  c.icon = 'share'\n\n  c.inPorts.add 'in',\n    datatype: 'bang'\n    description: 'Signal to send the data packet'\n  c.inPorts.add 'data',\n    datatype: 'all'\n    description: 'Packet to be sent'\n    control: true\n    default: null\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    return unless input.hasStream 'in'\n    return if input.attached('data').length and not input.hasData 'data'\n    bang = input.getData 'in'\n    data = input.getData 'data'\n    output.send\n      out: data\n    output.done()\n"},"core/MakeFunction":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Evaluates a function each time data hits the \"in\" port\n  and sends the return value to \"out\". Within the function \"x\" will\n  be the variable from the in port. For example, to make a ^2 function\n  input \"return x*x;\" to the function port.'\n  c.icon = 'code'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be processed'\n  c.inPorts.add 'function',\n    datatype: 'string'\n    description: 'Function to evaluate'\n    control: true\n  c.outPorts.add 'out',\n    datatype: 'all'\n  c.outPorts.add 'function',\n    datatype: 'function'\n  c.outPorts.add 'error',\n    datatype: 'object'\n\n  prepareFunction = (func, callback) ->\n    if typeof func is 'function'\n      callback null, func\n      return\n    try\n      newFunc = Function 'x', func\n    catch e\n      callback e\n      return\n    callback null, newFunc\n\n  c.process (input, output) ->\n    return if input.attached('in').length and not input.hasData 'in'\n    if input.hasData 'function', 'in'\n      # Both function and input data\n      prepareFunction input.getData('function'), (err, func) ->\n        if err\n          output.done e\n          return\n        data = input.getData 'in'\n        try\n          result = func data\n        catch e\n          output.done e\n          return\n        output.sendDone\n          function: func\n          out: result\n        return\n      return\n    return unless input.hasData 'function'\n    prepareFunction input.getData('function'), (err, func) ->\n      if err\n        output.done e\n        return\n      output.sendDone\n        function: func\n      return\n    return\n"},"core/Merge":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'This component receives data on multiple input ports and\n    sends the same data out to the connected output port'\n  c.icon = 'compress'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be forwarded'\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    output.sendDone\n      out: data\n"},"core/Output":{language:"coffeescript",source:"noflo = require 'noflo'\n\nunless noflo.isBrowser()\n  util = require 'util'\nelse\n  util =\n    inspect: (data) -> data\n\nlog = (options, data) ->\n  if options?\n    console.log util.inspect data,\n      options.showHidden, options.depth, options.colors\n  else\n    console.log data\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Sends the data items to console.log'\n  c.icon = 'bug'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be printed through console.log'\n  c.inPorts.add 'options',\n    datatype: 'object'\n    description: 'Options to be passed to console.log'\n    control: true\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    return if input.attached('options').length and not input.hasData 'options'\n\n    options = null\n    if input.has 'options'\n      options = input.getData 'options'\n\n    data = input.getData 'in'\n    log options, data\n    output.sendDone\n      out: data\n"},"core/ReadGlobal":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Returns the value of a global variable.'\n  c.icon = 'usd'\n\n  # inPorts\n  c.inPorts.add 'name',\n    description: 'The name of the global variable.'\n\n  # outPorts\n  c.outPorts.add 'value',\n    description: 'The value of the variable.'\n\n  c.outPorts.add 'error',\n    description: 'Any errors that occured reading the variables value.'\n\n  c.forwardBrackets =\n    name: ['value', 'error']\n\n  c.process (input, output) ->\n    return unless input.hasData 'name'\n    data = input.getData 'name'\n\n    value = unless noflo.isBrowser() then global[data] else window[data]\n\n    if typeof value is 'undefined'\n      err = new Error \"\\\"#{data}\\\" is undefined on the global object.\"\n      output.sendDone err\n      return\n    output.sendDone\n      value: value\n"},"core/Repeat":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Forwards packets and metadata in the same way\n  it receives them'\n  c.icon = 'forward'\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to forward'\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    output.sendDone\n      out: data\n"},"core/RepeatAsync":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = \"Like 'Repeat', except repeat on next tick\"\n  c.icon = 'step-forward'\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to forward'\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    setTimeout ->\n      output.sendDone\n        out: data\n    , 0\n"},"core/RepeatDelayed":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Forward packet after a set delay'\n  c.icon = 'clock-o'\n\n  c.timers = []\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be forwarded with a delay'\n  c.inPorts.add 'delay',\n    datatype: 'number'\n    description: 'How much to delay'\n    default: 500\n    control: true\n\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.tearDown = (callback) ->\n    clearTimeout timer for timer in c.timers\n    c.timers = []\n    callback()\n\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    return if input.attached('delay').length and not input.hasData 'delay'\n\n    delay = 500\n    if input.hasData 'delay'\n      delay = input.getData 'delay'\n    payload = input.get 'in'\n\n    timer = setTimeout ->\n      c.timers.splice c.timers.indexOf(timer), 1\n      output.sendDone\n        out: payload\n    , delay\n    c.timers.push timer\n"},"core/RunInterval":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Send a packet at the given interval'\n  c.icon = 'clock-o'\n  c.inPorts.add 'interval',\n    datatype: 'number'\n    description: 'Interval at which output packets are emitted (ms)'\n    required: true\n    control: true\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start the emission'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop the emission'\n  c.outPorts.add 'out',\n    datatype: 'bang'\n\n  c.timers = {}\n\n  cleanUp = (scope) ->\n    return unless c.timers[scope]\n    clearInterval c.timers[scope].interval\n    c.timers[scope].deactivate()\n    c.timers[scope] = null\n\n  c.tearDown = (callback) ->\n    for scope, context of c.timers\n      cleanUp scope\n    c.timers = {}\n    callback()\n\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      return unless input.hasData 'interval'\n      start = input.get 'start'\n      return unless start.type is 'data'\n      interval = parseInt input.getData 'interval'\n      # Ensure we deactivate previous interval in this scope, if any\n      cleanUp start.scope\n\n      # Set up interval\n      context.interval = setInterval ->\n        bang = new noflo.IP 'data', true\n        bang.scope = start.scope\n        c.outPorts.out.sendIP bang\n      , interval\n\n      # Register scope, we keep it active until stopped\n      c.timers[start.scope] = context\n      return\n\n    if input.hasData 'stop'\n      stop = input.get 'stop'\n      return unless stop.type is 'data'\n      # Deactivate interval in this scope\n      cleanUp stop.scope\n      return\n"},"core/RunTimeout":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Send a packet after the given time in ms'\n  c.icon = 'clock-o'\n\n  c.timer = {}\n\n  c.inPorts.add 'time',\n    datatype: 'number'\n    description: 'Time after which a packet will be sent'\n    required: true\n    control: true\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start the timeout before sending a packet'\n  c.outPorts.add 'out',\n    datatype: 'bang'\n\n  c.forwardBrackets =\n    start: ['out']\n\n  c.stopTimer = (scope) ->\n    return unless c.timer[scope]\n    clearTimeout c.timer[scope].timeout\n    c.timer[scope].deactivate()\n    delete c.timer[scope]\n\n  c.tearDown = (callback) ->\n    for scope, timer of c.timer\n      c.stopTimer scope\n    callback()\n\n  c.process (input, output, context) ->\n    return unless input.hasData 'time', 'start'\n    time = input.getData 'time'\n    bang = input.getData 'start'\n    # Ensure we deactivate previous timeout, if any\n    c.stopTimer input.scope\n    # Set up new timer\n    context.timeout = setTimeout ->\n      c.timer = null\n      output.sendDone\n        out: true\n    , time\n    c.timer[input.scope] = context\n    return\n"},"core/SendNext":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Sends next packet in buffer when receiving a bang'\n  c.icon = 'forward'\n\n  c.inPorts.add 'data',\n    datatype: 'all'\n  c.inPorts.add 'in',\n    datatype: 'bang'\n  c.outPorts.add 'out',\n    datatype: 'all'\n  c.outPorts.add 'empty',\n    datatype: 'bang'\n    required: false\n\n  c.forwardBrackets = {}\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    bang = input.getData 'in'\n\n    unless input.hasData 'data'\n      # No data packets in the buffer, send \"empty\"\n      output.sendDone\n        empty: true\n      return\n\n    sent = false\n    # Loop until we've either drained the buffer completely, or until\n    # we hit the next data packet\n    while input.has 'data'\n      if sent\n        # If we already sent data, we look ahead to see if next packet is data and bail out\n        buf = c.inPorts.data.getBuffer bang.scope\n        break if buf[0].type is 'data'\n\n      packet = input.get 'data'\n      output.send\n        out: packet\n      sent = true if packet.type is 'data'\n    # After the loop we can deactivate\n    output.done()\n"},"core/Split":{language:"coffeescript",source:"noflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.icon = 'expand'\n  c.description = 'This component receives data on a single input port and\n    sends the same data out to all connected output ports'\n\n  c.inPorts.add 'in',\n    datatype: 'all'\n    description: 'Packet to be forwarded'\n\n  c.outPorts.add 'out',\n    datatype: 'all'\n\n  c.process (input, output) ->\n    data = input.get 'in'\n    output.sendDone\n      out: data\n"},"dom/AddClass":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Add a class to an element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'class',\n    datatype: 'string'\n\n  c.process (input, output) ->\n    return unless input.has 'element', 'class'\n    [element, className] = input.getData 'element', 'class'\n    element.classList.add className\n    output.done()\n"},"dom/AppendChild":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Append elements as children of a parent element'\n  c.inPorts.add 'parent',\n    datatype: 'object'\n  c.inPorts.add 'child',\n    datatype: 'object'\n\n  c.process (input, output) ->\n    return unless input.hasData 'parent', 'child'\n    [parent, child] = input.getData 'parent', 'child'\n    parent.appendChild child\n    output.done()\n"},"dom/CreateElement":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Create a new DOM Element'\n  c.inPorts.add 'tagname',\n    datatype: 'string'\n  c.inPorts.add 'container',\n    datatype: 'object'\n  c.outPorts.add 'element',\n    datatype: 'object'\n  c.forwardBrackets =\n    tagname: ['element']\n\n  c.process (input, output) ->\n    return unless input.hasData 'tagname'\n    if c.inPorts.container.isAttached()\n      # If container is attached, we want it too\n      return unless input.hasData 'container'\n\n    tagname = input.getData 'tagname'\n    element = document.createElement tagname\n    if input.hasData 'container'\n      container = input.getData 'container'\n      container.appendChild element\n\n    output.sendDone\n      element: element\n"},"dom/CreateFragment":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c. description = 'Create a new DOM DocumentFragment'\n  c.inPorts.add 'in',\n    datatype: 'bang'\n  c.outPorts.add 'fragment',\n    datatype: 'object'\n\n  c.forwardBrackets =\n    in: ['fragment']\n\n  c.process (input, output) ->\n    return unless input.hasData 'in'\n    input.getData 'in'\n    fragment = document.createDocumentFragment()\n    output.sendDone\n      fragment: fragment\n"},"dom/GetAttribute":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = \"Reads the given attribute from the DOM element on the in\n    port.\"\n\n  # Define in ports.\n  c.inPorts.add 'element',\n    datatype: 'object'\n    description: 'The element from which to read the attribute from.'\n    required: true\n\n  c.inPorts.add 'attribute',\n    datatype: 'string'\n    description: 'The attribute which is read from the DOM element.'\n    required: true\n    control: true\n\n  # Define out ports.\n  c.outPorts.add 'out',\n    datatype: 'string'\n    description: 'Value of the attribute being read.'\n\n  c.forwardBrackets =\n    element: ['out']\n\n  # On data flow.\n  c.process (input, output) ->\n    return unless input.hasData 'element', 'attribute'\n    [element, attribute] = input.getData 'element', 'attribute'\n    value = element.getAttribute attribute\n    output.sendDone\n      out: value\n"},"dom/GetElement":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description ='Get a DOM element matching a query'\n  c.inPorts.add 'in',\n    datatype: 'object'\n    description: 'DOM element to constrain the query to'\n  c.inPorts.add 'selector',\n    datatype: 'string'\n    description: 'CSS selector'\n  c.outPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'error',\n    datatype: 'object'\n  c.forwardBrackets =\n    selector: ['element', 'error']\n  c.process (input, output) ->\n    return unless input.hasData 'selector'\n    return unless input.hasData 'in' if input.attached('in').length > 0\n    if input.hasData 'in'\n      # Element-scoped selector\n      [container, selector] = input.getData 'in', 'selector'\n      unless typeof container.querySelector is 'function'\n        output.done new Error 'Given container doesn\\'t support querySelectors'\n        return\n      el = container.querySelectorAll selector\n      unless el.length\n        output.done new Error \"No element matching '#{selector}' found under container\"\n        return\n      for element in el\n        output.send\n          element: element\n      output.done()\n      return\n    selector = input.getData 'selector'\n    el = document.querySelectorAll selector\n    unless el.length\n      output.done new Error \"No element matching '#{selector}' found under document\"\n      return\n    for element in el\n      output.send\n        element: element\n    output.done()\n"},"dom/HasClass":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Check if an element has a given class'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'class',\n    datatype: 'string'\n  c.outPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'missed',\n    datatype: 'object'\n  c.process (input, output) ->\n    return unless input.hasData 'element', 'class'\n    [element, klass] = input.getData 'element', 'class'\n    if element.classList.contains klass\n      output.sendDone\n        element: element\n      return\n    output.sendDone\n      missed: element\n"},"dom/Listen":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'addEventListener for specified event type'\n  c.icon = 'stethoscope'\n\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'type',\n    datatype: 'string'\n  c.inPorts.add 'preventdefault',\n    datatype: 'boolean'\n    control: true\n    default: false\n  c.outPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'event',\n    datatype: 'object'\n\n  c.elements = {}\n  cleanUp = (scope) ->\n    return unless c.elements[scope]\n    {element, event, listener} = c.elements[scope]\n    element.removeEventListener event, listener\n    c.elements[scope].deactivate()\n    delete c.elements[scope]\n  c.tearDown = (callback) ->\n    for scope, element of c.elements\n      cleanUp scope\n    c.elements = {}\n    callback()\n  c.forwardBrackets = {}\n\n  c.process (input, output, context) ->\n\n    return unless input.hasData 'element', 'type'\n    [element, type] = input.getData 'element', 'type'\n\n    preventDefault = false\n    if input.hasData 'preventdefault'\n      preventDefault = input.getData 'preventdefault'\n\n    scope = null\n    cleanUp scope\n\n    context.element = element\n    context.event = type\n    context.listener = (event) ->\n      event.preventDefault() if preventDefault\n      output.send\n        element: context.element\n        event: event\n    c.elements[context] = context\n    element.addEventListener type, context.listener\n"},"dom/ReadHtml":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Read HTML from an existing element'\n  c.inPorts.add 'container',\n    datatype: 'object'\n  c.outPorts.add 'html',\n    datatype: 'string'\n  c.forwardBrackets =\n    container: ['html']\n  c.process (input, output) ->\n    return unless input.hasData 'container'\n    container = input.getData 'container'\n    output.sendDone\n      html: container.innerHTML\n"},"dom/RemoveClass":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Remove a class from an element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'class',\n    datatype: 'string'\n\n  c.process (input, output) ->\n    return unless input.has 'element', 'class'\n    [element, className] = input.getData 'element', 'class'\n    element.classList.remove className\n    output.done()\n"},"dom/RemoveElement":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Remove an element from DOM'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.process (input, output) ->\n    return unless input.hasData 'element'\n    element = input.getData 'element'\n    return unless element.parentNode\n    element.parentNode.removeChild element\n    output.done()\n"},"dom/RequestAnimationFrame":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nrequestAnimationFrame =\n  window.requestAnimationFrame       ||\n  window.webkitRequestAnimationFrame ||\n  window.mozRequestAnimationFrame    ||\n  window.oRequestAnimationFrame      ||\n  window.msRequestAnimationFrame     ||\n  (callback, element) ->\n    window.setTimeout( ->\n      callback(+new Date())\n    , 1000 / 60)\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Sends bangs that correspond with screen refresh rate.'\n  c.icon = 'film'\n\n  c.inPorts.add 'start',\n    datatype: 'bang'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n  c.outPorts.add 'out',\n    datatype: 'bang'\n\n  c.running = {}\n  cleanUp = (scope) ->\n    return unless c.running[scope]\n    c.running[scope].deactivate()\n    delete c.running[scope]\n  c.tearDown = (callback) ->\n    for scope, running of c.running\n      cleanUp scope\n    c.running = {}\n    callback()\n  c.animate = (scope, output) ->\n    # Stop when context has been stopped\n    return unless c.running[scope]\n    # Send bang\n    output.send true\n    # Request next frame\n    requestAnimationFrame c.animate.bind c, scope, output\n\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      start = input.get 'start'\n      return unless start.type is 'data'\n      # Ensure previous was deactivated\n      cleanUp start.scope\n\n      # Register scope\n      c.running[start.scope] = context\n\n      # Request first frame\n      requestAnimationFrame c.animate.bind c, start.scope, output\n      return\n\n    if input.hasData 'stop'\n      stop = input.get 'stop'\n      return unless stop.type is 'data'\n      # Deactivate this scope\n      cleanUp stop.scope\n      return\n"},"dom/SetAttribute":{language:"coffeescript",source:"'use strict'\n\n# @runtime noflo-browser\n\nnoflo = require 'noflo'\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = \"Set the given attribute on the DOM element to the received\n    value.\"\n    \n  # Define in ports.\n  c.inPorts.add 'element',\n    datatype: 'object'\n    description: 'The element on which to set the attribute.'\n\n  c.inPorts.add 'attribute',\n    datatype: 'string'\n    description: 'The attribute which is set on the DOM element.'\n\n  c.inPorts.add 'value',\n    datatype: 'string'\n    description: 'Value of the attribute being set.'\n  \n  # Define out ports.\n  c.outPorts.add 'element',\n    datatype: 'object'\n    description: 'The element that was updated.'\n\n  c.forwardBrackets =\n    element: ['element']\n    value: ['element']\n\n  c.process (input, output) ->\n    return unless input.hasData 'element', 'attribute', 'value'\n    [element, attribute, value] = input.getData 'element', 'attribute', 'value'\n    if typeof value is 'object'\n      if toString.call(value) is '[object Array]'\n        value = value.join ' '\n      else\n        newVal = []\n        newVal.push val for key, val of value\n        value = newVal.join ' '\n    if attribute is \"value\"\n      element.value = value\n    else\n      element.setAttribute attribute, value\n\n    output.sendDone\n      element: element\n"},"dom/WriteHtml":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Write HTML inside an existing element'\n  c.inPorts.add 'container',\n    datatype: 'object'\n  c.inPorts.add 'html',\n    datatype: 'string'\n  c.outPorts.add 'container',\n    datatype: 'object'\n  c.process (input, output) ->\n    return unless input.hasData 'container', 'html'\n    [container, html] = input.getData 'container', 'html'\n    container.innerHTML = html\n    output.sendDone\n      container: container\n"},"interaction/Focus":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.icon = 'i-cursor'\n  c.description = 'focus element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n    description: 'element to be focused'\n    control: true\n  c.inPorts.add 'trigger',\n    datatype: 'bang'\n    description: 'trigger focus'\n  c.outPorts.add 'out',\n    datatype: 'bang'\n  c.process (input, output) ->\n    return unless input.hasData 'element', 'trigger'\n    element = input.getData 'element'\n    input.getData 'trigger'\n    window.setTimeout ->\n      element.focus()\n      output.sendDone\n        out: true\n    , 0\n"},"interaction/ListenChange":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to changes on an input element'\n  c.icon = 'hourglass'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'value',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener 'change', element.listener, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    data =\n      el: input.getData 'element'\n      listener: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          value: event.target.value\n      ctx: context\n    data.el.addEventListener 'change', data.listener, false\n    c.elements.push data\n    return\n"},"interaction/ListenDrag":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description =  'Listen to drag events on a DOM element'\n  c.icon = 'arrows'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'start',\n    datatype: 'object'\n  c.outPorts.add 'movey',\n    datatype: 'number'\n  c.outPorts.add 'movex',\n    datatype: 'number'\n  c.outPorts.add 'end',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener 'dragstart', element.dragstart, false\n      element.el.removeEventListener 'drag', element.dragmove, false\n      element.el.removeEventListener 'dragend', element.dragend, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    data =\n      el: input.getData 'element'\n      dragstart: (event) ->\n        event.stopPropagation()\n        output.send\n          start: event\n      dragmove: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          movex: event.clientX\n          movey: event.clientY\n      dragend: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          end: event\n      ctx: context\n    data.el.addEventListener 'dragstart', data.dragstart, false\n    data.el.addEventListener 'drag', data.dragmove, false\n    data.el.addEventListener 'dragend', data.dragend, false\n    c.elements.push data\n    return\n"},"interaction/ListenEvent":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.icon = 'rss'\n  c.description = 'Listen to custom events on a DOM element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'event',\n    datatype: 'string'\n  c.outPorts.add 'out',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener element.eventName, element.onEvent, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element', 'event'\n    el = input.getData 'element'\n    eventName = input.getData 'event'\n    data =\n      el: el\n      eventName: eventName\n      onEvent: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        event.eventName = eventName\n        output.send\n          out: event\n      ctx: context\n    data.el.addEventListener eventName, data.onEvent, false\n    c.elements.push data\n    return\n"},"interaction/ListenHash":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen for hash changes in browser\\'s URL bar'\n  c.icon = 'slack'\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start listening for hash changes'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop listening for hash changes'\n  c.outPorts.add 'initial',\n    datatype: 'string'\n  c.outPorts.add 'change',\n    datatype: 'string'\n  c.current = null\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    window.removeEventListener 'hashchange', c.subscriber.callback, false\n    c.subscriber.ctx.deactivate()\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    c.current = null\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      input.getData 'start'\n      # Ensure previous subscription is ended\n      do unsubscribe\n      sendHash = (port) ->\n        oldHash = c.current\n        c.current = window.location.href.split('#')[1] or ''\n        if oldHash\n          output.send\n            change: new noflo.IP 'openBracket', oldHash\n        payload = {}\n        payload[port] = c.current\n        output.send payload\n        if oldHash\n          output.send\n            change: new noflo.IP 'closeBracket', oldHash\n      c.subscriber =\n        callback: (event) ->\n          sendHash 'change'\n        ctx: context\n      # Send initial\n      sendHash 'initial'\n      window.addEventListener 'hashchange', c.subscriber.callback, false\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenKeyboard":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen for key presses on a given DOM element'\n  c.icon = 'keyboard-o'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'stop',\n    datatype: 'object'\n  c.outPorts.add 'keypress',\n    datatype: 'integer'\n  c.elements = []\n  unsubcribe = (element) ->\n    element.el.removeEventListener 'keypress', element.listener, false\n    element.ctx.deactivate()\n  c.tearDown = (callback) ->\n    unsubscribe element for element in c.elements\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'element'\n      data =\n        el: input.getData 'element'\n        listener: (event) ->\n          output.send\n            keypress: event.keyCode\n        ctx: context\n      data.el.addEventListener 'keypress', data.listener, false\n      c.elements.push data\n      return\n    if input.hasData 'stop'\n      element = input.getData 'stop'\n      ctx = null\n      for el in c.elements\n        continue unless el.el is element\n        ctx = el\n      return unless ctx\n      unsubscribe ctx\n      output.done()\n"},"interaction/ListenKeyboardShortcuts":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen for keyboard shortcuts and route them'\n  c.icon = 'keyboard-o'\n  c.inPorts.add 'keys',\n    datatype: 'array'\n  c.inPorts.add 'ignoreinput',\n    datatype: 'boolean'\n    default: true\n    control: true\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n  c.outPorts.add 'shortcut',\n    datatype: 'bang'\n    addressable: true\n  c.outPorts.add 'missed',\n    datatype: 'integer'\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    document.removeEventListener 'keydown', c.subscriber.callback, false\n    c.subscriber.ctx.deactivate()\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'keys'\n      keys = input.getData 'keys'\n\n      # Ensure previous subscription is ended\n      do unsubscribe\n\n      # Older version of this component used string input\n      keys = keys.split ',' if typeof keys is 'string'\n\n      # We allow some common keyboard shortcuts to be passed as strings\n      for key, index in keys\n        switch key\n          when '-' then keys[index] = 189\n          when '=' then keys[index] = 187\n          when '0' then keys[index] = 48\n          when 'a' then keys[index] = 65\n          when 'x' then keys[index] = 88\n          when 'c' then keys[index] = 67\n          when 'v' then keys[index] = 86\n          when 'z' then keys[index] = 90\n          when 'r' then keys[index] = 82\n\n      ignoreInput = if input.hasData('ignoreinput') then input.getData('ignoreinput') else true\n\n      c.subscriber =\n        callback: (event) ->\n          return unless event.ctrlKey or event.metaKey\n          return if event.target.tagName is 'TEXTAREA' and ignoreInput\n          return if event.target.tagName is 'INPUT' and ignoreInput\n          return if String(event.target.contentEditable) is 'true' and ignoreInput\n          route = keys.indexOf event.keyCode\n          if route is -1\n            output.send\n              missed: event.keyCode\n            return\n          event.preventDefault()\n          event.stopPropagation()\n          output.send\n            shortcut: new noflo.IP 'data', event.keyCode,\n              index: route\n        ctx: context\n      document.addEventListener 'keydown', c.subscriber.callback, false\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenMouse":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.icon = 'mouse-pointer'\n  c.description = 'Listen to mouse events on a DOM element'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'click',\n    datatype: 'object'\n  c.outPorts.add 'dblclick',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener 'click', element.click, false\n      element.el.removeEventListener 'dblclick', element.dblclick, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    data =\n      el: input.getData 'element'\n      click: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          click: event\n      dblclick: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        output.send\n          dblclick: event\n      ctx: context\n    data.el.addEventListener 'click', data.click, false\n    data.el.addEventListener 'dblclick', data.dblclick, false\n    c.elements.push data\n    return\n"},"interaction/ListenPointer":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to pointer events on a DOM element'\n  c.icon = 'pencil-square-o'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.inPorts.add 'action',\n    datatype: 'string'\n    default: 'none'\n    control: true\n  events = [\n    'down'\n    'up'\n    'cancel'\n    'move'\n    'over'\n    'out'\n    'enter'\n    'leave'\n  ]\n  for event in events\n    c.outPorts.add event,\n      datatype: 'object'\n      description: \"Sends event on pointer#{event}\"\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      if element.el.removeAttribute\n        element.el.removeAttribute 'touch-action'\n      for event in events\n        element.el.removeEventListener \"pointer#{event}\", element[\"pointer#{event}\"], false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    action = if input.hasData('action') then input.getData('action') else 'none'\n    data =\n      el: input.getData 'element'\n      ctx: context\n    data.el.setAttribute 'touch-action', action\n    events.forEach (event) ->\n      data[\"pointer#{event}\"] = (ev) ->\n        ev.preventDefault()\n        ev.stopPropagation()\n        payload = {}\n        payload[event] = ev.target.value\n        output.send payload\n      data.el.addEventListener \"pointer#{event}\", data[\"pointer#{event}\"], false\n    c.elements.push data\n    return\n"},"interaction/ListenResize":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to window resize events'\n  c.icon = 'desktop'\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start listening for screen resizes'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop listening for screen resizes'\n  c.outPorts.add 'width',\n    datatype: 'number'\n  c.outPorts.add 'height',\n    datatype: 'number'\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    window.removeEventListener 'resize', c.subscriber.callback, false\n    c.subscriber.ctx.deactivate()\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      input.getData 'start'\n      # Ensure previous subscription is ended\n      do unsubscribe\n      c.subscriber =\n        callback: (event) ->\n          output.send\n            width: window.innerWidth\n            height: window.innerHeight\n        ctx: context\n      output.send\n        width: window.innerWidth\n        height: window.innerHeight\n      window.addEventListener 'resize', c.subscriber.callback, false\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenScroll":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to scroll events on the browser window'\n  c.icon = 'arrows-v'\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start listening for hash changes'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop listening for hash changes'\n  c.outPorts.add 'top',\n    datatype: 'number'\n  c.outPorts.add 'bottom',\n    datatype: 'number'\n  c.outPorts.add 'left',\n    datatype: 'number'\n  c.outPorts.add 'right',\n    datatype: 'number'\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    window.removeEventListener 'scroll', c.subscriber.callback, false\n    c.subscriber.ctx.deactivate()\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      input.getData 'start'\n      # Ensure previous subscription is ended\n      do unsubscribe\n      c.subscriber =\n        callback: (event) ->\n          top = window.scrollY\n          left = window.scrollX\n          output.send\n            top: top\n            bottom: top + window.innerHeight\n            left: left\n            right: left.window.innerWidth\n        ctx: context\n      window.addEventListener 'scroll', c.subscriber.callback, false\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/ListenSpeech":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen for user\\'s microphone and recognize phrases'\n  c.icon = 'microphone'\n  c.inPorts.add 'start',\n    datatype: 'bang'\n    description: 'Start listening for hash changes'\n  c.inPorts.add 'stop',\n    datatype: 'bang'\n    description: 'Stop listening for hash changes'\n  c.outPorts.add 'result',\n    datatype: 'string'\n  c.outPorts.add 'error',\n    datatype: 'object'\n  c.subscriber = null\n  unsubscribe = ->\n    return unless c.subscriber\n    do c.subscriber.recognition.stop\n    do c.subscriber.ctx.deactivate\n    c.subscriber = null\n  c.tearDown = (callback) ->\n    do unsubscribe\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    if input.hasData 'start'\n      input.getData 'start'\n      # Ensure previous subscription is ended\n      do unsubscribe\n      unless window.webkitSpeechRecognition\n        output.done new Error 'Speech recognition support not available'\n        return\n      c.subscriber =\n        sent: []\n        callback: (event) ->\n          for result, idx in event.results\n            continue unless result.isFinal\n            if c.subscriber.sent.indexOf(idx) isnt -1\n              continue\n            output.send\n              result: result[0].transcript\n            c.subscriber.sent.push idx\n        error: (err) ->\n          output.send\n            error: err\n        ctx: context\n      c.subscriber.recognition = new window.webkitSpeechRecognition\n      c.subscriber.recognition.continuous = true\n      c.subscriber.recognition.start()\n      c.subscriber.recognition.onresult = c.subscriber.callback\n      c.subscriber.recognition.onerror = c.subscriber.error\n      return\n    if input.hasData 'stop'\n      input.getData 'stop'\n      do unsubscribe\n      output.done()\n      return\n"},"interaction/SetHash":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Set the hash in browser\\'s URL bar'\n  c.icon = 'slack'\n  c.inPorts.add 'hash',\n    datatype: 'string'\n  c.outPorts.add 'out',\n    datatype: 'string'\n  c.process (input, output) ->\n    return unless input.hasData 'hash'\n    hash = input.getData 'hash'\n    window.location.hash = \"##{hash}\"\n    output.sendDone\n      out: hash\n"},"interaction/ListenTouch":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Listen to touch events on a DOM element'\n  c.icon = 'hand-o-up'\n  c.inPorts.add 'element',\n    datatype: 'object'\n  c.outPorts.add 'start',\n    datatype: 'object'\n  c.outPorts.add 'movex',\n    datatype: 'number'\n  c.outPorts.add 'movey',\n    datatype: 'number'\n  c.outPorts.add 'end',\n    datatype: 'object'\n  c.elements = []\n  c.tearDown = (callback) ->\n    for element in c.elements\n      element.el.removeEventListener 'touchstart', element.touchstart, false\n      element.el.removeEventListener 'touchmove', element.touchmove, false\n      element.el.removeEventListener 'touchend', element.touchend, false\n      element.ctx.deactivate()\n    c.elements = []\n    do callback\n  c.forwardBrackets = {}\n  c.process (input, output, context) ->\n    return unless input.hasData 'element'\n    data =\n      el: input.getData 'element'\n      touchstart: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        return unless event.changedTouches\n        return unless event.changedTouches.length\n        for touch, idx in event.changedTouches\n          output.send\n            start: new noflo.IP 'data', event,\n              touch: idx\n      touchmove: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        return unless event.changedTouches\n        return unless event.changedTouches.length\n        for touch, idx in event.changedTouches\n          output.send\n            movex: new noflo.IP 'data', touch.pageX,\n              touch: idx\n            movey: new noflo.IP 'data', touch.pageY,\n              touch: idx\n      touchend: (event) ->\n        event.preventDefault()\n        event.stopPropagation()\n        return unless event.changedTouches\n        return unless event.changedTouches.length\n        for touch, idx in event.changedTouches\n          output.send\n            end: new noflo.IP 'data', event,\n              touch: idx\n      ctx: context\n    data.el.addEventListener 'touchstart', data.touchstart, false\n    data.el.addEventListener 'touchmove', data.touchmove, false\n    data.el.addEventListener 'touchend', data.touchend, false\n    c.elements.push data\n    return\n"},"interaction/ReadCoordinates":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Read the coordinates from a DOM event'\n  c.icon = 'map-marker'\n  c.inPorts.add 'event',\n    datatype: 'object'\n  c.outPorts.add 'screen',\n    datatype: 'object'\n  c.outPorts.add 'client',\n    datatype: 'object'\n  c.outPorts.add 'page',\n    datatype: 'object'\n  c.forwardBrackets =\n    event: ['screen', 'client', 'page']\n  c.process (input, output) ->\n    return unless input.hasData 'event'\n    event = input.getData 'event'\n    output.sendDone\n      screen:\n        x: event.screenX\n        y: event.screenY\n      client:\n        x: event.clientX\n        y: event.clientY\n      page:\n        x: event.pageX\n        y: event.pageY\n"},"interaction/ReadGamepad":{language:"coffeescript",source:"noflo = require 'noflo'\n\n# @runtime noflo-browser\n\nexports.getComponent = ->\n  c = new noflo.Component\n  c.description = 'Read the state of a gamepad'\n  c.icon = 'gamepad'\n  c.inPorts.add 'gamepad',\n    datatype: 'integer'\n  c.outPorts.add 'out',\n    datatype: 'object'\n  c.outPorts.add 'error',\n    datatype: 'object'\n  c.lastTimestamps = {}\n  c.tearDown = (callback) ->\n    c.lastTimestamps = {}\n    do callback\n  c.process (input, output) ->\n    return unless input.hasData 'gamepad'\n    gamepad = input.getData 'gamepad'\n    unless navigator.webkitGetGamepads\n      output.done new Error \"No WebKit Gamepad API available\"\n      return\n    gamepadState = navigator.webkitGetGamepads()[gamepad]\n    unless gamepadState\n      output.done new Error \"Gamepad '#{gamepad}' not available\"\n    if c.lastTimestamps[gamepad] = gamepadState.timestamp\n      # No change\n      output.done()\n      return\n    c.lastTimestamps[gamepad] = gamepadState.timestamp\n    output.sendDone\n      out: gamepadState\n"}};e.setSource=function(t,e,n,i,s,a){r.setSource(o,t,e,n,i,s,a)},e.getSource=function(t,e,n){r.getSource(o,t,e,n)},e.register=function(t,e){t.setLibraryIcon("dom","html5"),t.registerComponent("browser-app","DoSomething",n(39)),t.registerComponent("browser-app","main",n(27)),t.registerComponent(null,"Graph",n(40)),t.registerComponent("core","Callback",n(41)),t.registerComponent("core","Copy",n(42)),t.registerComponent("core","DisconnectAfterPacket",n(44)),t.registerComponent("core","Drop",n(45)),t.registerComponent("core","Kick",n(46)),t.registerComponent("core","MakeFunction",n(47)),t.registerComponent("core","Merge",n(48)),t.registerComponent("core","Output",n(49)),t.registerComponent("core","ReadGlobal",n(52)),t.registerComponent("core","Repeat",n(53)),t.registerComponent("core","RepeatAsync",n(54)),t.registerComponent("core","RepeatDelayed",n(55)),t.registerComponent("core","RunInterval",n(56)),t.registerComponent("core","RunTimeout",n(57)),t.registerComponent("core","SendNext",n(58)),t.registerComponent("core","Split",n(59)),t.registerComponent("dom","AddClass",n(60)),t.registerComponent("dom","AppendChild",n(61)),t.registerComponent("dom","CreateElement",n(62)),t.registerComponent("dom","CreateFragment",n(63)),t.registerComponent("dom","GetAttribute",n(64)),t.registerComponent("dom","GetElement",n(65)),t.registerComponent("dom","HasClass",n(66)),t.registerComponent("dom","Listen",n(67)),t.registerComponent("dom","ReadHtml",n(68)),t.registerComponent("dom","RemoveClass",n(69)),t.registerComponent("dom","RemoveElement",n(70)),t.registerComponent("dom","RequestAnimationFrame",n(71)),t.registerComponent("dom","SetAttribute",n(72)),t.registerComponent("dom","WriteHtml",n(73)),t.registerComponent("interaction","Focus",n(74)),t.registerComponent("interaction","ListenChange",n(75)),t.registerComponent("interaction","ListenDrag",n(76)),t.registerComponent("interaction","ListenEvent",n(77)),t.registerComponent("interaction","ListenHash",n(78)),t.registerComponent("interaction","ListenKeyboard",n(79)),t.registerComponent("interaction","ListenKeyboardShortcuts",n(80)),t.registerComponent("interaction","ListenMouse",n(81)),t.registerComponent("interaction","ListenPointer",n(82)),t.registerComponent("interaction","ListenResize",n(83)),t.registerComponent("interaction","ListenScroll",n(84)),t.registerComponent("interaction","ListenSpeech",n(85)),t.registerComponent("interaction","ListenTouch",n(86)),t.registerComponent("interaction","ReadCoordinates",n(87)),t.registerComponent("interaction","ReadGamepad",n(88)),t.registerComponent("interaction","SetHash",n(89));r.registerCustomLoaders(t,[],e)}},function(module,exports){exports.registerCustomLoaders=function(t,e,n){if(!e.length)return n();var r=e.shift();t.registerLoader(r,function(r){if(r)return n(r);exports.registerCustomLoaders(t,e,n)})},exports.setSource=function(sources,loader,packageId,name,source,language,callback){var implementation,originalSource=source;if("coffeescript"===language){if("undefined"!=typeof window&&!window.CoffeeScript)return callback(new Error("CoffeeScript compiler needed for "+packageId+"/"+name+" not available"));try{source=window.CoffeeScript.compile(source,{bare:!0})}catch(t){return callback(t)}}if(("es6"===language||"es2015"===language)&&"undefined"!=typeof window&&window.babel)try{source=window.babel.transform(source).code}catch(t){return callback(t)}try{var withExports="(function () { var exports = {}; "+source+"; return exports; })();";implementation=eval(withExports)}catch(t){return callback(t)}if("function"!=typeof implementation&&(!implementation.getComponent||"function"!=typeof implementation.getComponent))return callback(new Error("Provided source for "+packageId+"/"+name+" failed to create a runnable component"));var fullName=packageId+"/"+name;sources[fullName]={language:language,source:originalSource},loader.registerComponent(packageId,name,implementation,callback)},exports.getSource=function(t,e,n,r){if(!e.components[n])return r(new Error("Component "+n+" not available"));var o=e.components[n];if(-1!==n.indexOf("/"))var i=n.split("/"),s={name:i[1],library:i[0]};else s={name:n,library:""};return e.isGraph(o)?(s.code=JSON.stringify(o,null,2),s.language="json",r(null,s)):t[n]?(s.code=t[n].source,s.language=t[n].language,r(null,s)):"function"==typeof o?(s.code=o.toString(),s.language="javascript",r(null,s)):"function"==typeof o.getComponent?(s.code=o.getComponent.toString(),s.language="javascript",r(null,s)):r(new Error("Unable to get sources for "+n))}},function(t,e,n){const r=n(0);e.getComponent=(()=>{const t=new r.Component;return t.icon="cog",t.description="do X",t.inPorts.add("in",{datatype:"string"}),t.outPorts.add("out",{datatype:"string"}),t.process((t,e)=>{if(!t.hasData("in"))return;const n=t.getData("in");e.send({out:n}),e.done()}),t})},function(t,e,n){(function(t){var r,o;o=n(0),r=class extends o.Component{constructor(t){super(),this.metadata=t,this.network=null,this.ready=!0,this.started=!1,this.starting=!1,this.baseDir=null,this.loader=null,this.load=0,this.inPorts=new o.InPorts({graph:{datatype:"all",description:"NoFlo graph definition to be used with the subgraph component",required:!0}}),this.outPorts=new o.OutPorts,this.inPorts.graph.on("ip",t=>{if("data"===t.type)return this.setGraph(t.data,t=>{if(t)return this.error(t)})})}setGraph(e,n){return this.ready=!1,"object"==typeof e?"function"==typeof e.addNode?void this.createNetwork(e,n):void o.graph.loadJSON(e,(t,e)=>t?n(t):(e.baseDir=this.baseDir,this.createNetwork(e,n))):("/"!==e.substr(0,1)&&":"!==e.substr(1,1)&&t&&t.cwd&&(e=`${t.cwd()}/${e}`),o.graph.loadFile(e,(t,e)=>t?n(t):(e.baseDir=this.baseDir,this.createNetwork(e,n))))}createNetwork(t,e){return this.description=t.properties.description||"",this.icon=t.properties.icon||this.icon,t.name||(t.name=this.nodeId),t.componentLoader=this.loader,o.createNetwork(t,(t,n)=>(this.network=n,t?e(t):(this.emit("network",this.network),this.subscribeNetwork(this.network),this.network.connect(t=>{var n,r,o;if(t)return e(t);for(n in o=this.network.processes)r=o[n],this.findEdgePorts(n,r);return this.setToReady(),e()}))),!0)}subscribeNetwork(t){var e;return e=[],this.network.on("start",()=>{var t;return t={},e.push(t),this.activate(t)}),this.network.on("end",()=>{var t;if(t=e.pop())return this.deactivate(t)})}isExportedInport(t,e,n){var r,o,i;for(o in i=this.network.graph.inports)if((r=i[o]).process===e&&r.port===n)return o;return!1}isExportedOutport(t,e,n){var r,o,i;for(o in i=this.network.graph.outports)if((r=i[o]).process===e&&r.port===n)return o;return!1}setToReady(){return void 0!==t&&t.execPath&&-1!==t.execPath.indexOf("node")?t.nextTick(()=>(this.ready=!0,this.emit("ready"))):setTimeout(()=>(this.ready=!0,this.emit("ready")),0)}findEdgePorts(t,e){var n,r,o,i,s;for(i in n=e.component.inPorts.ports,r=e.component.outPorts.ports,n)o=n[i],!1!==(s=this.isExportedInport(o,t,i))&&(this.inPorts.add(s,o),this.inPorts[s].on("connect",()=>{if(!this.starting&&!this.network.isStarted()){if(!this.network.startupDate)return this.setUp(function(){});this.network.setStarted(!0)}}));for(i in r)o=r[i],!1!==(s=this.isExportedOutport(o,t,i))&&this.outPorts.add(s,o);return!0}isReady(){return this.ready}isSubgraph(){return!0}isLegacy(){return!1}setUp(t){if(this.starting=!0,this.isReady())return this.network?this.network.start(e=>e?t(e):(this.starting=!1,t())):t(null);this.once("ready",()=>this.setUp(t))}tearDown(t){return this.starting=!1,this.network?this.network.stop(function(e){return e?t(e):t()}):t(null)}},e.getComponent=function(t){return new r(t)}}).call(this,n(1))},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o;o=n(0),e.getComponent=function(){var t;return(t=new o.Component).description="This component calls a given callback function for each IP it receives.  The Callback component is typically used to connect NoFlo with external Node.js code.",t.icon="sign-out",t.inPorts.add("in",{description:"Object passed as argument of the callback",datatype:"all"}),t.inPorts.add("callback",{description:"Callback to invoke",datatype:"function",control:!0,required:!0}),t.outPorts.add("error",{datatype:"object"}),t.process(function(t,e){var n,o,i;if(t.hasData("callback","in")){var s=r(t.getData("callback","in"),2);if(n=s[0],o=s[1],"function"==typeof n){try{n(o)}catch(t){return i=t,e.done(i)}return e.done()}e.done(new Error("The provided callback must be a function"))}})}},function(t,e,n){"use strict";var r,o;r=n(0),o=n(43),e.getComponent=function(){var t;return(t=new r.Component).description="deep (i.e. recursively) copy an object",t.icon="copy",t.inPorts.add("in",{datatype:"all",description:"Packet to be copied"}),t.outPorts.add("out",{datatype:"all",description:"Copy of the original packet"}),t.process(function(t,e){var n,r;t.hasData("in")&&(r=t.getData("in"),n=o.deepCopy(r),e.sendDone({out:n}))})}},function(t,e,n){function r(){}function o(t){return"object"==typeof t?(r.prototype=t,new r):t}var i=[];function s(t){for(var e in t)this[e]=t[e]}function a(){this.copiedObjects=[];var t=this;this.recursiveDeepCopy=function(e){return t.deepCopy(e)},this.depth=0}function c(t,e){var n=new a;return e&&(n.maxDepth=e),n.deepCopy(t)}s.prototype={constructor:s,canCopy:function(t){return!1},create:function(t){},populate:function(t,e,n){}},a.prototype={constructor:a,maxDepth:256,cacheResult:function(t,e){this.copiedObjects.push([t,e])},getCachedResult:function(t){for(var e=this.copiedObjects,n=e.length,r=0;r<n;r++)if(e[r][0]===t)return e[r][1]},deepCopy:function(t){if(null===t)return null;if("object"!=typeof t)return t;var e=this.getCachedResult(t);if(e)return e;for(var n=0;n<i.length;n++){var r=i[n];if(r.canCopy(t))return this.applyDeepCopier(r,t)}throw new Error("no DeepCopier is able to copy "+t)},applyDeepCopier:function(t,e){var n=t.create(e);if(this.cacheResult(e,n),this.depth++,this.depth>this.maxDepth)throw new Error("Exceeded max recursion depth in deep copy.");return t.populate(this.recursiveDeepCopy,e,n),this.depth--,n}},c.DeepCopier=s,c.deepCopiers=i,c.register=function(t){t instanceof s||(t=new s(t)),i.unshift(t)},c.register({canCopy:function(t){return!0},create:function(t){return t.hasOwnProperty&&t instanceof t.constructor?o(t.constructor.prototype):{}},populate:function(t,e,n){for(var r in e)e.hasOwnProperty&&e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}}),c.register({canCopy:function(t){return t instanceof Array},create:function(t){return new t.constructor},populate:function(t,e,n){for(var r=0;r<e.length;r++)n.push(t(e[r]));return n}}),c.register({canCopy:function(t){return t instanceof Date},create:function(t){return new Date(t)}});var u=n(2).EventEmitter;c.register({canCopy:function(t){return t instanceof u},create:function(t){return t.hasOwnProperty&&t instanceof t.constructor?o(t.constructor.prototype):{}},populate:function(t,e,n){for(var r in e)e.hasOwnProperty&&!e.hasOwnProperty(r)||(n[r]=t(e[r]));return n}}),c.register({canCopy:function(t){return!1},create:function(t){return t===document?document:t.cloneNode(!1)},populate:function(t,e,n){if(e===document)return document;if(e.childNodes&&e.childNodes.length)for(var r=0;r<e.childNodes.length;r++){var o=t(e.childNodes[r]);n.appendChild(o)}}}),e.DeepCopyAlgorithm=a,e.copy=function(t){if("object"!=typeof t)return t;var e=t.valueOf();if(t!=e)return new t.constructor(e);if(t instanceof t.constructor&&t.constructor!==Object){var n=o(t.constructor.prototype);for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r])}else for(var r in n={},t)n[r]=t[r];return n},e.clone=o,e.deepCopy=c},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e;return(e=new r.Component).description="Makes each data packet a stream of its own",e.icon="pause",e.forwardBrackets={},e.autoOrdering=!1,e.inPorts.add("in",{datatype:"all",description:"Packet to be forward with disconnection"}),e.outPorts.add("out",{datatype:"all"}),t={},e.tearDown=function(e){return t={}},e.process(function(n,o){var i,s,a,c,u,p,d,l;if(e.autoOrdering=!1,a=n.get("in"),t[n.scope]||(t[n.scope]=[]),"openBracket"===a.type)return t[n.scope].push(a.data),void o.done();if("closeBracket"===a.type)return t[n.scope].pop(),void o.done();if("data"===a.type){for(c=0,p=(l=t[n.scope]).length;c<p;c++)i=l[c],o.sendIP("out",new r.IP("openBracket",i));for(o.sendIP("out",a),(s=t[n.scope].slice(0)).reverse(),u=0,d=s.length;u<d;u++)i=s[u],o.sendIP("out",new r.IP("closeBracket",i));return o.done()}})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="This component drops every packet it receives with no action",t.icon="trash-o",t.inPorts.add("in",{datatypes:"all",description:"Packet to be dropped"}),t.process(function(t,e){t.get("in").drop(),e.done()})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="This component generates a single packet and sends it to the output port. Mostly usable for debugging, but can also be useful for starting up networks.",t.icon="share",t.inPorts.add("in",{datatype:"bang",description:"Signal to send the data packet"}),t.inPorts.add("data",{datatype:"all",description:"Packet to be sent",control:!0,default:null}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;if(t.hasStream("in")&&(!t.attached("data").length||t.hasData("data")))return t.getData("in"),n=t.getData("data"),e.send({out:n}),e.done()})}},function(t,n,r){"use strict";var o;o=r(0),n.getComponent=function(){var t,n;return(t=new o.Component).description='Evaluates a function each time data hits the "in" port and sends the return value to "out". Within the function "x" will be the variable from the in port. For example, to make a ^2 function input "return x*x;" to the function port.',t.icon="code",t.inPorts.add("in",{datatype:"all",description:"Packet to be processed"}),t.inPorts.add("function",{datatype:"string",description:"Function to evaluate",control:!0}),t.outPorts.add("out",{datatype:"all"}),t.outPorts.add("function",{datatype:"function"}),t.outPorts.add("error",{datatype:"object"}),n=function(t,e){var n;if("function"!=typeof t){try{n=Function("x",t)}catch(t){return void e(t)}return e(null,n)}e(null,t)},t.process(function(t,r){t.attached("in").length&&!t.hasData("in")||(t.hasData("function","in")?n(t.getData("function"),function(e,n){var o,i,s;if(e)r.done(i);else{o=t.getData("in");try{s=n(o)}catch(t){return i=t,void r.done(i)}r.sendDone({function:n,out:s})}}):t.hasData("function")&&n(t.getData("function"),function(t,n){t?r.done(e):r.sendDone({function:n})}))})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="This component receives data on multiple input ports and sends the same data out to the connected output port",t.icon="compress",t.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded"}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;return n=t.get("in"),e.sendDone({out:n})})}},function(t,e,n){"use strict";var r,o,i;o=n(0),i=o.isBrowser()?{inspect:function(t){return t}}:n(16),r=function(t,e){return null!=t?console.log(i.inspect(e,t.showHidden,t.depth,t.colors)):console.log(e)},e.getComponent=function(){var t;return(t=new o.Component).description="Sends the data items to console.log",t.icon="bug",t.inPorts.add("in",{datatype:"all",description:"Packet to be printed through console.log"}),t.inPorts.add("options",{datatype:"object",description:"Options to be passed to console.log",control:!0}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n,o;if(t.hasData("in")&&(!t.attached("options").length||t.hasData("options")))return o=null,t.has("options")&&(o=t.getData("options")),n=t.getData("in"),r(o,n),e.sendDone({out:n})})}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";(function(t){var r;r=n(0),e.getComponent=function(){var e;return(e=new r.Component).description="Returns the value of a global variable.",e.icon="usd",e.inPorts.add("name",{description:"The name of the global variable."}),e.outPorts.add("value",{description:"The value of the variable."}),e.outPorts.add("error",{description:"Any errors that occured reading the variables value."}),e.forwardBrackets={name:["value","error"]},e.process(function(e,n){var o,i,s;if(e.hasData("name"))return o=e.getData("name"),void 0===(s=r.isBrowser()?window[o]:t[o])?(i=new Error('"'.concat(o,'" is undefined on the global object.')),void n.sendDone(i)):n.sendDone({value:s})})}}).call(this,n(7))},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Forwards packets and metadata in the same way it receives them",t.icon="forward",t.inPorts.add("in",{datatype:"all",description:"Packet to forward"}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;return n=t.get("in"),e.sendDone({out:n})})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Like 'Repeat', except repeat on next tick",t.icon="step-forward",t.inPorts.add("in",{datatype:"all",description:"Packet to forward"}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;return n=t.get("in"),setTimeout(function(){return e.sendDone({out:n})},0)})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Forward packet after a set delay",t.icon="clock-o",t.timers=[],t.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded with a delay"}),t.inPorts.add("delay",{datatype:"number",description:"How much to delay",default:500,control:!0}),t.outPorts.add("out",{datatype:"all"}),t.tearDown=function(e){var n,r,o,i;for(n=0,r=(o=t.timers).length;n<r;n++)i=o[n],clearTimeout(i);return t.timers=[],e()},t.process(function(e,n){var r,o,i;if(e.hasData("in")&&(!e.attached("delay").length||e.hasData("delay")))return r=500,e.hasData("delay")&&(r=e.getData("delay")),o=e.get("in"),i=setTimeout(function(){return t.timers.splice(t.timers.indexOf(i),1),n.sendDone({out:o})},r),t.timers.push(i)})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e;return(t=new r.Component).description="Send a packet at the given interval",t.icon="clock-o",t.inPorts.add("interval",{datatype:"number",description:"Interval at which output packets are emitted (ms)",required:!0,control:!0}),t.inPorts.add("start",{datatype:"bang",description:"Start the emission"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop the emission"}),t.outPorts.add("out",{datatype:"bang"}),t.timers={},e=function(e){if(t.timers[e])return clearInterval(t.timers[e].interval),t.timers[e].deactivate(),t.timers[e]=null},t.tearDown=function(n){var r,o;for(o in r=t.timers)r[o],e(o);return t.timers={},n()},t.forwardBrackets={},t.process(function(n,o,i){var s,a,c;if(n.hasData("start")){if(!n.hasData("interval"))return;if("data"!==(a=n.get("start")).type)return;return s=parseInt(n.getData("interval")),e(a.scope),i.interval=setInterval(function(){var e;return(e=new r.IP("data",!0)).scope=a.scope,t.outPorts.out.sendIP(e)},s),void(t.timers[a.scope]=i)}if(n.hasData("stop")){if("data"!==(c=n.get("stop")).type)return;e(c.scope)}})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Send a packet after the given time in ms",t.icon="clock-o",t.timer={},t.inPorts.add("time",{datatype:"number",description:"Time after which a packet will be sent",required:!0,control:!0}),t.inPorts.add("start",{datatype:"bang",description:"Start the timeout before sending a packet"}),t.outPorts.add("out",{datatype:"bang"}),t.forwardBrackets={start:["out"]},t.stopTimer=function(e){if(t.timer[e])return clearTimeout(t.timer[e].timeout),t.timer[e].deactivate(),delete t.timer[e]},t.tearDown=function(e){var n,r;for(r in n=t.timer)n[r],t.stopTimer(r);return e()},t.process(function(e,n,r){var o;e.hasData("time","start")&&(o=e.getData("time"),e.getData("start"),t.stopTimer(e.scope),r.timeout=setTimeout(function(){return t.timer=null,n.sendDone({out:!0})},o),t.timer[e.scope]=r)})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Sends next packet in buffer when receiving a bang",t.icon="forward",t.inPorts.add("data",{datatype:"all"}),t.inPorts.add("in",{datatype:"bang"}),t.outPorts.add("out",{datatype:"all"}),t.outPorts.add("empty",{datatype:"bang",required:!1}),t.forwardBrackets={},t.process(function(e,n){var r,o,i;if(e.hasData("in")){if(r=e.getData("in"),e.hasData("data")){for(i=!1;e.has("data")&&(!i||"data"!==t.inPorts.data.getBuffer(r.scope)[0].type);)o=e.get("data"),n.send({out:o}),"data"===o.type&&(i=!0);return n.done()}n.sendDone({empty:!0})}})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).icon="expand",t.description="This component receives data on a single input port and sends the same data out to all connected output ports",t.inPorts.add("in",{datatype:"all",description:"Packet to be forwarded"}),t.outPorts.add("out",{datatype:"all"}),t.process(function(t,e){var n;return n=t.get("in"),e.sendDone({out:n})})}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o;o=n(0),e.getComponent=function(){var t;return(t=new o.Component).description="Add a class to an element",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("class",{datatype:"string"}),t.process(function(t,e){var n,o;if(t.has("element","class")){var i=r(t.getData("element","class"),2);return o=i[0],n=i[1],o.classList.add(n),e.done()}})}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o;o=n(0),e.getComponent=function(){var t;return(t=new o.Component).description="Append elements as children of a parent element",t.inPorts.add("parent",{datatype:"object"}),t.inPorts.add("child",{datatype:"object"}),t.process(function(t,e){var n,o;if(t.hasData("parent","child")){var i=r(t.getData("parent","child"),2);return o=i[0],n=i[1],o.appendChild(n),e.done()}})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Create a new DOM Element",t.inPorts.add("tagname",{datatype:"string"}),t.inPorts.add("container",{datatype:"object"}),t.outPorts.add("element",{datatype:"object"}),t.forwardBrackets={tagname:["element"]},t.process(function(e,n){var r,o;if(e.hasData("tagname")&&(!t.inPorts.container.isAttached()||e.hasData("container")))return o=e.getData("tagname"),r=document.createElement(o),e.hasData("container")&&e.getData("container").appendChild(r),n.sendDone({element:r})})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Create a new DOM DocumentFragment",t.inPorts.add("in",{datatype:"bang"}),t.outPorts.add("fragment",{datatype:"object"}),t.forwardBrackets={in:["fragment"]},t.process(function(t,e){var n;if(t.hasData("in"))return t.getData("in"),n=document.createDocumentFragment(),e.sendDone({fragment:n})})}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o;o=n(0),e.getComponent=function(){var t;return(t=new o.Component).description="Reads the given attribute from the DOM element on the in port.",t.inPorts.add("element",{datatype:"object",description:"The element from which to read the attribute from.",required:!0}),t.inPorts.add("attribute",{datatype:"string",description:"The attribute which is read from the DOM element.",required:!0,control:!0}),t.outPorts.add("out",{datatype:"string",description:"Value of the attribute being read."}),t.forwardBrackets={element:["out"]},t.process(function(t,e){var n,o,i;if(t.hasData("element","attribute")){var s=r(t.getData("element","attribute"),2);return o=s[0],n=s[1],i=o.getAttribute(n),e.sendDone({out:i})}})}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o;o=n(0),e.getComponent=function(){var t;return(t=new o.Component).description="Get a DOM element matching a query",t.inPorts.add("in",{datatype:"object",description:"DOM element to constrain the query to"}),t.inPorts.add("selector",{datatype:"string",description:"CSS selector"}),t.outPorts.add("element",{datatype:"object"}),t.outPorts.add("error",{datatype:"object"}),t.forwardBrackets={selector:["element","error"]},t.process(function(t,e){var n,o,i,s,a,c,u,p;if(t.hasData("selector")&&(!(t.attached("in").length>0)||t.hasData("in")))if(t.hasData("in")){var d=r(t.getData("in","selector"),2);if(n=d[0],p=d[1],"function"!=typeof n.querySelector)return void e.done(new Error("Given container doesn't support querySelectors"));if(!(o=n.querySelectorAll(p)).length)return void e.done(new Error("No element matching '".concat(p,"' found under container")));for(s=0,c=o.length;s<c;s++)i=o[s],e.send({element:i});e.done()}else{if(p=t.getData("selector"),(o=document.querySelectorAll(p)).length){for(a=0,u=o.length;a<u;a++)i=o[a],e.send({element:i});return e.done()}e.done(new Error("No element matching '".concat(p,"' found under document")))}})}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o;o=n(0),e.getComponent=function(){var t;return(t=new o.Component).description="Check if an element has a given class",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("class",{datatype:"string"}),t.outPorts.add("element",{datatype:"object"}),t.outPorts.add("missed",{datatype:"object"}),t.process(function(t,e){var n,o;if(t.hasData("element","class")){var i=r(t.getData("element","class"),2);if(n=i[0],o=i[1],!n.classList.contains(o))return e.sendDone({missed:n});e.sendDone({element:n})}})}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o;o=n(0),e.getComponent=function(){var t,e;return(t=new o.Component).description="addEventListener for specified event type",t.icon="stethoscope",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("type",{datatype:"string"}),t.inPorts.add("preventdefault",{datatype:"boolean",control:!0,default:!1}),t.outPorts.add("element",{datatype:"object"}),t.outPorts.add("event",{datatype:"object"}),t.elements={},e=function(e){var n,r,o;if(t.elements[e]){var i=t.elements[e];return n=i.element,r=i.event,o=i.listener,n.removeEventListener(r,o),t.elements[e].deactivate(),delete t.elements[e]}},t.tearDown=function(n){var r,o;for(o in r=t.elements)r[o],e(o);return t.elements={},n()},t.forwardBrackets={},t.process(function(n,o,i){var s,a,c;if(n.hasData("element","type")){var u=r(n.getData("element","type"),2);return s=u[0],c=u[1],a=!1,n.hasData("preventdefault")&&(a=n.getData("preventdefault")),null,e(null),i.element=s,i.event=c,i.listener=function(t){return a&&t.preventDefault(),o.send({element:i.element,event:t})},t.elements[i]=i,s.addEventListener(c,i.listener)}})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Read HTML from an existing element",t.inPorts.add("container",{datatype:"object"}),t.outPorts.add("html",{datatype:"string"}),t.forwardBrackets={container:["html"]},t.process(function(t,e){var n;if(t.hasData("container"))return n=t.getData("container"),e.sendDone({html:n.innerHTML})})}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o;o=n(0),e.getComponent=function(){var t;return(t=new o.Component).description="Remove a class from an element",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("class",{datatype:"string"}),t.process(function(t,e){var n,o;if(t.has("element","class")){var i=r(t.getData("element","class"),2);return o=i[0],n=i[1],o.classList.remove(n),e.done()}})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Remove an element from DOM",t.inPorts.add("element",{datatype:"object"}),t.process(function(t,e){var n;if(t.hasData("element")&&(n=t.getData("element")).parentNode)return n.parentNode.removeChild(n),e.done()})}},function(t,e,n){"use strict";var r,o;r=n(0),o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(function(){return t(+new Date)},1e3/60)},e.getComponent=function(){var t,e;return(t=new r.Component).description="Sends bangs that correspond with screen refresh rate.",t.icon="film",t.inPorts.add("start",{datatype:"bang"}),t.inPorts.add("stop",{datatype:"bang"}),t.outPorts.add("out",{datatype:"bang"}),t.running={},e=function(e){if(t.running[e])return t.running[e].deactivate(),delete t.running[e]},t.tearDown=function(n){var r,o;for(o in r=t.running)r[o],e(o);return t.running={},n()},t.animate=function(e,n){if(t.running[e])return n.send(!0),o(t.animate.bind(t,e,n))},t.forwardBrackets={},t.process(function(n,r,i){var s,a;if(n.hasData("start")){if("data"!==(s=n.get("start")).type)return;return e(s.scope),t.running[s.scope]=i,void o(t.animate.bind(t,s.scope,r))}if(n.hasData("stop")){if("data"!==(a=n.get("stop")).type)return;e(a.scope)}})}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i;i=n(0),e.getComponent=function(){var t;return(t=new i.Component).description="Set the given attribute on the DOM element to the received value.",t.inPorts.add("element",{datatype:"object",description:"The element on which to set the attribute."}),t.inPorts.add("attribute",{datatype:"string",description:"The attribute which is set on the DOM element."}),t.inPorts.add("value",{datatype:"string",description:"Value of the attribute being set."}),t.outPorts.add("element",{datatype:"object",description:"The element that was updated."}),t.forwardBrackets={element:["element"],value:["element"]},t.process(function(t,e){var n,i,s,a,c,u;if(t.hasData("element","attribute","value")){var p=o(t.getData("element","attribute","value"),3);if(i=p[0],n=p[1],"object"===r(u=p[2]))if("[object Array]"===toString.call(u))u=u.join(" ");else{for(s in a=[],u)c=u[s],a.push(c);u=a.join(" ")}return"value"===n?i.value=u:i.setAttribute(n,u),e.sendDone({element:i})}})}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o;o=n(0),e.getComponent=function(){var t;return(t=new o.Component).description="Write HTML inside an existing element",t.inPorts.add("container",{datatype:"object"}),t.inPorts.add("html",{datatype:"string"}),t.outPorts.add("container",{datatype:"object"}),t.process(function(t,e){var n,o;if(t.hasData("container","html")){var i=r(t.getData("container","html"),2);return n=i[0],o=i[1],n.innerHTML=o,e.sendDone({container:n})}})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).icon="i-cursor",t.description="focus element",t.inPorts.add("element",{datatype:"object",description:"element to be focused",control:!0}),t.inPorts.add("trigger",{datatype:"bang",description:"trigger focus"}),t.outPorts.add("out",{datatype:"bang"}),t.process(function(t,e){var n;if(t.hasData("element","trigger"))return n=t.getData("element"),t.getData("trigger"),window.setTimeout(function(){return n.focus(),e.sendDone({out:!0})},0)})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Listen to changes on an input element",t.icon="hourglass",t.inPorts.add("element",{datatype:"object"}),t.outPorts.add("value",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener("change",n.listener,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process(function(e,n,r){var o;e.hasData("element")&&((o={el:e.getData("element"),listener:function(t){return t.preventDefault(),t.stopPropagation(),n.send({value:t.target.value})},ctx:r}).el.addEventListener("change",o.listener,!1),t.elements.push(o))})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Listen to drag events on a DOM element",t.icon="arrows",t.inPorts.add("element",{datatype:"object"}),t.outPorts.add("start",{datatype:"object"}),t.outPorts.add("movey",{datatype:"number"}),t.outPorts.add("movex",{datatype:"number"}),t.outPorts.add("end",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener("dragstart",n.dragstart,!1),n.el.removeEventListener("drag",n.dragmove,!1),n.el.removeEventListener("dragend",n.dragend,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process(function(e,n,r){var o;e.hasData("element")&&((o={el:e.getData("element"),dragstart:function(t){return t.stopPropagation(),n.send({start:t})},dragmove:function(t){return t.preventDefault(),t.stopPropagation(),n.send({movex:t.clientX,movey:t.clientY})},dragend:function(t){return t.preventDefault(),t.stopPropagation(),n.send({end:t})},ctx:r}).el.addEventListener("dragstart",o.dragstart,!1),o.el.addEventListener("drag",o.dragmove,!1),o.el.addEventListener("dragend",o.dragend,!1),t.elements.push(o))})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).icon="rss",t.description="Listen to custom events on a DOM element",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("event",{datatype:"string"}),t.outPorts.add("out",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener(n.eventName,n.onEvent,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process(function(e,n,r){var o,i;e.hasData("element","event")&&((o={el:e.getData("element"),eventName:i=e.getData("event"),onEvent:function(t){return t.preventDefault(),t.stopPropagation(),t.eventName=i,n.send({out:t})},ctx:r}).el.addEventListener(i,o.onEvent,!1),t.elements.push(o))})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e;return(t=new r.Component).description="Listen for hash changes in browser's URL bar",t.icon="slack",t.inPorts.add("start",{datatype:"bang",description:"Start listening for hash changes"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop listening for hash changes"}),t.outPorts.add("initial",{datatype:"string"}),t.outPorts.add("change",{datatype:"string"}),t.current=null,t.subscriber=null,e=function(){if(t.subscriber)return window.removeEventListener("hashchange",t.subscriber.callback,!1),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(n){return t.current=null,e(),n()},t.forwardBrackets={},t.process(function(n,o,i){var s;if(n.hasData("start"))return n.getData("start"),e(),s=function(e){var n,i;if(n=t.current,t.current=window.location.href.split("#")[1]||"",n&&o.send({change:new r.IP("openBracket",n)}),(i={})[e]=t.current,o.send(i),n)return o.send({change:new r.IP("closeBracket",n)})},t.subscriber={callback:function(t){return s("change")},ctx:i},s("initial"),void window.addEventListener("hashchange",t.subscriber.callback,!1);n.hasData("stop")&&(n.getData("stop"),e(),o.done())})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Listen for key presses on a given DOM element",t.icon="keyboard-o",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("stop",{datatype:"object"}),t.outPorts.add("keypress",{datatype:"integer"}),t.elements=[],function(t){return t.el.removeEventListener("keypress",t.listener,!1),t.ctx.deactivate()},t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)n=i[r],unsubscribe(n);return t.elements=[],e()},t.forwardBrackets={},t.process(function(e,n,r){var o,i,s,a,c,u,p;if(e.hasData("element"))return(i={el:e.getData("element"),listener:function(t){return n.send({keypress:t.keyCode})},ctx:r}).el.addEventListener("keypress",i.listener,!1),void t.elements.push(i);if(e.hasData("stop")){for(a=e.getData("stop"),o=null,c=0,u=(p=t.elements).length;c<u;c++)(s=p[c]).el===a&&(o=s);if(!o)return;return unsubscribe(o),n.done()}})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e;return(t=new r.Component).description="Listen for keyboard shortcuts and route them",t.icon="keyboard-o",t.inPorts.add("keys",{datatype:"array"}),t.inPorts.add("ignoreinput",{datatype:"boolean",default:!0,control:!0}),t.inPorts.add("stop",{datatype:"bang"}),t.outPorts.add("shortcut",{datatype:"bang",addressable:!0}),t.outPorts.add("missed",{datatype:"integer"}),t.subscriber=null,e=function(){if(t.subscriber)return document.removeEventListener("keydown",t.subscriber.callback,!1),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(t){return e(),t()},t.forwardBrackets={},t.process(function(n,o,i){var s,a,c,u,p;if(n.hasData("keys")){for(u=n.getData("keys"),e(),"string"==typeof u&&(u=u.split(",")),c=s=0,p=u.length;s<p;c=++s)switch(u[c]){case"-":u[c]=189;break;case"=":u[c]=187;break;case"0":u[c]=48;break;case"a":u[c]=65;break;case"x":u[c]=88;break;case"c":u[c]=67;break;case"v":u[c]=86;break;case"z":u[c]=90;break;case"r":u[c]=82}return a=!n.hasData("ignoreinput")||n.getData("ignoreinput"),t.subscriber={callback:function(t){var e;if((t.ctrlKey||t.metaKey)&&!("TEXTAREA"===t.target.tagName&&a||"INPUT"===t.target.tagName&&a||"true"===String(t.target.contentEditable)&&a)){if(-1!==(e=u.indexOf(t.keyCode)))return t.preventDefault(),t.stopPropagation(),o.send({shortcut:new r.IP("data",t.keyCode,{index:e})});o.send({missed:t.keyCode})}},ctx:i},void document.addEventListener("keydown",t.subscriber.callback,!1)}n.hasData("stop")&&(n.getData("stop"),e(),o.done())})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).icon="mouse-pointer",t.description="Listen to mouse events on a DOM element",t.inPorts.add("element",{datatype:"object"}),t.outPorts.add("click",{datatype:"object"}),t.outPorts.add("dblclick",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener("click",n.click,!1),n.el.removeEventListener("dblclick",n.dblclick,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process(function(e,n,r){var o;e.hasData("element")&&((o={el:e.getData("element"),click:function(t){return t.preventDefault(),t.stopPropagation(),n.send({click:t})},dblclick:function(t){return t.preventDefault(),t.stopPropagation(),n.send({dblclick:t})},ctx:r}).el.addEventListener("click",o.click,!1),o.el.addEventListener("dblclick",o.dblclick,!1),t.elements.push(o))})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e,n,o,i;for((t=new r.Component).description="Listen to pointer events on a DOM element",t.icon="pencil-square-o",t.inPorts.add("element",{datatype:"object"}),t.inPorts.add("action",{datatype:"string",default:"none",control:!0}),o=0,i=(n=["down","up","cancel","move","over","out","enter","leave"]).length;o<i;o++)e=n[o],t.outPorts.add(e,{datatype:"object",description:"Sends event on pointer".concat(e)});return t.elements=[],t.tearDown=function(r){var o,i,s,a,c,u;for(i=0,a=(u=t.elements).length;i<a;i++){for((o=u[i]).el.removeAttribute&&o.el.removeAttribute("touch-action"),s=0,c=n.length;s<c;s++)e=n[s],o.el.removeEventListener("pointer".concat(e),o["pointer".concat(e)],!1);o.ctx.deactivate()}return t.elements=[],r()},t.forwardBrackets={},t.process(function(e,r,o){var i,s;e.hasData("element")&&(i=e.hasData("action")?e.getData("action"):"none",(s={el:e.getData("element"),ctx:o}).el.setAttribute("touch-action",i),n.forEach(function(t){return s["pointer".concat(t)]=function(e){var n;return e.preventDefault(),e.stopPropagation(),(n={})[t]=e.target.value,r.send(n)},s.el.addEventListener("pointer".concat(t),s["pointer".concat(t)],!1)}),t.elements.push(s))})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e;return(t=new r.Component).description="Listen to window resize events",t.icon="desktop",t.inPorts.add("start",{datatype:"bang",description:"Start listening for screen resizes"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop listening for screen resizes"}),t.outPorts.add("width",{datatype:"number"}),t.outPorts.add("height",{datatype:"number"}),t.subscriber=null,e=function(){if(t.subscriber)return window.removeEventListener("resize",t.subscriber.callback,!1),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(t){return e(),t()},t.forwardBrackets={},t.process(function(n,r,o){if(n.hasData("start"))return n.getData("start"),e(),t.subscriber={callback:function(t){return r.send({width:window.innerWidth,height:window.innerHeight})},ctx:o},r.send({width:window.innerWidth,height:window.innerHeight}),void window.addEventListener("resize",t.subscriber.callback,!1);n.hasData("stop")&&(n.getData("stop"),e(),r.done())})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e;return(t=new r.Component).description="Listen to scroll events on the browser window",t.icon="arrows-v",t.inPorts.add("start",{datatype:"bang",description:"Start listening for hash changes"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop listening for hash changes"}),t.outPorts.add("top",{datatype:"number"}),t.outPorts.add("bottom",{datatype:"number"}),t.outPorts.add("left",{datatype:"number"}),t.outPorts.add("right",{datatype:"number"}),t.subscriber=null,e=function(){if(t.subscriber)return window.removeEventListener("scroll",t.subscriber.callback,!1),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(t){return e(),t()},t.forwardBrackets={},t.process(function(n,r,o){if(n.hasData("start"))return n.getData("start"),e(),t.subscriber={callback:function(t){var e,n;return n=window.scrollY,e=window.scrollX,r.send({top:n,bottom:n+window.innerHeight,left:e,right:e.window.innerWidth})},ctx:o},void window.addEventListener("scroll",t.subscriber.callback,!1);n.hasData("stop")&&(n.getData("stop"),e(),r.done())})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t,e;return(t=new r.Component).description="Listen for user's microphone and recognize phrases",t.icon="microphone",t.inPorts.add("start",{datatype:"bang",description:"Start listening for hash changes"}),t.inPorts.add("stop",{datatype:"bang",description:"Stop listening for hash changes"}),t.outPorts.add("result",{datatype:"string"}),t.outPorts.add("error",{datatype:"object"}),t.subscriber=null,e=function(){if(t.subscriber)return t.subscriber.recognition.stop(),t.subscriber.ctx.deactivate(),t.subscriber=null},t.tearDown=function(t){return e(),t()},t.forwardBrackets={},t.process(function(n,r,o){if(n.hasData("start"))return n.getData("start"),e(),window.webkitSpeechRecognition?(t.subscriber={sent:[],callback:function(e){var n,o,i,s,a,c;for(c=[],o=n=0,i=(s=e.results).length;n<i;o=++n)(a=s[o]).isFinal&&-1===t.subscriber.sent.indexOf(o)&&(r.send({result:a[0].transcript}),c.push(t.subscriber.sent.push(o)));return c},error:function(t){return r.send({error:t})},ctx:o},t.subscriber.recognition=new window.webkitSpeechRecognition,t.subscriber.recognition.continuous=!0,t.subscriber.recognition.start(),t.subscriber.recognition.onresult=t.subscriber.callback,void(t.subscriber.recognition.onerror=t.subscriber.error)):void r.done(new Error("Speech recognition support not available"));n.hasData("stop")&&(n.getData("stop"),e(),r.done())})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Listen to touch events on a DOM element",t.icon="hand-o-up",t.inPorts.add("element",{datatype:"object"}),t.outPorts.add("start",{datatype:"object"}),t.outPorts.add("movex",{datatype:"number"}),t.outPorts.add("movey",{datatype:"number"}),t.outPorts.add("end",{datatype:"object"}),t.elements=[],t.tearDown=function(e){var n,r,o,i;for(r=0,o=(i=t.elements).length;r<o;r++)(n=i[r]).el.removeEventListener("touchstart",n.touchstart,!1),n.el.removeEventListener("touchmove",n.touchmove,!1),n.el.removeEventListener("touchend",n.touchend,!1),n.ctx.deactivate();return t.elements=[],e()},t.forwardBrackets={},t.process(function(e,n,o){var i;e.hasData("element")&&((i={el:e.getData("element"),touchstart:function(t){var e,o,i,s,a;if(t.preventDefault(),t.stopPropagation(),t.changedTouches&&t.changedTouches.length){for(a=[],o=e=0,i=(s=t.changedTouches).length;e<i;o=++e)s[o],a.push(n.send({start:new r.IP("data",t,{touch:o})}));return a}},touchmove:function(t){var e,o,i,s,a,c;if(t.preventDefault(),t.stopPropagation(),t.changedTouches&&t.changedTouches.length){for(a=[],o=e=0,i=(s=t.changedTouches).length;e<i;o=++e)c=s[o],a.push(n.send({movex:new r.IP("data",c.pageX,{touch:o}),movey:new r.IP("data",c.pageY,{touch:o})}));return a}},touchend:function(t){var e,o,i,s,a;if(t.preventDefault(),t.stopPropagation(),t.changedTouches&&t.changedTouches.length){for(a=[],o=e=0,i=(s=t.changedTouches).length;e<i;o=++e)s[o],a.push(n.send({end:new r.IP("data",t,{touch:o})}));return a}},ctx:o}).el.addEventListener("touchstart",i.touchstart,!1),i.el.addEventListener("touchmove",i.touchmove,!1),i.el.addEventListener("touchend",i.touchend,!1),t.elements.push(i))})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Read the coordinates from a DOM event",t.icon="map-marker",t.inPorts.add("event",{datatype:"object"}),t.outPorts.add("screen",{datatype:"object"}),t.outPorts.add("client",{datatype:"object"}),t.outPorts.add("page",{datatype:"object"}),t.forwardBrackets={event:["screen","client","page"]},t.process(function(t,e){var n;if(t.hasData("event"))return n=t.getData("event"),e.sendDone({screen:{x:n.screenX,y:n.screenY},client:{x:n.clientX,y:n.clientY},page:{x:n.pageX,y:n.pageY}})})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Read the state of a gamepad",t.icon="gamepad",t.inPorts.add("gamepad",{datatype:"integer"}),t.outPorts.add("out",{datatype:"object"}),t.outPorts.add("error",{datatype:"object"}),t.lastTimestamps={},t.tearDown=function(e){return t.lastTimestamps={},e()},t.process(function(e,n){var r,o;if(e.hasData("gamepad"))if(r=e.getData("gamepad"),navigator.webkitGetGamepads){if((o=navigator.webkitGetGamepads()[r])||n.done(new Error("Gamepad '".concat(r,"' not available"))),!(t.lastTimestamps[r]=o.timestamp))return t.lastTimestamps[r]=o.timestamp,n.sendDone({out:o});n.done()}else n.done(new Error("No WebKit Gamepad API available"))})}},function(t,e,n){"use strict";var r;r=n(0),e.getComponent=function(){var t;return(t=new r.Component).description="Set the hash in browser's URL bar",t.icon="slack",t.inPorts.add("hash",{datatype:"string"}),t.outPorts.add("out",{datatype:"string"}),t.process(function(t,e){var n;if(t.hasData("hash"))return n=t.getData("hash"),window.location.hash="#".concat(n),e.sendDone({out:n})})}},function(t,e,n){"use strict";t.exports=function(t){function e(t){for(var e=0,n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return r.colors[Math.abs(e)%r.colors.length]}function r(t){var n;function s(){if(s.enabled){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];var i=s,a=Number(new Date),c=a-(n||a);i.diff=c,i.prev=n,i.curr=a,n=a,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");var u=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,function(t,n){if("%%"===t)return t;u++;var o=r.formatters[n];if("function"==typeof o){var s=e[u];t=o.call(i,s),e.splice(u,1),u--}return t}),r.formatArgs.call(i,e),(i.log||r.log).apply(i,e)}}return s.namespace=t,s.enabled=r.enabled(t),s.useColors=r.useColors(),s.color=e(t),s.destroy=o,s.extend=i,"function"==typeof r.init&&r.init(s),r.instances.push(s),s}function o(){var t=r.instances.indexOf(this);return-1!==t&&(r.instances.splice(t,1),!0)}function i(t,e){return r(this.namespace+(void 0===e?":":e)+t)}return r.debug=r,r.default=r,r.coerce=function(t){return t instanceof Error?t.stack||t.message:t},r.disable=function(){r.enable("")},r.enable=function(t){var e;r.save(t),r.names=[],r.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),o=n.length;for(e=0;e<o;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+t.substr(1)+"$")):r.names.push(new RegExp("^"+t+"$")));for(e=0;e<r.instances.length;e++){var i=r.instances[e];i.enabled=r.enabled(i.namespace)}},r.enabled=function(t){if("*"===t[t.length-1])return!0;var e,n;for(e=0,n=r.skips.length;e<n;e++)if(r.skips[e].test(t))return!1;for(e=0,n=r.names.length;e<n;e++)if(r.names[e].test(t))return!0;return!1},r.humanize=n(91),Object.keys(t).forEach(function(e){r[e]=t[e]}),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=e,r.enable(r.load()),r}},function(t,e){var n=1e3,r=60*n,o=60*r,i=24*o,s=7*i,a=365.25*i;function c(t,e,n,r){var o=e>=1.5*n;return Math.round(t/n)+" "+r+(o?"s":"")}t.exports=function(t,e){e=e||{};var u=typeof t;if("string"===u&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var c=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*a;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*o;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(t);if("number"===u&&!1===isNaN(t))return e.long?function(t){var e=Math.abs(t);if(e>=i)return c(t,e,i,"day");if(e>=o)return c(t,e,o,"hour");if(e>=r)return c(t,e,r,"minute");if(e>=n)return c(t,e,n,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=i)return Math.round(t/i)+"d";if(e>=o)return Math.round(t/o)+"h";if(e>=r)return Math.round(t/r)+"m";if(e>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){(function(t){var r,o,i,s,a,c,u,p,d,l,h,f,m,g,v,y,b,w,E,P,k={}.hasOwnProperty;o=n(8),r=n(4),f=n(9),P=n(17),u=n(3)("noflo:helpers"),e.WirePattern=function(e,n,r){var o,s,a;if(o="in"in n?n.in:"in",P.isArray(o)||(o=[o]),s="out"in n?n.out:"out",P.isArray(s)||(s=[s]),"error"in n||(n.error="error"),"async"in n||(n.async=!1),"ordered"in n||(n.ordered=!0),"group"in n||(n.group=!1),"field"in n||(n.field=null),"forwardGroups"in n||(n.forwardGroups=!1),n.forwardGroups&&("string"==typeof n.forwardGroups&&(n.forwardGroups=[n.forwardGroups]),"boolean"==typeof n.forwardGroups&&(n.forwardGroups=o)),"receiveStreams"in n||(n.receiveStreams=!1),n.receiveStreams)throw new Error("WirePattern receiveStreams is deprecated");if("sendStreams"in n||(n.sendStreams=!1),n.sendStreams)throw new Error("WirePattern sendStreams is deprecated");return n.async&&(n.sendStreams=s),"params"in n||(n.params=[]),"string"==typeof n.params&&(n.params=[n.params]),"name"in n||(n.name=""),"dropInput"in n||(n.dropInput=!1),"arrayPolicy"in n||(n.arrayPolicy={in:"any",params:"all"}),n.inPorts=o,n.outPorts=s,i(n,r),(n.legacy||(null!=t&&null!=(a=t.env)?a.NOFLO_WIREPATTERN_LEGACY:void 0))&&f.deprecated("noflo.helpers.WirePattern legacy mode is deprecated"),g(e,n,r)},g=function(t,e,n){return b(t,e),E(t),y(t,e),t.ordered=e.ordered,t.process(function(r,o,i){var a,c,h,f,g,v;if(s(e,r,o))return t.params=m(e,r),a=d(e,r),h=p(t,e.inPorts[0],r),f=l(e.outPorts,o),u("WirePattern Process API call with",a,h,t.params,i.scope),g=function(){throw new Error("noflo.helpers.WirePattern postpone is deprecated")},v=function(){throw new Error("noflo.helpers.WirePattern resume is deprecated")},c=w(t,e,o),n.call(t,a,h,f,function(t){return c(),o.done(t)},g,v,r.scope)})},i=function(t,e){if(t.group&&f.deprecated("noflo.helpers.WirePattern group option is deprecated. Please port to Process API"),t.field&&f.deprecated("noflo.helpers.WirePattern field option is deprecated. Please port to Process API"),e.length>4&&f.deprecated("noflo.helpers.WirePattern postpone and resume are deprecated. Please port to Process API"),!t.async)throw new Error("noflo.helpers.WirePattern synchronous is deprecated. Please use async: true");if(e.length<4)throw new Error("noflo.helpers.WirePattern callback doesn't use callback argument");"error"!==t.error&&f.deprecated('noflo.helpers.WirePattern custom error port name is deprecated. Please switch to "error" or port to WirePattern')},b=function(t,e){var n,r,o,i,s;for(s=[],n=0,r=(i=e.params).length;n<r;n++)o=i[n],s.push(t.inPorts[o].options.control=!0);return s},y=function(t,e){var n,r,o,i,s,a,c,u;if(t.forwardBrackets={},e.forwardGroups)for(o=e.inPorts,P.isArray(e.forwardGroups)&&(o=e.forwardGroups),n=0,s=o.length;n<s;n++){for(r=o[n],t.forwardBrackets[r]=[],i=0,a=(u=e.outPorts).length;i<a;i++)c=u[i],t.forwardBrackets[r].push(c);t.outPorts.error&&t.forwardBrackets[r].push("error")}},w=function(t,e,n){var o,i,s,a;return i=[],o=function(e,n=[]){return f.deprecated("noflo.helpers.WirePattern error method is deprecated. Please send error to callback instead"),i.push({err:e,groups:n}),t.hasErrors=!0},s=function(t=null,e=[]){return f.deprecated("noflo.helpers.WirePattern fail method is deprecated. Please send error to callback instead"),t&&o(t,e),a(),n.done()},a=function(){if(i.length)return e.name&&n.sendIP("error",new r("openBracket",e.name)),i.forEach(function(t){var e,o,i,s,a,c,u,p;for(o=0,s=(c=t.groups).length;o<s;o++)e=c[o],n.sendIP("error",new r("openBracket",e));for(n.sendIP("error",new r("data",t.err)),p=[],i=0,a=(u=t.groups).length;i<a;i++)e=u[i],p.push(n.sendIP("error",new r("closeBracket",e)));return p}),e.name&&n.sendIP("error",new r("closeBracket",e.name)),t.hasErrors=!1,i=[]},t.hasErrors=!1,t.error=o,t.fail=s,a},E=function(t){var e;return e=Object.keys(t.inPorts.ports).filter(function(e){return!!t.inPorts[e].options.control&&!!t.inPorts[e].hasDefault()}),t.sendDefaults=function(){return f.deprecated("noflo.helpers.WirePattern sendDefaults method is deprecated. Please start with a Network"),e.forEach(function(e){var n;return n=o.createSocket(),t.inPorts[e].attach(n),n.send(),n.disconnect(),t.inPorts[e].detach(n)})}},m=function(t,e){var n,r,o,i,s,a,c,u,p;if(!t.params.length)return{};for(c={},n=0,i=(u=t.params).length;n<i;n++)if(a=u[n],e.ports[a].isAddressable())for(c[a]={},o=0,s=(p=e.attached(a)).length;o<s;o++)r=p[o],e.hasData([a,r])&&(c[a][r]=e.getData([a,r]));else c[a]=e.getData(a);return c},v=function(t,e){var n,r,o,i,s,a,c,u,p,d,l;for(p=null,n=[],d=[],o=r=0,a=t.length;r<a;o=++r)if("openBracket"!==(i=t[o]).type){if("closeBracket"!==i.type)e(i,n)?(p=d.slice(0)).push(i):d=[];else if(n.pop(),p&&p.push(i),d.length&&d.pop(),p&&!d.length)break}else n.push(i.data),d.push(i);if(0!==(l=t.indexOf(p[0]))){for(t.splice(l,p.length),p.reverse(),u=[],s=0,c=p.length;s<c;s++)i=p[s],u.push(t.unshift(i));return u}},h=function(t,e,n,r,o){var i;if(e.group||e.field)return e.group&&(i=n.ports[r].getBuffer(n.scope,o),v(i,function(t,e){var r,i,s,a;for(a=n.collatedBy.brackets,o=i=0,s=a.length;i<s;o=++i)if(r=a[o],e[o]!==r)return!1;return!0})),e.field?(t[e.field]=n.collatedBy.field,i=n.ports[r].getBuffer(n.scope,o),v(i,function(n){return n.data[e.field]===t[e.field]})):void 0},d=function(t,e){var n,r,o,i,s,a,c,u,p;for(n={},r=0,s=(u=t.inPorts).length;r<s;r++)if(c=u[r],e.ports[c].isAddressable())for(n[c]={},i=0,a=(p=e.attached(c)).length;i<a;i++)o=p[i],e.hasData([c,o])&&(h(n,t,e,c,o),n[c][o]=e.getData([c,o]));else e.hasData(c)&&(h(n,t,e,c),n[c]=e.getData(c));return 1===t.inPorts.length?n[t.inPorts[0]]:n},p=function(t,e,n){var r,o;return null==(null!=(r=n.result.__bracketContext)?r[e]:void 0)?[]:(null!=(o=n.collatedBy)?o.brackets:void 0)?n.collatedBy.brackets:n.result.__bracketContext[e].filter(function(t){return t.source===e}).map(function(t){return t.ip.data})},l=function(t,e){var n;return n={},t.forEach(function(t){return n[t]={connect:function(){},beginGroup:function(n,o){var i;return(i=new r("openBracket",n)).index=o,e.sendIP(t,i)},send:function(n,o){var i;return(i=new r("data",n)).index=o,e.sendIP(t,i)},endGroup:function(n,o){var i;return(i=new r("closeBracket",n)).index=o,e.sendIP(t,i)},disconnect:function(){}}}),1===t.length?n[t[0]]:n},s=function(t,e,n){var r,o,i,s,u,p,d,l,h,f,m;if(h=c(t,e),s=a(t,e),t.dropInput&&!h){for(l=!1,o=0,p=(m=t.inPorts).length;o<p;o++)if(f=m[o],e.ports[f].isAddressable()){if(!(r=e.attached(f)).length)continue;for(u=0,d=r.length;u<d;u++)for(i=r[u];e.has([f,i]);)l=!0,e.get([f,i]).drop()}else for(;e.has(f);)l=!0,e.get(f).drop();l&&n.done()}return s&&h},c=function(t,e){var n,r,o,i,s,a;for(r=0,o=(s=t.params).length;r<o;r++)if(i=s[r],e.ports[i].isRequired())if(e.ports[i].isAddressable()){if(!(n=e.attached(i)).length)return!1;if(a=n.filter(function(t){return e.hasData([i,t])}),"all"===t.arrayPolicy.params){if(a.length!==n.length)return!1;continue}if(!a.length)return!1}else if(!e.hasData(i))return!1;return!0},a=function(t,e){var n,r,o,i,s,a,c,u,p,d;for(t.group&&(r={},e.collatedBy={brackets:[],ready:!1},o=function(t,e){var n,r,o,i;for(o=r=0,i=t.length;r<i;o=++r)if(n=t[o],e[o]!==n)return!1;return!0},i=function(n,i){var s,a;if(a=i.slice(0),t.group instanceof RegExp){if(!(a=a.slice(0,1)).length)return!1;if(!t.group.test(a[0]))return!1}return e.collatedBy.ready?o(e.collatedBy.brackets,a):(s=a.join(":"),r[s]||(r[s]=[]),-1===r[s].indexOf(u)&&r[s].push(u),t.inPorts.indexOf(u)!==t.inPorts.length-1||r[s].length===t.inPorts.length&&(!e.collatedBy.ready&&(e.collatedBy.ready=!0,e.collatedBy.brackets=a,!0)))}),t.field&&(e.collatedBy={field:void 0,ready:!1}),s=function(n){var r,o,s,a,c,u,p;if(!t.group&&!t.field)return e.hasData(n);if(t.group){for(p=[],[],s=!1,a=0,u=(r=e.ports[n].getBuffer(e.scope)).length;a<u;a++)if("openBracket"!==(c=r[a]).type)if("closeBracket"!==c.type)o=i(c,p);else{if(p.pop(),p.length)continue;if(!o)continue;s=!0}else p.push(c.data);return s}return t.field?e.hasStream(n,function(n){return e.collatedBy.ready?n.data[t.field]===e.collatedBy.field:(e.collatedBy.field=n.data[t.field],e.collatedBy.ready=!0,!0)}):void 0},a=0,c=(p=t.inPorts).length;a<c;a++)if(u=p[a],e.ports[u].isAddressable()){if(!(n=e.attached(u)).length)return!1;if(d=n.filter(function(t){return s([u,t])}),"all"===t.arrayPolicy.in){if(d.length!==n.length)return!1;continue}if(!d.length)return!1}else if(!s(u))return!1;return!0},e.CustomError=function(t,n){var r;return r=new Error(t),e.CustomizeError(r,n)},e.CustomizeError=function(t,e){var n,r;for(n in e)k.call(e,n)&&(r=e[n],t[n]=r);return t}}).call(this,n(1))},function(t,e,n){(function(t){var r,o,i,s,a,c,u,p,d,l,h,f;r=n(10).ComponentLoader,s=n(15).Network,i=n(4),c=n(8),o=n(6).Graph,u=function(e,n){return e||(e={}),e.name||(e.name=n),e.loader&&(e.baseDir=e.loader.baseDir),!e.baseDir&&t&&t.cwd&&(e.baseDir=t.cwd()),e.loader||(e.loader=new r(e.baseDir)),e.raw||(e.raw=!1),e},l=function(t,e,n){var r;return"object"==typeof t?(t.componentLoader=e.loader,void(r=new s(t,e)).connect(function(t){return t?n(t):n(null,r)})):e.loader.load(t,function(i,a){var c,u,p,d,l;if(i)return n(i);for(l in c=new o(e.name),p=e.name,c.addNode(p,t),u=a.inPorts.ports,d=a.outPorts.ports,u)u[l],c.addInport(l,p,l);for(l in d)d[l],c.addOutport(l,p,l);return c.componentLoader=e.loader,(r=new s(c,e)).connect(function(t){return t?n(t):n(null,r)})})},h=function(t,e,n,r){var o,s,a,u;return Object.keys(t.graph.inports),o={},u=[],s=Object.keys(t.graph.outports),a={},s.forEach(function(e){var n,r;return n=t.graph.outports[e],r=t.getNode(n.process),a[e]=c.createSocket(),r.component.outPorts[n.port].attach(a[e]),a[e].from={process:r,port:n.port},a[e].on("ip",function(t){var n;return(n={})[e]=t,u.push(n)})}),t.once("end",function(){var t,e;for(t in a)(e=a[t]).from.process.component.outPorts[e.from.port].detach(e);return a={},o={},r(null,u)}),t.start(function(n){var s,a,u,p,d,l,h,f;if(n)return r(n);for(h=[],s=0,u=e.length;s<u;s++)a=e[s],h.push(function(){var e;for(p in e=[],a)f=a[p],o[p]||(d=t.graph.inports[p],l=t.getNode(d.process),o[p]=c.createSocket(),l.component.inPorts[d.port].attach(o[p])),i.isIP(f)?o[p].post(f):e.push(o[p].post(new i("data",f)));return e}());return h})},a=function(t,e){var n;if("object"!=typeof t)return"simple";if(Array.isArray(t))return t.filter(function(t){return"map"===a(t,e)}).length===t.length?"sequence":"simple";if(!Object.keys(t).length)return"simple";for(n in t)if(t[n],!e.graph.inports[n])return"simple";return"map"},d=function(t,e,n){var r,o;return"sequence"===e?t:"map"===e?[t]:(r=Object.keys(n.graph.inports)[0],n.graph.inports.in&&(r="in"),(o={})[r]=t,[o])},p=function(t,e){var n,r,o,i,s,a;if(e.raw)return t;for(s=null,n=a=[],r=0,o=t.length;r<o;r++)"openBracket"===(i=t[r]).type&&(s=n,n=[],s.push(n)),"data"===i.type&&n.push(i.data),"closeBracket"===i.type&&(n=s);return 1===a.length?a[0]:a},f=function(t,e,n,r){var o,i,s,a,c,u,d,l,h,f,m;if((o=t.filter(function(t){return null!=t.error}).map(function(t){return t.error})).length)return r(p(o,n));if("sequence"===e)return r(null,t.map(function(t){var e,r,o;for(e in r={},t)o=t[e],n.raw?r[e]=o:r[e]=p([o],n);return r}));for(u={},i=0,a=t.length;i<a;i++)for(s in c=t[i])f=c[s],u[s]||(u[s]=[]),u[s].push(f);if(0===(m=Object.keys(u).filter(function(t){return u[t].length>0})).length)return r(null);if(1===m.length&&"simple"===e)return r(null,p(u[m[0]],n));for(l in h={},u)d=u[l],h[l]=p(d,n);return r(null,h)},e.asCallback=function(t,e){return e=u(e,t),function(n,r){return l(t,e,function(t,o){var i,s;return t?r(t):(s=a(n,o),i=d(n,s,o),h(o,i,0,function(t,n){return t?r(t):f(n,s,e,r)}))})}}}).call(this,n(1))},function(t,e,n){var r,o;o=n(95),({Component:r}=n(18)),e.asComponent=function(t,e){var n,i,s,a,c,u,p;for(i=!1,u=o(t).filter(function(t){return"callback"!==t.param||(i=!0,!1)}),n=new r(e),s=0,a=u.length;s<a;s++)p={required:!0},void 0!==(c=u[s]).default&&(p.default=c.default,p.required=!1),n.inPorts.add(c.param,p),n.forwardBrackets[c.param]=["out","error"];return u.length||n.inPorts.add("in",{datatype:"bang"}),n.outPorts.add("out"),n.outPorts.add("error"),n.process(function(e,n){var r,o,s,a;if(u.length){for(r=0,o=u.length;r<o;r++)if(c=u[r],!e.hasData(c.param))return;a=u.map(function(t){return e.getData(t.param)})}else{if(!e.hasData("in"))return;e.getData("in"),a=[]}return i?(a.push(function(t,e){return t?n.done(t):n.sendDone(e)}),void(s=t.apply(null,a))):(s=t.apply(null,a))&&"object"==typeof s&&"function"==typeof s.then?void s.then(function(t){return n.sendDone(t)},function(t){return n.done(t)}):n.sendDone(s)}),n}},function(t,e,n){var r=n(23),o=n(96),i=n(97),s=n(98);t.exports=function(t){var e=[],n=t.toString().replace(/\/\*.*?\*\//g,"");n=o(e,n);var a=i(e,n,r.prePatterns).replace(/\n/g,"").replace(/\s*async\s*/,"").match(/(?:function\s*\((.*?)\)|\((.*?)\))|(.*?)\s*=>/);return a=a[1]||a[2]||a[3]||"",i(e,a,r.postPatterns).split(",").filter(function(t){return t}).map(function(t){var n=(t=s(e,t,!0)).split("="),r={param:n[0].trim()};return n[1]&&(r.default=s(e,n.slice(1).join("="))),r})}},function(t,e,n){var r=n(23).stringPatterns,o=n(11);t.exports=function(t,e){for(;;){var n=r.reduce(function(t,n){return t.concat(e.match(n)||[])},[]).sort(function(t,e){return t.length-e.length})[0];if(!n)return e;e=e.replace(n,o(t.push(n)))}}},function(t,e,n){var r=n(11);t.exports=function(t,e,n){return n.forEach(function(n){for(;n.test(e);){var o=n.exec(e)[0];e=e.replace(o,r(t.push(o)))}}),e}},function(module,exports,__webpack_require__){var delim=__webpack_require__(11);module.exports=function(cache,string,skipEval){for(var pattern=/:~:(\d+?):~:/;pattern.test(string);){var id=pattern.exec(string)[1];string=string.replace(delim(id),cache[id-1])}return skipEval?string:eval("("+string+")")}},function(t,e,n){t.exports={postMessage:n(12),iframe:n(114),opener:n(115)}},function(t,e,n){var r,o,i,s,a,c,u;s=n(0),r=n(2).EventEmitter,u=function(t,e,n){var r;switch(r=s.internalSocket.createSocket(),t.attach(r),e){case"begingroup":r.beginGroup(n);break;case"endgroup":r.endGroup(n);break;case"data":r.send(n)}return t.detach(r)},i=function(t,e,n){var r,o,i;if(t.graph&&(null!=(o=n?t.graph.inports[e]:t.graph.outports[e])?o.process:void 0)&&(r=null!=(i=t.getNode(o.process))?i.component:void 0))return n?r.inPorts[o.port]:r.outPorts[o.port]},a=function(t,e,n,r){var o,s,a,c;return o={id:t,type:"all",description:null!=(a=e.metadata)?a.description:void 0,addressable:!1,required:!1},(s=i(n,t,r))?(o.type=s.getDataType()||"all",("function"==typeof s.getSchema?s.getSchema():void 0)&&(o.schema=s.getSchema()),o.description=(null!=(c=e.metadata)?c.description:void 0)||s.getDescription()||"",o.addressable=s.isAddressable(),o.required=s.isRequired(),o):o},c=function(t,e){var n,r,o,i,s;if(r={graph:t,inPorts:[],outPorts:[]},!(null!=e?e.graph:void 0))return r;for(o in i=e.graph.inports)n=i[o],r.inPorts.push(a(o,n,e,!0));for(o in s=e.graph.outports)n=s[o],r.outPorts.push(a(o,n,e,!1));return r},o=class extends r{constructor(t){super(),this.transport=t,this.outputSockets={},this.mainGraph=null,this.transport.network.on("addnetwork",(t,e)=>(this.subscribeExportedPorts(e,t,!0),this.subscribeOutPorts(e,t),this.sendPorts(e,t),t.isStarted()&&this.subscribeOutdata(e,t,!0),t.on("start",()=>this.subscribeOutdata(e,t,!0)))),this.transport.network.on("removenetwork",(t,e)=>(this.subscribeOutdata(e,t,!1),this.subscribeOutPorts(e,t),this.subscribeExportedPorts(e,t.graph,!1),this.sendPorts(e,null)))}send(t,e,n){return this.transport.send("runtime",t,e,n)}sendAll(t,e){return this.transport.sendAll("runtime",t,e)}sendError(t,e){return this.send("error",new Error(t),e)}receive(t,e,n){switch(t){case"getruntime":return this.getRuntime(e,n);case"packet":return this.sendPacket(e,t=>{t?this.sendError(t.message,n):this.send("packetsent",{port:e.port,event:e.event,graph:e.graph,payload:e.payload},n)});default:return this.send("error",new Error(`runtime:${t} not supported`),n)}}getRuntime(t,e){var n,r,o,i,a,c,u;for(r in(u=this.transport.options.type)||(u=s.isBrowser()?"noflo-browser":"noflo-nodejs"),i=(n=this.transport.options.capabilities).filter(e=>this.transport.canDo(e,t.secret)),t={type:u,version:this.transport.version,capabilities:i,allCapabilities:n},this.mainGraph&&(t.graph=this.mainGraph),this.transport.options.id&&(t.id=this.transport.options.id),this.transport.options.label&&(t.label=this.transport.options.label),this.transport.options.namespace&&(t.namespace=this.transport.options.namespace),this.transport.options.repository&&(t.repository=this.transport.options.repository),this.transport.options.repositoryVersion&&(t.repositoryVersion=this.transport.options.repositoryVersion),this.send("runtime",t,e),c=[],a=this.transport.network.networks)o=a[r],c.push(this.sendPorts(r,o,e));return c}sendPorts(t,e,n){var r;return r=c(t,e),this.emit("ports",r),n?this.send("ports",r,n):this.sendAll("ports",r)}setMainGraph(t){return this.mainGraph=t}subscribeExportedPorts(t,e,n){var r,o,i,s,a,c,u,p;for(p=(()=>this.sendPorts(t,e)),i=0,a=(o=["addInport","addOutport","removeInport","removeOutport"]).length;i<a;i++)r=o[i],e.graph.removeListener(r,p);if(n){for(u=[],s=0,c=o.length;s<c;s++)r=o[s],u.push(e.graph.on(r,p));return u}}subscribeOutPorts(t,e,n){var r,o,i;if(i=(()=>this.subscribeOutdata(t,e,!1)),o=(()=>this.subscribeOutdata(t,e,!0)),(r=e.graph).removeListener("addOutport",o),r.removeListener("removeOutport",i),n)return r.on("addOutport",o),r.on("removeOutport",i)}subscribeOutdata(t,e,n){var r,o,i,a,c,u;for(c in this.outputSockets[t]||(this.outputSockets[t]={}),o=this.outputSockets[t])for(u=o[c],i=0,a=events.length;i<a;i++)r=events[i],u.removeAllListeners(r);if(o={},n)return Object.keys(e.graph.outports).forEach(n=>{var i,a;if(a=e.graph.outports[n],u=s.internalSocket.createSocket(),o[n]=u,!(null!=(i=e.processes[a.process].component)?i.outPorts[a.port]:void 0))throw new Error(`Exported outport ${a.port} in node ${a.process} not found`);return i.outPorts[a.port].attach(u),u.on("ip",e=>{switch(e.type){case"openBracket":r="begingroup";break;case"closeBracket":r="endgroup";break;default:r=e.type}return this.emit("packet",{port:n,event:r,graph:t,payload:e.data}),this.sendAll("packet",{port:n,event:r,graph:t,payload:e.data})})})}sendPacket(t,e){var n,r;return(n=this.transport.network.networks[t.graph])?(r=i(n.network,t.port,!0))?(u(r,t.event,t.payload),e()):e(new Error(`Cannot find internal port for ${t.port}`)):e(new Error(`Cannot find network for graph ${t.graph}`))}},t.exports=o},function(t,e,n){var r,o;o=n(0),r=class{constructor(t){this.transport=t,this.graphs={}}send(t,e,n){return this.transport.send("graph",t,e,n)}sendAll(t,e){return this.transport.sendAll("graph",t,e)}receive(t,e,n){var r;if("clear"===t||(r=this.resolveGraph(e,n)))switch(t){case"clear":return this.initGraph(e,n);case"addnode":return this.addNode(r,e,n);case"removenode":return this.removeNode(r,e,n);case"renamenode":return this.renameNode(r,e,n);case"changenode":return this.changeNode(r,e,n);case"addedge":return this.addEdge(r,e,n);case"removeedge":return this.removeEdge(r,e,n);case"changeedge":return this.changeEdge(r,e,n);case"addinitial":return this.addInitial(r,e,n);case"removeinitial":return this.removeInitial(r,e,n);case"addinport":return this.addInport(r,e,n);case"removeinport":return this.removeInport(r,e,n);case"renameinport":return this.renameInport(r,e,n);case"addoutport":return this.addOutport(r,e,n);case"removeoutport":return this.removeOutport(r,e,n);case"renameoutport":return this.renameOutport(r,e,n);case"addgroup":return this.addGroup(r,e,n);case"removegroup":return this.removeGroup(r,e,n);case"renamegroup":return this.renameGroup(r,e,n);case"changegroup":return this.changeGroup(r,e,n);default:return this.send("error",new Error(`graph:${t} not supported`),n)}}resolveGraph(t,e){if(t.graph){if(this.graphs[t.graph])return this.graphs[t.graph];this.send("error",new Error("Requested graph not found"),e)}else this.send("error",new Error("No graph specified"),e)}getLoader(t){return this.transport.component.getLoader(t,this.transport.options)}sendGraph(t,e,n){var r;return r={graph:t,description:e.toJSON()},this.send("graph",r,n)}initGraph(t,e){var n,r;if(t.id)return t.name||(t.name="NoFlo runtime"),r=new o.Graph(t.name),n=t.id,t.library&&(t.library=t.library.replace("noflo-",""),r.properties.library=t.library,n=`${t.library}/${n}`),t.icon&&(r.properties.icon=t.icon),t.description&&(r.properties.description=t.description),r.baseDir=this.transport.options.baseDir,this.subscribeGraph(t.id,r,e),t.main?this.transport.runtime.setMainGraph(n,r,e):this.transport.component.registerGraph(n,r,e),this.graphs[t.id]=r,this.sendAll("clear",{id:t.id,name:t.name,library:t.library,main:t.main,icon:t.icon,description:t.description},e);this.send("error",new Error("No graph ID provided"),e)}registerGraph(t,e){return"default/main"===t&&this.transport.runtime.setMainGraph(t,e),this.subscribeGraph(t,e,""),this.graphs[t]=e}subscribeGraph(t,e,n){return e.on("addNode",e=>(e.graph=t,this.sendAll("addnode",e,n))),e.on("removeNode",e=>{var r;return r={id:e.id,graph:t},this.sendAll("removenode",r,n)}),e.on("renameNode",(e,r)=>this.sendAll("renamenode",{from:e,to:r,graph:t},n)),e.on("changeNode",(e,r)=>this.sendAll("changenode",{id:e.id,metadata:e.metadata,graph:t},n)),e.on("addEdge",e=>{var r;return"number"!=typeof e.from.index&&delete e.from.index,"number"!=typeof e.to.index&&delete e.to.index,r={src:e.from,tgt:e.to,metadata:e.metadata,graph:t},this.sendAll("addedge",r,n)}),e.on("removeEdge",e=>{var r;return r={src:e.from,tgt:e.to,graph:t},this.sendAll("removeedge",r,n)}),e.on("changeEdge",e=>{var r;return r={src:e.from,tgt:e.to,metadata:e.metadata,graph:t},this.sendAll("changeedge",r,n)}),e.on("addInitial",e=>{var r;return r={src:e.from,tgt:e.to,metadata:e.metadata,graph:t},this.sendAll("addinitial",r,n)}),e.on("removeInitial",e=>{var r;return r={src:e.from,tgt:e.to,graph:t},this.sendAll("removeinitial",r,n)}),e.on("addGroup",e=>{var r;return r={name:e.name,nodes:e.nodes,metadata:e.metadata,graph:t},this.sendAll("addgroup",r,n)}),e.on("removeGroup",e=>{var r;return r={name:e.name,graph:t},this.sendAll("removegroup",r,n)}),e.on("renameGroup",(e,r)=>{var o;return o={from:e,to:r,graph:t},this.sendAll("renamegroup",o,n)}),e.on("changeGroup",e=>{var r;return r={name:e.name,metadata:e.metadata,graph:t},this.sendAll("changegroup",r,n)}),e.on("addInport",(e,r)=>{var o;return o={public:e,node:r.process,port:r.port,metadata:r.metadata,graph:t},this.sendAll("addinport",o,n)}),e.on("addOutport",(e,r)=>{var o;return o={public:e,node:r.process,port:r.port,metadata:r.metadata,graph:t},this.sendAll("addoutport",o,n)}),e.on("removeInport",(e,r)=>{var o;return o={public:e,graph:t},this.sendAll("removeinport",o,n)}),e.on("removeOutport",(e,r)=>{var o;return o={public:e,graph:t},this.sendAll("removeoutport",o,n)}),e.on("renameInport",(e,r)=>{var o;return o={from:e,to:r,graph:t},this.sendAll("renameinport",o,n)}),e.on("renameOutport",(e,r)=>{var o;return o={from:e,to:r,graph:t},this.sendAll("renameoutport",o,n)})}addNode(t,e,n){if(e.id||e.component)return t.addNode(e.id,e.component,e.metadata);this.send("error",new Error("No ID or component supplied"),n)}removeNode(t,e,n){if(e.id)return t.removeNode(e.id);this.send("error",new Error("No ID supplied"),n)}renameNode(t,e,n){if(e.from||e.to)return t.renameNode(e.from,e.to);this.send("error",new Error("No from or to supplied"),n)}changeNode(t,e,n){if(e.id||e.metadata)return t.setNodeMetadata(e.id,e.metadata);this.send("error",new Error("No id or metadata supplied"),n)}addEdge(t,e,n){if(e.src||e.tgt){if("number"!=typeof e.src.index&&"number"!=typeof e.tgt.index||!t.addEdgeIndex)return t.addEdge(e.src.node,e.src.port,e.tgt.node,e.tgt.port,e.metadata);t.addEdgeIndex(e.src.node,e.src.port,e.src.index,e.tgt.node,e.tgt.port,e.tgt.index,e.metadata)}else this.send("error",new Error("No src or tgt supplied"),n)}removeEdge(t,e,n){if(e.src||e.tgt)return t.removeEdge(e.src.node,e.src.port,e.tgt.node,e.tgt.port);this.send("error",new Error("No src or tgt supplied"),n)}changeEdge(t,e,n){if(e.src||e.tgt)return t.setEdgeMetadata(e.src.node,e.src.port,e.tgt.node,e.tgt.port,e.metadata);this.send("error",new Error("No src or tgt supplied"),n)}addInitial(t,e,n){if(e.src||e.tgt){if(!t.addInitialIndex||"number"!=typeof e.tgt.index)return t.addInitial(e.src.data,e.tgt.node,e.tgt.port,e.metadata);t.addInitialIndex(e.src.data,e.tgt.node,e.tgt.port,e.tgt.index,e.metadata)}else this.send("error",new Error("No src or tgt supplied"),n)}removeInitial(t,e,n){if(e.tgt)return t.removeInitial(e.tgt.node,e.tgt.port);this.send("error",new Error("No tgt supplied"),n)}addInport(t,e,n){if(e.public||e.node||e.port)return t.addInport(e.public,e.node,e.port,e.metadata);this.send("error",new Error("Missing exported inport information"),n)}removeInport(t,e,n){if(e.public)return t.removeInport(e.public);this.send("error",new Error("Missing exported inport name"),n)}renameInport(t,e,n){if(e.from||e.to)return t.renameInport(e.from,e.to);this.send("error",new Error("No from or to supplied"),n)}addOutport(t,e,n){if(e.public||e.node||e.port)return t.addOutport(e.public,e.node,e.port,e.metadata);this.send("error",new Error("Missing exported outport information"),n)}removeOutport(t,e,n){if(e.public)return t.removeOutport(e.public);this.send("error",new Error("Missing exported outport name"),n)}renameOutport(t,e,n){if(e.from||e.to)return t.renameOutport(e.from,e.to);this.send("error",new Error("No from or to supplied"),n)}addGroup(t,e,n){if(e.name||e.nodes||e.metadata)return t.addGroup(e.name,e.nodes,e.metadata);this.send("error",new Error("No name or nodes or metadata supplied"),n)}removeGroup(t,e,n){if(e.name)return t.removeGroup(e.name);this.send("error",new Error("No name supplied"),n)}renameGroup(t,e,n){if(e.from||e.to)return t.renameGroup(e.from,e.to);this.send("error",new Error("No from or to supplied"),n)}changeGroup(t,e,n){if(e.name||e.metadata)return t.setEdgeMetadata(e.name,e.metadata);this.send("error",new Error("No name or metadata supplied"),n)}},t.exports=r},function(t,e,n){(function(e){var r,o,i,s,a,c,u,p;u=n(0),r=n(2).EventEmitter,p=function(t,n){var r,o,i,s;if(r={id:t.id,graph:n},t.socket.from&&(r.src={node:t.socket.from.process.id,port:t.socket.from.port}),t.socket.to&&(r.tgt={node:t.socket.to.process.id,port:t.socket.to.port}),t.subgraph&&(r.subgraph=t.subgraph),void 0!==t.group&&(r.group=t.group),t.datatype&&(r.type=t.datatype),t.schema&&(r.schema=t.schema),void 0!==t.data){if(u.isBrowser()||e.isBuffer(t.data)&&(t.data=t.data.slice(0,20)),(null!=(o=t.data)?o.toJSON:void 0)&&(r.data=t.data.toJSON()),null!=(i=t.data)?i.toString:void 0){if(r.data=t.data.toString(),"[object Object]"===r.data)try{r.data=JSON.parse(JSON.stringify(t.data))}catch(t){}}else r.data=t.data;(null!=(s=t.metadata)?s.secure:void 0)&&(r.data="DATA")}return r},a=function(t){return t?t.process+"("+t.port+")":""},s=function(t){return a(t.src)+" -> "+a(t.tgt)},i=function(t){return t?t.process.id+"("+t.port+")":""},c=function(t){return i(t.from)+" -> "+i(t.to)},o=class extends r{constructor(t){super(),this.transport=t,this.networks={}}send(t,e,n){return this.transport.send("network",t,e,n)}sendAll(t,e){return this.transport.sendAll("network",t,e)}receive(t,e,n){var r;if(r=this.resolveGraph(e,n))switch(t){case"start":return this.startNetwork(r,e,n);case"stop":return this.stopNetwork(r,e,n);case"edges":return this.updateEdgesFilter(r,e,n);case"debug":return this.debugNetwork(r,e,n);case"getstatus":return this.getStatus(r,e,n);default:return this.send("error",new Error(`network:${t} not supported`),n)}}resolveGraph(t,e){if(t.graph){if(this.transport.graph.graphs[t.graph])return this.transport.graph.graphs[t.graph];this.send("error",new Error("Requested graph not found"),e)}else this.send("error",new Error("No graph specified"),e)}updateEdgesFilter(t,e,n){var r,o,i,a,c,u;for((a=this.networks[e.graph])?a.filters={}:(a={network:null,filters:{}},this.networks[e.graph]=a),o=0,i=(c=e.edges).length;o<i;o++)r=c[o],u=s(r),a.filters[u]=!0;return this.send("edges",{graph:e.graph,edges:e.edges},n)}eventFiltered(t,e){var n;return!this.transport.options.filterData||(n=c(e.socket),this.networks[t].filters[n])}initNetwork(t,e,n,r){var o,i;if(!this.networks[e]||!this.networks[e].network)return t.componentLoader=this.transport.component.getLoader(t.baseDir,this.transport.options),(i=JSON.parse(JSON.stringify(this.transport.options))).delay=!0,u.createNetwork(t,(t,o)=>t?r(t):(this.networks[e]&&this.networks[e].network?this.networks[e].network=o:this.networks[e]={network:o,filters:{}},this.emit("addnetwork",o,e,this.networks),this.subscribeNetwork(o,e,n),o.connect(r)),i);(o=this.networks[e].network).stop(i=>i?r(i):(delete this.networks[e],this.emit("removenetwork",o,e,this.networks),this.initNetwork(t,e,n,r)))}subscribeNetwork(t,e,n){return t.on("start",r=>this.sendAll("started",{time:r.start,graph:e,running:t.isRunning(),started:t.isStarted()},n)),t.on("end",r=>this.sendAll("stopped",{time:new Date,uptime:r.uptime,graph:e,running:t.isRunning(),started:t.isStarted()},n)),t.on("icon",t=>(t.graph=e,this.sendAll("icon",t,n))),t.on("ip",t=>{var r;if(this.eventFiltered(e,t)){switch(r={id:t.id,socket:t.socket,subgraph:t.subgraph,metadata:t.metadata},t.type){case"openBracket":r.type="begingroup",r.group=t.data||"";break;case"data":r.type="data",r.data=t.data,r.datatype=t.datatype,r.schema=t.schema;break;case"closeBracket":r.type="endgroup",r.group=t.data||""}return this.sendAll(r.type,p(r,e),n)}}),t.on("process-error",t=>{var r,o,i,s,a;if(o=t.error.message,t.error.stack)for(r=t.error.stack.split("\n"),i=s=0,a=Math.min(r.length,3);0<=a?s<=a:s>=a;i=0<=a?++s:--s)o+=`\n${r[i]}`;return this.sendAll("processerror",{id:t.id,error:o,graph:e},n)})}_startNetwork(t,e,n,r){var o,i;return o=function(t){return t.start(function(t){return r(t)})},(i=this.networks[e])&&i.network?o(i.network):this.initNetwork(t,e,n,t=>t?r(t):(i=this.networks[e],o(i.network)))}startNetwork(t,e,n){return this.networks[e.graph],this._startNetwork(t,e.graph,n,t=>{t&&this.send("error",t,n)})}stopNetwork(t,e,n){var r;if(this.networks[e.graph])if(r=this.networks[e.graph].network){if(!r.isStarted())return this.send("stopped",{time:new Date,graph:e.graph,running:r.isRunning(),started:r.isStarted()},n);this.networks[e.graph].network.stop(t=>{t?this.send("error",t,n):this.send("stopped",{time:new Date,graph:e.graph,running:r.isRunning(),started:r.isStarted()},n)})}else this.send("error",new Error(`Network ${e.graph} not found`),n);else this.send("error",new Error(`Network ${e.graph} not found`),n)}debugNetwork(t,e,n){var r;this.networks[e.graph]&&(r=this.networks[e.graph].network)?(r.setDebug(e.enable),this.send("setdebug",{enable:e.enable})):this.send("error",new Error(`Network ${e.graph} not found`),n)}getStatus(t,e,n){var r;if(this.networks[e.graph]){if(r=this.networks[e.graph].network)return this.send("status",{graph:e.graph,running:r.isRunning(),started:r.isStarted()},n);this.send("error",new Error(`Network ${e.graph} not found`),n)}else this.send("error",new Error(`Network ${e.graph} not found`),n)}},t.exports=o}).call(this,n(14).Buffer)},function(t,e,n){var r,o,i,s;i=n(0),o=n(104),s=n(105),r=function(){class t{constructor(t){this.transport=t}send(t,e,n){return this.transport.send("component",t,e,n)}receive(t,e,n){switch(t){case"list":return this.listComponents(e,n);case"getsource":return this.getSource(e,n);case"source":return this.setSource(e,n);default:return this.send("error",new Error(`component:${t} not supported`),n)}}getLoader(t,e={}){return this.loaders[t]||(this.loaders[t]=new i.ComponentLoader(t,e)),this.loaders[t]}listComponents(t,e){var n,r;return n=this.transport.options.baseDir,(r=this.getLoader(n,this.transport.options)).listComponents((t,n)=>{var o,i;if(!t)return o=Object.keys(n),i=0,o.forEach(t=>this.processComponent(r,t,e,t=>{if(!(++i<o.length))return this.send("componentsready",i,e)}));this.send("error",t,e)})}getSource(t,e){var n;return n=this.transport.options.baseDir,this.getLoader(n,this.transport.options).getSource(t.name,(n,r)=>{var o,i;return n?null==(o=this.transport.graph.graphs[t.name])?void this.send("error",n,e):(i=s.parseName(t.name),this.send("source",{name:i.name,library:i.library,code:JSON.stringify(o.toJSON()),language:"json"},e)):this.send("source",r,e)})}setSource(t,e){var n,r;return n=this.transport.options.baseDir,(r=this.getLoader(n,this.transport.options)).setSource(t.library,t.name,t.code,t.language,n=>{if(!n)return this.processComponent(r,r.normalizeName(t.library,t.name),e);this.send("error",n,e)})}processComponent(t,e,n,r){return r||(r=function(){}),t.load(e,(t,o)=>{if(!o){if(t instanceof Error)return this.send("error",t,n),r(t);o=t}if(o.isReady())return this.sendComponent(e,o,n),r(null);o.once("ready",()=>(this.sendComponent(e,o,n),r(null)))},!0)}processPort(t,e){var n,r;return n={id:t,type:e.getDataType?e.getDataType():"all"},("function"==typeof e.getSchema?e.getSchema():void 0)&&(n.schema=e.getSchema()),e.isRequired&&(n.required=e.isRequired()),e.isAddressable&&(n.addressable=e.isAddressable()),e.getDescription&&(n.description=e.getDescription()),(null!=(r=e.options)?r.values:void 0)&&(n.values=e.options.values),("function"==typeof e.hasDefault?e.hasDefault():void 0)&&(n.default=e.options.default),n}sendComponent(t,e,n){var r,o,i,s,a,c,u;for(a in o=[],i=[],c=e.inPorts)(s=c[a])&&"function"!=typeof s&&s.canAttach&&o.push(this.processPort(a,s));for(a in u=e.outPorts)(s=u[a])&&"function"!=typeof s&&s.canAttach&&i.push(this.processPort(a,s));return r=e.getIcon?e.getIcon():"gear",this.send("component",{name:t,description:e.description,subgraph:e.isSubgraph(),icon:r,inPorts:o,outPorts:i},n)}registerGraph(t,e,n){var r,i;return i=o(()=>this.processComponent(r,t,n),10),(r=this.getLoader(e.baseDir,this.transport.options)).listComponents((o,s)=>{if(!o)return r.registerComponent("",t,e),i();this.send("error",o,n)}),e.on("addNode",i),e.on("removeNode",i),e.on("renameNode",i),e.on("addEdge",i),e.on("removeEdge",i),e.on("addInitial",i),e.on("removeInitial",i),e.on("addInport",i),e.on("removeInport",i),e.on("renameInport",i),e.on("addOutport",i),e.on("removeOutport",i),e.on("renameOutport",i)}}return t.prototype.loaders={},t}.call(this),t.exports=r},function(t,e){function n(t,e,n){var r,o,i,s,a;function c(){var u=Date.now()-s;u<e&&u>=0?r=setTimeout(c,e-u):(r=null,n||(a=t.apply(i,o),i=o=null))}null==e&&(e=100);var u=function(){i=this,o=arguments,s=Date.now();var u=n&&!r;return r||(r=setTimeout(c,e)),u&&(a=t.apply(i,o),i=o=null),a};return u.clear=function(){r&&(clearTimeout(r),r=null)},u.flush=function(){r&&(a=t.apply(i,o),i=o=null,clearTimeout(r),r=null)},u}n.debounce=n,t.exports=n},function(t,e){e.parseName=function(t){var e;return-1===t.indexOf("/")?{library:null,name:t}:{library:(e=t.split("/"))[0],name:e[1]}}},function(t,e,n){var r,o,i,s,a,c,u,p,d;p=n(0),s=n(3)("noflo-runtime-base:trace"),c=JSON.stringify;try{c=n(107)}catch(t){a=t,console.log(`WARN: failed to load json-stringify-safe, circular objects may cause fail.\n${a.message}`)}i=function(t){var e;return e=c(t),JSON.parse(e)},r=class{constructor(){this.events=[]}add(t){return this.events.push(t)}getAll(t,e){var n,r,o;for(n=0,r=(o=this.events).length;n<r;n++)t(a=o[n]);return e(null)}},d=function(t,e,n,r){var o,i,s,a,c,u,d,l,h;for(u in i={},d=t.graph.outports)for(a=d[u],h=p.internalSocket.createSocket(),i[u]=h,t.processes[a.process].component.outPorts[a.port].attach(h),l=function(t){return function(n){var o;return o={id:`EXPORT: ${e} ${u.toUpperCase()} ->`,payload:n,socket:{to:{process:{id:e},port:u}}},r(t,o)}},s=0,c=n.length;s<c;s++)o=n[s],h.on(o,l(o));return i},u=function(t,e,n){var r,o,c,u,p,d,l,h;switch(s("event",t,e,`'${n.id}'`),h=n.socket,l=function(t){try{return t.group=n.group.toString()}catch(e){return s("group serialization error",a=e),t.error=a.message}},o=(r={protocol:"network",command:e,payload:{time:(new Date).toISOString(),graph:t,error:null,src:{node:null!=(c=h.from)?c.process.id:void 0,port:null!=(u=h.from)?u.port:void 0},tgt:{node:null!=(p=h.to)?p.process.id:void 0,port:null!=(d=h.to)?d.port:void 0},id:void 0,subgraph:void 0}}).payload,e){case"connect":case"disconnect":break;case"begingroup":case"endgroup":l(r.payload);break;case"data":try{o.data=i(n.data)}catch(t){s("data serialization error",a=t),o.error=a.message}break;default:throw new Error(`trace: Unknown event type ${e}`)}return s("event done",t,e,`'${n.id}'`),r},o=class{constructor(t){this.options=t,this.buffer=new r,this.header={graphs:{}}}attach(t){var e,n;return n=t.graph.name||t.graph.properties.name||"default",s("attach",n),(e=["connect","begingroup","data","endgroup","disconnect"]).forEach(e=>t.on(e,t=>{var r;return r=u(n,e,t),this.buffer.add(r)})),d(t,n,e,(t,e)=>{var r;return r=u(n,t,e),this.buffer.add(r)}),this.header.graphs[n]=t.graph.toJSON()}detach(t){}dumpString(t){var e,n;return n=[],e=function(t){return n.push(t)},this.buffer.getAll(e,e=>{var r;return r={header:this.header,events:n},t(e,JSON.stringify(r,null,2))})}dumpFile(t,e){var r,o,i;return r=n(5),i=n(108),o=function(e){return r.open(t,"w",function(n,r){return e(n,{path:t,fd:r})})},t||(o=function(t){return i.open({suffix:".json"},t)}),o((t,n)=>{var o,i,a,c;return t?e(t):(o=0,a=function(t,e){return r.write(n.fd,t,{encoding:"utf-8"},e)},c=function(t){var e;return e=o?",":"",o+=1,e+=JSON.stringify(t,null,2),a(e,function(t){})},s("streaming to file",n.path),i=JSON.stringify(this.header,null,2),a(`{\n "header": ${i}\n, "events":\n[`,t=>this.buffer.getAll(c,function(t){return t?e(t):(s(`streamed ${o} events`),a("]\n }",function(t){return s("completed stream",n.path),e(t,n.path)}))})))})}},t.exports.Tracer=o},function(t,e){function n(t,e){var n=[],r=[];return null==e&&(e=function(t,e){return n[0]===e?"[Circular ~]":"[Circular ~."+r.slice(0,n.indexOf(e)).join(".")+"]"}),function(o,i){if(n.length>0){var s=n.indexOf(this);~s?n.splice(s+1):n.push(this),~s?r.splice(s,1/0,o):r.push(o),~n.indexOf(i)&&(i=e.call(this,o,i))}else n.push(i);return null==t?i:t.call(this,o,i)}}(t.exports=function(t,e,r,o){return JSON.stringify(t,n(e,o),r)}).getSerialize=n},function(t,e,n){(function(r){var o=n(5),i=n(25),s=n(109),a=n(110),c=n(112),u=a.sync,p=s.O_CREAT|s.O_TRUNC|s.O_RDWR|s.O_EXCL,d=function(t,n){var o=l(t,n),s=new Date,a=[o.prefix,s.getYear(),s.getMonth(),s.getDate(),"-",r.pid,"-",(4294967296*Math.random()+1).toString(36),o.suffix].join("");return i.join(o.dir||e.dir,a)},l=function(t,e){var n={prefix:null,suffix:null};if(t)switch(typeof t){case"string":n.prefix=t;break;case"object":n=t;break;default:throw new Error("Unknown affix declaration: "+n)}else n.prefix=e;return n},h=!1,f=!1,m=[],g=[];function v(t){if(!h)return!1;b(),m.push(t)}function y(t){if(!h)return!1;b(),g.push(t)}function b(){if(!h)return!1;f||(r.addListener("exit",w),f=!0)}function w(){return!!h&&{files:function(){if(!h)return!1;for(var t,e=0;void 0!==(t=m.shift());)u(t),e++;return e}(),dirs:function(){if(!h)return!1;for(var t,e=0;void 0!==(t=g.shift());)u(t),e++;return e}()}}e.dir=i.resolve(c()),e.track=function(e){return h=!1!==e,t.exports},e.mkdir=function(t,e){var n=d(t,"d-");o.mkdir(n,448,function(t){t||y(n),e&&e(t,n)})},e.mkdirSync=function(t){var e=d(t,"d-");return o.mkdirSync(e,448),y(e),e},e.open=function(t,e){var n=d(t,"f-");o.open(n,p,384,function(t,r){t||v(n),e&&e(t,{path:n,fd:r})})},e.openSync=function(t){var e=d(t,"f-"),n=o.openSync(e,p,384);return v(e),{path:e,fd:n}},e.path=d,e.cleanup=function(t){h?function(t){if(h){var e=0,n=m.length;if(n)for(var r,o=function(r){if(n){if(r)return t&&t(r),void(n=0);e++,!--n&&t&&t(null,e)}};void 0!==(r=m.shift());)a(r,o);else t&&t(null,e)}else t&&t(new Error("not tracking"))}(function(e,n){e?t&&t(e,{files:n}):function(t){if(h){var e=g.length;if(e)for(var n,r=function(n){if(e){if(n)return t&&t(n,0),void(e=0);!--e&&t&&t(null,0)}};void 0!==(n=g.shift());)a(n,r);else t&&t(null,0)}else t&&t(new Error("not tracking"))}(function(e,r){t&&t(e,{files:n,dirs:r})})}):t&&t(new Error("not tracking"))},e.cleanupSync=w,e.createWriteStream=function(t){var e=d(t,"s-"),n=o.createWriteStream(e,{flags:p,mode:384});return v(e),n}}).call(this,n(1))},function(t){t.exports={O_RDONLY:0,O_WRONLY:1,O_RDWR:2,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:512,O_EXCL:2048,O_NOCTTY:131072,O_TRUNC:1024,O_APPEND:8,O_DIRECTORY:1048576,O_NOFOLLOW:256,O_SYNC:128,O_SYMLINK:2097152,O_NONBLOCK:4,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,E2BIG:7,EACCES:13,EADDRINUSE:48,EADDRNOTAVAIL:49,EAFNOSUPPORT:47,EAGAIN:35,EALREADY:37,EBADF:9,EBADMSG:94,EBUSY:16,ECANCELED:89,ECHILD:10,ECONNABORTED:53,ECONNREFUSED:61,ECONNRESET:54,EDEADLK:11,EDESTADDRREQ:39,EDOM:33,EDQUOT:69,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:65,EIDRM:90,EILSEQ:92,EINPROGRESS:36,EINTR:4,EINVAL:22,EIO:5,EISCONN:56,EISDIR:21,ELOOP:62,EMFILE:24,EMLINK:31,EMSGSIZE:40,EMULTIHOP:95,ENAMETOOLONG:63,ENETDOWN:50,ENETRESET:52,ENETUNREACH:51,ENFILE:23,ENOBUFS:55,ENODATA:96,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:77,ENOLINK:97,ENOMEM:12,ENOMSG:91,ENOPROTOOPT:42,ENOSPC:28,ENOSR:98,ENOSTR:99,ENOSYS:78,ENOTCONN:57,ENOTDIR:20,ENOTEMPTY:66,ENOTSOCK:38,ENOTSUP:45,ENOTTY:25,ENXIO:6,EOPNOTSUPP:102,EOVERFLOW:84,EPERM:1,EPIPE:32,EPROTO:100,EPROTONOSUPPORT:43,EPROTOTYPE:41,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:70,ETIME:101,ETIMEDOUT:60,ETXTBSY:26,EWOULDBLOCK:35,EXDEV:18,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:10,SIGFPE:8,SIGKILL:9,SIGUSR1:30,SIGSEGV:11,SIGUSR2:31,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:20,SIGCONT:19,SIGSTOP:17,SIGTSTP:18,SIGTTIN:21,SIGTTOU:22,SIGURG:16,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:23,SIGSYS:12,SSL_OP_ALL:2147486719,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:32,SSL_OP_MICROSOFT_SESS_ID_BUG:1,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:536870912,SSL_OP_NETSCAPE_CHALLENGE_BUG:2,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:1073741824,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:8,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:16777216,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_SINGLE_DH_USE:1048576,SSL_OP_SINGLE_ECDH_USE:524288,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:128,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:512,SSL_OP_TLS_D5_BUG:256,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_ECDH:16,ENGINE_METHOD_ECDSA:32,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_STORE:256,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_UDP_REUSEADDR:4}},function(t,e,n){(function(r){t.exports=p,p.sync=h;var o=n(111),i=n(25),s=n(5),a=0;e.EMFILE_MAX=1e3,e.BUSYTRIES_MAX=3;var c="win32"===r.platform;function u(t){["unlink","chmod","stat","rmdir","readdir"].forEach(function(e){t[e]=t[e]||s[e],t[e+="Sync"]=t[e]||s[e]})}function p(t,n,r){if("function"==typeof n&&(r=n,n={}),o(t),o(n),o("function"==typeof r),u(n),!r)throw new Error("No callback passed to rimraf()");var i=0;d(t,n,function o(s){if(s){if(c&&("EBUSY"===s.code||"ENOTEMPTY"===s.code)&&i<e.BUSYTRIES_MAX)return i++,setTimeout(function(){d(t,n,o)},100*i);if("EMFILE"===s.code&&a<e.EMFILE_MAX)return setTimeout(function(){d(t,n,o)},a++);"ENOENT"===s.code&&(s=null)}a=0,r(s)})}function d(t,e,n){o(t),o(e),o("function"==typeof n),e.unlink(t,function(r){if(r){if("ENOENT"===r.code)return n(null);if("EPERM"===r.code)return c?function(t,e,n,r){o(t),o(e),o("function"==typeof r),n&&o(n instanceof Error);e.chmod(t,666,function(o){o?r("ENOENT"===o.code?null:n):e.stat(t,function(o,i){o?r("ENOENT"===o.code?null:n):i.isDirectory()?l(t,e,n,r):e.unlink(t,r)})})}(t,e,r,n):l(t,e,r,n);if("EISDIR"===r.code)return l(t,e,r,n)}return n(r)})}function l(t,e,n,r){o(t),o(e),n&&o(n instanceof Error),o("function"==typeof r),e.rmdir(t,function(s){!s||"ENOTEMPTY"!==s.code&&"EEXIST"!==s.code&&"EPERM"!==s.code?s&&"ENOTDIR"===s.code?r(n):r(s):function(t,e,n){o(t),o(e),o("function"==typeof n),e.readdir(t,function(r,o){if(r)return n(r);var s,a=o.length;if(0===a)return e.rmdir(t,n);o.forEach(function(r){p(i.join(t,r),e,function(r){if(!s)return r?n(s=r):void(0==--a&&e.rmdir(t,n))})})})}(t,e,r)})}function h(t,e){u(e=e||{}),o(t),o(e);try{e.unlinkSync(t)}catch(n){if("ENOENT"===n.code)return;if("EPERM"===n.code)return c?function(t,e,n){o(t),o(e),n&&o(n instanceof Error);try{e.chmodSync(t,666)}catch(t){if("ENOENT"===t.code)return;throw n}try{var r=e.statSync(t)}catch(t){if("ENOENT"===t.code)return;throw n}r.isDirectory()?f(t,e,n):e.unlinkSync(t)}(t,e,n):f(t,e,n);if("EISDIR"!==n.code)throw n;f(t,e,n)}}function f(t,e,n){o(t),o(e),n&&o(n instanceof Error);try{e.rmdirSync(t)}catch(r){if("ENOENT"===r.code)return;if("ENOTDIR"===r.code)throw n;"ENOTEMPTY"!==r.code&&"EEXIST"!==r.code&&"EPERM"!==r.code||function(t,e){o(t),o(e),e.readdirSync(t).forEach(function(n){h(i.join(t,n),e)}),e.rmdirSync(t,e)}(t,e)}}}).call(this,n(1))},function(t,e,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function r(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0}function o(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var i=n(16),s=Object.prototype.hasOwnProperty,a=Array.prototype.slice,c="foo"===function(){}.name;function u(t){return Object.prototype.toString.call(t)}function p(t){return!o(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var d=t.exports=v,l=/\s*function\s+([^\(\s]*)\s*/;function h(t){if(i.isFunction(t)){if(c)return t.name;var e=t.toString().match(l);return e&&e[1]}}function f(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function m(t){if(c||!i.isFunction(t))return i.inspect(t);var e=h(t);return"[Function"+(e?": "+e:"")+"]"}function g(t,e,n,r,o){throw new d.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:o})}function v(t,e){t||g(t,!0,e,"==",d.ok)}function y(t,e,n,s){if(t===e)return!0;if(o(t)&&o(e))return 0===r(t,e);if(i.isDate(t)&&i.isDate(e))return t.getTime()===e.getTime();if(i.isRegExp(t)&&i.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(p(t)&&p(e)&&u(t)===u(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===r(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(o(t)!==o(e))return!1;var c=(s=s||{actual:[],expected:[]}).actual.indexOf(t);return-1!==c&&c===s.expected.indexOf(e)||(s.actual.push(t),s.expected.push(e),function(t,e,n,r){if(null==t||null==e)return!1;if(i.isPrimitive(t)||i.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var o=b(t),s=b(e);if(o&&!s||!o&&s)return!1;if(o)return t=a.call(t),e=a.call(e),y(t,e,n);var c,u,p=P(t),d=P(e);if(p.length!==d.length)return!1;for(p.sort(),d.sort(),u=p.length-1;u>=0;u--)if(p[u]!==d[u])return!1;for(u=p.length-1;u>=0;u--)if(c=p[u],!y(t[c],e[c],n,r))return!1;return!0}(t,e,n,s))}return n?t===e:t==e}function b(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function w(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function E(t,e,n,r){var o;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),o=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!o&&g(o,n,"Missing expected exception"+r);var s="string"==typeof r,a=!t&&o&&!n;if((!t&&i.isError(o)&&s&&w(o,n)||a)&&g(o,n,"Got unwanted exception"+r),t&&o&&n&&!w(o,n)||!t&&o)throw o}d.AssertionError=function(t){var e;this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=f(m((e=this).actual),128)+" "+e.operator+" "+f(m(e.expected),128),this.generatedMessage=!0);var n=t.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,n);else{var r=new Error;if(r.stack){var o=r.stack,i=h(n),s=o.indexOf("\n"+i);if(s>=0){var a=o.indexOf("\n",s+1);o=o.substring(a+1)}this.stack=o}}},i.inherits(d.AssertionError,Error),d.fail=g,d.ok=v,d.equal=function(t,e,n){t!=e&&g(t,e,n,"==",d.equal)},d.notEqual=function(t,e,n){t==e&&g(t,e,n,"!=",d.notEqual)},d.deepEqual=function(t,e,n){y(t,e,!1)||g(t,e,n,"deepEqual",d.deepEqual)},d.deepStrictEqual=function(t,e,n){y(t,e,!0)||g(t,e,n,"deepStrictEqual",d.deepStrictEqual)},d.notDeepEqual=function(t,e,n){y(t,e,!1)&&g(t,e,n,"notDeepEqual",d.notDeepEqual)},d.notDeepStrictEqual=function t(e,n,r){y(e,n,!0)&&g(e,n,r,"notDeepStrictEqual",t)},d.strictEqual=function(t,e,n){t!==e&&g(t,e,n,"===",d.strictEqual)},d.notStrictEqual=function(t,e,n){t===e&&g(t,e,n,"!==",d.notStrictEqual)},d.throws=function(t,e,n){E(!0,t,e,n)},d.doesNotThrow=function(t,e,n){E(!1,t,e,n)},d.ifError=function(t){if(t)throw t};var P=Object.keys||function(t){var e=[];for(var n in t)s.call(t,n)&&e.push(n);return e}}).call(this,n(7))},function(t,e,n){"use strict";(function(e){var n="win32"===e.platform,r=n?/[^:]\\$/:/.\/$/;t.exports=function(){var t;return t=n?e.env.TEMP||e.env.TMP||(e.env.SystemRoot||e.env.windir)+"\\temp":e.env.TMPDIR||e.env.TMP||e.env.TEMP||"/tmp",r.test(t)&&(t=t.slice(0,-1)),t}}).call(this,n(1))},function(t,e,n){(function(t){var r,o,i,s;r=n(24),s=n(2).EventEmitter,i=class extends r{constructor(t){super(t),this.clients=[]}_connect(t){return this.clients.push(t),t.on("send",e=>this._receive(e,{client:t}))}_disconnect(t){if(-1!==this.clients.indexOf(t))return this.clients.splice(this.clients.indexOf(t),1),t.removeAllListeners("send")}_receive(t,e){return this.receive(t.protocol,t.command,t.payload,e)}send(t,e,n,r){var o;if(r.client)return o={protocol:t,command:e,payload:n},r.client._receive(o)}sendAll(t,e,n){var r,o,i,s,a,c;for(s={protocol:t,command:e,payload:n},c=[],o=0,i=(a=this.clients).length;o<i;o++)r=a[o],c.push(r._receive(s));return c}},o=class extends s{constructor(t,e){super(),this.name=e,this.runtime=t,this.name||(this.name="Unnamed client")}connect(){return this.runtime._connect(this)}disconnect(){return this.runtime._disconnect(this)}send(t,e,n){var r;return r={protocol:t,command:e,payload:n},this.emit("send",r)}_receive(t){return setTimeout(()=>this.emit("message",t),1)}},e.Client=o,e.Runtime=i}).call(this,n(1))},function(t,e,n){const r=n(12),o=n(26);class i extends r{constructor(t){super(t),this.setClient(window.parent)}}t.exports=function(t){const e=o.normalizeOptions(t),n=new i(e);return o.subscribe(window,(t,e)=>{"iframe"!==t.protocol||"setcontent"!==t.command?n.receive(t.protocol,t.command,t.payload,{href:e.origin}):document.body.innerHTML=t.payload}),n}},function(t,e,n){const r=n(12),o=n(26);class i extends r{constructor(t,e){super(t),e&&e.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),this.openClient(e.getAttribute("href"))})}openClient(t){const e=window.open(t,"_blank");if(!e)throw new Error(`Unable to open client window at '${t}'`);this.context={href:"*"};const n=function(t){let{data:e}=t;"string"==typeof t.data&&(e=JSON.parse(t.data)),e.protocol&&e.command&&this.receive(e.protocol,e.command,e.payload,this.context)}.bind(this),r=setInterval(()=>{e&&!e.closed||(this.setClient(null),window.removeEventListener("message",n),clearInterval(r))},1e3);this.setClient(e),window.addEventListener("message",n)}}t.exports=function(t,e){const n=o.normalizeOptions(t);return new i(n,e)}},,,,,,,function(t,e,n){const r={noflo:n(0),"noflo-runtime-postmessage":n(99)};window&&(window.require=function(t){if(r[t])return r[t];throw new Error(`Module ${t} not available`)})}]);
//# sourceMappingURL=test.js.map